<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Nova - Sports TV</title>
    <meta name="description" content="منصة Nova الرائدة للبث المباشر والمحتوى الرياضي بجودة عالية - مُحسنة لـ Android TV">
    
    <!-- Android TV Support -->
    <meta name="theme-color" content="#8A56E9">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Nova TV">
    
    <!-- TV App Manifest -->
    <link rel="manifest" href="data:application/manifest+json,{
        'name': 'Nova Sports TV',
        'short_name': 'Nova TV',
        'description': 'منصة البث الرياضي المباشر',
        'start_url': '/',
        'display': 'fullscreen',
        'orientation': 'landscape',
        'theme_color': '#8A56E9',
        'background_color': '#020E1C',
        'icons': [
            {
                'src': 'https://iili.io/FSF1DcG.md.png',
                'sizes': '192x192',
                'type': 'image/png'
            }
        ]
    }">
    
    <!-- Favicon -->
    <link rel="icon" href="https://iili.io/FSF1DcG.md.png" type="image/png">



    <!-- Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">



    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-storage-compat.js"></script>

    <style>

/* ===== GLOBAL PROTECTION STYLES ===== */
* {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-user-drag: none;
    -khtml-user-drag: none;
    -moz-user-drag: none;
    -o-user-drag: none;
    user-drag: none;
    -webkit-touch-callout: none;
    -webkit-tap-highlight-color: transparent;
}

input, textarea, button, select {
    -webkit-user-select: text;
    -moz-user-select: text;
    user-select: text;
}

/* ===== CSS VARIABLES ===== */
:root {
    --primary-bg: #020E1C;
    --secondary-bg: #11E3B0;
    --tertiary-bg: #8A56E9;
    --accent-primary: #8A56E9;
    --accent-secondary: #11E3B0;
    --accent-gold: #f6c000;
    --text-primary: #FFFFFF;
    --text-secondary: #BCC6D8;
    --text-muted: #6c7293;
    --border-primary: rgba(138, 86, 233, 0.2);
    --shadow-light: rgba(0, 0, 0, 0.1);
    --shadow-dark: rgba(0, 0, 0, 0.3);
    --gradient-card: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
    --border-radius: 12px;
    --transition: all 0.2s ease;
    --glass-bg: rgba(15, 25, 40, 0.8);
    --blur-effect: blur(12px);
}

/* Dynamic Color System - مُبسط */
:root.theme-red { --accent-primary: #dc2626; --accent-secondary: #ef4444; }
:root.theme-blue { --accent-primary: #2563eb; --accent-secondary: #3b82f6; }
:root.theme-green { --accent-primary: #16a34a; --accent-secondary: #22c55e; }
:root.theme-yellow { --accent-primary: #ca8a04; --accent-secondary: #eab308; }
:root.theme-pink { --accent-primary: #db2777; --accent-secondary: #ec4899; }
:root.theme-rose { --accent-primary: #e11d48; --accent-secondary: #f43f5e; }
:root.theme-fuchsia { --accent-primary: #c026d3; --accent-secondary: #d946ef; }
:root.theme-teal { --accent-primary: #0d9488; --accent-secondary: #14b8a6; }



/* ===== GLOBAL STYLES ===== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    font-size: 16px;
    scroll-behavior: smooth;
}

body {
    font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;
    background: var(--primary-bg);
    color: var(--text-primary);
    line-height: 1.6;
    overflow-x: hidden;
    transition: var(--transition);
    min-height: 100vh;
    margin: 0;
    padding: 0;
}

.container {
    max-width: 1200px;
    margin: 0 auto 0 0;
    padding: 0 1rem 0 0;
}

/* ===== LOADING SCREEN - محسن للسرعة ===== */
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--primary-bg);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    transition: opacity 0.15s ease;
}

.loading-container {
    text-align: center;
    position: relative;
    animation: logoFadeIn 0.3s ease-out;
}

.loading-logo {
    width: 80px;
    height: 80px;
    margin: 0 auto 1rem;
    position: relative;
}

.loading-logo img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    transition: none;
}

@keyframes logoFadeIn {
    0% {
        opacity: 0;
        transform: scale(0.9);
    }
    100% {
        opacity: 1;
        transform: scale(1);
    }
}



/* ===== HEADER STYLES ===== */
.header {
    background: var(--primary-bg);
    border-bottom: 1px solid var(--border-primary);
    padding: 0.5rem 0;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    transition: transform 0.1s ease, opacity 0.1s ease;
    min-height: 60px;
}

.header.header-hidden {
    transform: translateY(-100%);
    opacity: 0;
}

.header.header-scrolled {
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    padding: 0.25rem 0;
    min-height: 50px;
}



.header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 1rem;
    max-width: 1400px;
    margin: 0 auto;
    width: 100%;
    height: 100%;
}

.header-left {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex: 0 0 auto;
    min-width: 0;
}

.header-center {
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1;
    min-width: 0;
}

.header-right {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 0.75rem;
    flex: 0 0 auto;
    min-width: 0;
}

.logo {
    display: flex;
    align-items: center;
    cursor: pointer;
    transition: transform 0.1s ease, opacity 0.1s ease;
    text-decoration: none;
    min-width: 0;
}

.logo img {
    height: 35px;
    width: auto;
    object-fit: contain;
    transition: all 0.3s ease;
}

.logo:hover img {
    transform: scale(1.05);
}

.user-avatar-simple {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #000;
    font-weight: 700;
    font-size: 1rem;
    box-shadow: 0 2px 8px rgba(var(--accent-primary), 0.3);
    transition: all 0.3s ease;
    cursor: pointer;
}

.user-avatar-simple:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 15px rgba(var(--accent-primary), 0.4);
}

.premium-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 25px;
    color: var(--text-primary);
    padding: 0.6rem 1.2rem;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    white-space: nowrap;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.premium-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: var(--accent-primary);
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(var(--accent-primary), 0.3);
}

.nav-btn {
    width: 42px;
    height: 42px;
    border-radius: 12px;
    background: rgba(var(--accent-primary), 0.1);
    border: 1px solid rgba(var(--accent-primary), 0.2);
    color: var(--accent-primary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    transition: transform 0.1s ease, opacity 0.1s ease;
    flex-shrink: 0;
}

.nav-btn:hover {
    background: var(--accent-primary);
    color: white;
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(var(--accent-primary), 0.3);
}

/* Responsive Header Styles */
@media (max-width: 1200px) {
    .header-content {
        max-width: 100%;
        padding: 0 1rem;
    }
}

@media (max-width: 768px) {
    .header {
        padding: 0.4rem 0;
        min-height: 55px;
    }

    .header.header-scrolled {
        padding: 0.2rem 0;
        min-height: 50px;
    }

    .header-content {
        padding: 0 0.75rem;
        gap: 0.5rem;
    }

    .header-left {
        gap: 0.75rem;
    }

    .header-right {
        gap: 0.5rem;
    }

    .logo img {
        height: 32px;
    }

    .user-avatar-simple {
        width: 35px;
        height: 35px;
        font-size: 1rem;
    }

    .premium-btn {
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
    }

    .nav-btn {
        width: 38px;
        height: 38px;
        font-size: 1.1rem;
    }
}

@media (max-width: 480px) {
    .header {
        padding: 0.3rem 0;
        min-height: 50px;
    }

    .header.header-scrolled {
        padding: 0.2rem 0;
        min-height: 45px;
    }

    .header-content {
        padding: 0 0.5rem;
    }

    .header-left {
        gap: 0.5rem;
    }

    .header-right {
        gap: 0.4rem;
    }

    .logo img {
        height: 28px;
    }

    .user-avatar-simple {
        width: 32px;
        height: 32px;
        font-size: 0.9rem;
    }

    .premium-btn {
        padding: 0.4rem 0.8rem;
        font-size: 0.8rem;
    }

    .nav-btn {
        width: 35px;
        height: 35px;
        font-size: 1rem;
    }
}

@media (max-width: 360px) {
    .header-content {
        padding: 0 0.4rem;
    }

    .premium-btn {
        padding: 0.3rem 0.6rem;
        font-size: 0.75rem;
    }

  .nav-btn {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(var(--accent-primary), 0.2);
    color: var(--text-primary);
    padding: 1rem;
    border-radius: 12px;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.1s ease, opacity 0.1s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    text-decoration: none;
    position: relative;
    overflow: hidden;
}

    .nav-btn {
        width: 32px;
        height: 32px;
        font-size: 0.9rem;
    }

    .logo img {
        height: 26px;
    }

    .user-avatar-simple {
        width: 30px;
        height: 30px;
        font-size: 0.85rem;
    }
}

/* ===== SIDEBAR STYLES ===== */
.sidebar {
    position: fixed;
    top: 0;
    right: -320px;
    width: 320px;
    height: 100vh;
    background: var(--primary-bg);
    border-left: 1px solid var(--border-primary);
    backdrop-filter: blur(15px);
    z-index: 2000;
    transition: right 0.3s ease;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}



.sidebar.active {
    right: 0;
}

.sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1.5rem;
    border-bottom: 1px solid var(--border-primary);
    flex-shrink: 0;
}

.sidebar-title {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
}

.close-btn {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid var(--border-primary);
    color: var(--text-secondary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    transition: all 0.3s ease;
}

.close-btn:hover {
    background: rgba(255, 71, 87, 0.1);
    border-color: #ff4757;
    color: #ff4757;
}

.sidebar-nav {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 1rem;
}

.menu-section {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.menu-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    border-radius: 12px;
    color: var(--text-primary);
    text-decoration: none;
    font-weight: 500;
    font-size: 0.95rem;
    transition: all 0.3s ease;
    border: 1px solid transparent;
    background: rgba(255, 255, 255, 0.02);
}

.menu-item:hover {
    background: rgba(var(--accent-primary), 0.1);
    border-color: rgba(var(--accent-primary), 0.3);
    color: var(--accent-primary);
    transform: translateX(-3px);
}

.menu-item i {
    width: 20px;
    text-align: center;
    font-size: 1.1rem;
    transition: all 0.3s ease;
}

.menu-item span {
    transition: all 0.3s ease;
}

.menu-footer {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-primary);
}

.contact-link {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    border-radius: 12px;
    color: var(--text-secondary);
    text-decoration: none;
    font-weight: 500;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    background: rgba(0, 136, 204, 0.05);
    border: 1px solid rgba(0, 136, 204, 0.2);
}

.contact-link:hover {
    background: rgba(0, 136, 204, 0.1);
    border-color: #0088cc;
    color: #0088cc;
    transform: translateX(-2px);
}

.contact-link i {
    font-size: 1.1rem;
    width: 20px;
    text-align: center;
}

/* Expandable Menu Styles */
.expandable-menu {
    position: relative;
}

.expandable-menu > a {
    position: relative;
    justify-content: space-between;
}

.league-stats-header .menu-item-content {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex: 1;
}

.menu-icon-wrapper {
    width: 35px;
    height: 35px;
    border-radius: 10px;
    background: linear-gradient(135deg, rgba(var(--accent-primary), 0.2), rgba(var(--accent-secondary), 0.1));
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.league-stats-header:hover .menu-icon-wrapper {
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    transform: scale(1.1);
}

.league-stats-header:hover .menu-icon-wrapper i {
    color: #000 !important;
}

.menu-text {
    font-weight: 600;
    font-size: 1rem;
}

.expand-arrow {
    transition: transform 0.3s ease;
    font-size: 0.8rem !important;
    margin-left: auto;
    color: var(--accent-primary);
}

.expandable-menu.expanded .expand-arrow {
    transform: rotate(180deg);
}

.submenu {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s ease;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4), rgba(25, 27, 32, 0.6));
    border-radius: 0 0 16px 16px;
    margin-top: 0.5rem;
    border: 1px solid rgba(var(--accent-primary), 0.1);
    border-top: none;
}

.submenu.open {
    max-height: 400px;
}

.league-link {
    display: block !important;
    padding: 0 !important;
    margin: 0.5rem !important;
    border: none !important;
    background: transparent !important;
    text-decoration: none !important;
    border-radius: 12px !important;
    transition: all 0.3s ease !important;
    position: relative;
    overflow: hidden;
}

.league-link::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transition: left 0.6s ease;
}

.league-link:hover::before {
    left: 100%;
}

.league-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    transition: all 0.3s ease;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.02);
    border: 1px solid transparent;
}

.league-link:hover .league-item {
    background: rgba(var(--accent-primary), 0.1);
    border-color: rgba(var(--accent-primary), 0.3);
    transform: translateX(-5px);
}

.league-flag {
    font-size: 1.8rem;
    line-height: 1;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.league-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.2rem;
}

.league-name {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 0.95rem;
    line-height: 1.2;
}

.league-subtitle {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-weight: 500;
    opacity: 0.8;
}

.league-arrow {
    font-size: 0.8rem !important;
    color: var(--text-muted);
    transition: all 0.3s ease;
    opacity: 0.6;
}

.league-link:hover .league-arrow {
    color: var(--accent-primary);
    opacity: 1;
    transform: translateX(3px);
}

/* League specific colors */
.premier-league:hover .league-item {
    border-color: rgba(128, 0, 128, 0.4);
    background: rgba(128, 0, 128, 0.1);
}

.premier-league:hover .league-name {
    color: #800080;
}

.la-liga:hover .league-item {
    border-color: rgba(255, 140, 0, 0.4);
    background: rgba(255, 140, 0, 0.1);
}

.la-liga:hover .league-name {
    color: #ff8c00;
}

.bundesliga:hover .league-item {
    border-color: rgba(220, 20, 60, 0.4);
    background: rgba(220, 20, 60, 0.1);
}

.bundesliga:hover .league-name {
    color: #dc143c;
}

.ligue1:hover .league-item {
    border-color: rgba(0, 100, 200, 0.4);
    background: rgba(0, 100, 200, 0.1);
}

.ligue1:hover .league-name {
    color: #0064c8;
}

.serie-a:hover .league-item {
    border-color: rgba(0, 128, 0, 0.4);
    background: rgba(0, 128, 0, 0.1);
}

.serie-a:hover .league-name {
    color: #008000;
}

.submenu .icon {
    width: 20px;
    font-size: 1rem !important;
}

/* Responsive design for leagues */
@media (max-width: 768px) {
    .league-item {
        padding: 0.875rem;
    }

    .league-flag {
        font-size: 1.6rem;
    }

    .league-name {
        font-size: 0.9rem;
    }

    .league-subtitle {
        font-size: 0.7rem;
    }
}

.sidebar-menu .icon {
    width: 28px;
    text-align: center;
    font-size: 1.4rem;
}

.theme-toggle {
    padding: 1rem;
    border-top: 1px solid var(--border-primary);
}

.theme-btn {
    width: 100%;
    padding: 0.75rem 1rem;
    border-radius: var(--border-radius);
    background: var(--gradient-card);
    border: 1px solid var(--border-primary);
    color: var(--text-primary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    font-weight: 600;
    transition: var(--transition);
}

.theme-btn:hover {
    background: var(--accent-primary);
    color: #000000;
    transform: scale(1.02);
}

/* ===== MAIN CONTENT ===== */
.main-app {
    margin-top: 60px;
    transition: margin-top 0.3s ease;
}

.main-content {
    padding: 2rem 2rem 2rem 0;
    min-height: calc(100vh - 80px);
    transition: padding-top 0.3s ease;
}

.main-content.header-hidden {
    padding-top: 1rem;
}

/* Responsive Main Content */
@media (max-width: 768px) {
    .main-app {
        margin-top: 55px;
    }

    .main-content {
        padding: 1.5rem;
    }
}

@media (max-width: 480px) {
    .main-app {
        margin-top: 50px;
    }

    .main-content {
        padding: 1rem;
    }
}

.section {
    margin-bottom: 3rem;
}

.section-title {
    font-size: 2.2rem;
    font-weight: 900;
    margin-bottom: 2.5rem;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-align: center;
    letter-spacing: -0.5px;
    position: relative;
}



/* ===== SIMPLE LOGIN PAGE ===== */
.login-page {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    background: var(--primary-bg);
    padding: 1rem;
}

.simple-login-container {
    width: 100%;
    max-width: 350px;
}

.simple-login-box {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border: 1px solid var(--border-primary);
    border-radius: 16px;
    padding: 2rem;
    text-align: center;
    animation: fadeIn 0.5s ease-out;
}

/* Logo */
.simple-logo {
    margin-bottom: 1.5rem;
}

.logo-img {
    width: 80px;
    height: 80px;
    border-radius: 12px;
    object-fit: contain;
}

/* Title */
.simple-title {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0 0 0.5rem 0;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.simple-subtitle {
    color: var(--text-secondary);
    font-size: 1rem;
    margin: 0 0 2.5rem 0;
    font-weight: 500;
}

/* Form */
.simple-form {
    width: 100%;
}

.simple-input-group {
    margin-bottom: 1rem;
}

.simple-input {
    width: 100%;
    padding: 0.875rem 1rem;
    font-size: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border-primary);
    border-radius: 8px;
    color: var(--text-primary);
    outline: none;
    transition: all 0.3s ease;
    font-family: inherit;
}

.simple-input::placeholder {
    color: var(--text-muted);
}

.simple-input:focus {
    border-color: var(--accent-primary);
    background: rgba(255, 255, 255, 0.08);
    box-shadow: 0 0 0 2px rgba(var(--accent-primary), 0.2);
}

.simple-login-btn {
    width: 100%;
    padding: 0.875rem;
    font-size: 1rem;
    font-weight: 600;
    background: var(--accent-primary);
    color: #000;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 0.5rem;
}

.simple-login-btn:hover {
    background: var(--accent-secondary);
    transform: translateY(-1px);
}

.simple-login-btn:active {
    transform: translateY(0);
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
    .simple-login-container {
        max-width: 320px;
    }

    .simple-login-box {
        padding: 1.5rem;
    }

    .logo-img {
        width: 50px;
        height: 50px;
    }

    .simple-title {
        font-size: 1.6rem;
    }

    .simple-subtitle {
        font-size: 0.85rem;
    }

    .simple-input {
        padding: 0.75rem 0.875rem;
        font-size: 0.95rem;
    }

    .simple-login-btn {
        padding: 0.75rem;
        font-size: 0.95rem;
    }
}

@media (max-width: 480px) {
    .simple-login-box {
        padding: 1.25rem;
        border-radius: 12px;
    }

    .simple-title {
        font-size: 1.4rem;
    }

    .simple-input {
        padding: 0.7rem 0.8rem;
    }

    .simple-login-btn {
        padding: 0.7rem;
    }
}

.form-group {
    margin-bottom: 1.5rem;
    text-align: right;
}

.form-label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--text-primary);
    font-weight: 600;
}

.form-input {
    width: 100%;
    padding: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: var(--border-radius);
    background: rgba(255, 255, 255, 0.06);
    color: var(--text-primary);
    font-size: 1rem;
    transition: var(--transition);
    backdrop-filter: blur(10px);
}

.form-input:focus {
    outline: none;
    border-color: rgba(var(--accent-primary), 0.6);
    background: rgba(255, 255, 255, 0.08);
    box-shadow: 0 0 0 3px rgba(var(--accent-primary), 0.15);
}



.btn {
    padding: 1rem 2rem;
    border: none;
    border-radius: var(--border-radius);
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
    position: relative;
    overflow: hidden;
}

.btn-primary {
    background: var(--accent-primary);
    color: #000000;
    width: 100%;
    margin-bottom: 1rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(246, 192, 0, 0.4);
    background: #ffd700;
}

.btn-secondary {
    background: rgba(255, 255, 255, 0.1);
    color: var(--text-primary);
    border: 1px solid var(--border-primary);
    width: 100%;
}

.btn-secondary:hover {
    background: rgba(255, 255, 255, 0.15);
    border-color: var(--accent-primary);
    transform: translateY(-2px);
}

/* ===== HERO SECTION ===== */
.hero-section {
    background: var(--primary-bg);
    border: none;
    border-radius: 0;
    padding: 4rem 2.5rem 3rem;
    margin-bottom: 3rem;
    margin-top: 40px;
    position: relative;
    overflow: hidden;
    min-height: 0vh;
}

.hero-header {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 2rem;
}

.hero-badge {
    background: rgba(var(--accent-primary), 0.15);
    color: var(--accent-primary);
    padding: 0.75rem 1.5rem;
    border-radius: 25px;
    font-size: 2rem;
    font-weight: 700;
    border: 1px solid rgba(var(--accent-primary), 0.3);
    display: flex;
    align-items: center;
    gap: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.hero-players-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: center;
}

.hero-players-image {
    position: relative;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
}

.hero-players-image::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(var(--accent-primary), 0.2) 0%, rgba(var(--accent-secondary), 0.1) 100%);
    pointer-events: none;
}

.hero-content h2 {
    font-size: 2.5rem;
    font-weight: 800;
    margin-bottom: 1.5rem;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1.2;
}

.hero-content p {
    color: var(--text-secondary);
    font-size: 1.2rem;
    line-height: 1.7;
    margin-bottom: 2rem;
    font-weight: 500;
}

.hero-features {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-bottom: 2.5rem;
}

.hero-feature {
    display: flex;
    align-items: center;
    gap: 1rem;
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1rem;
}

.hero-feature i {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    background: rgba(var(--accent-primary), 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--accent-primary);
    font-size: 1.2rem;
}

.hero-channels-btn {
    background: linear-gradient(135deg, var(--accent-primary) 0%, #ffd700 100%);
    color: #000000;
    border: none;
    padding: 1.2rem 2.5rem;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 1rem;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    position: relative;
    overflow: hidden;
}

.hero-channels-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.6s ease;
}

.hero-channels-btn:hover {
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    background: linear-gradient(135deg, #ffd700 0%, var(--accent-primary) 100%);
}

.hero-channels-btn:hover::before {
    left: 100%;
}

.hero-channels-btn i:last-child {
    transition: var(--transition);
}

.hero-channels-btn:hover i:last-child {
    transform: translateX(5px);
}

/* ===== CONTENT GRID ===== */
.content-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
}

/* ===== DAZN Style Match Cards ===== */
.matches-section {
    margin-bottom: 3rem;
}

.section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
}

.section-category {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
}

.section-subtitle {
    font-size: 0.9rem;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
}

.matches-slider-container {
    position: relative;
    overflow: hidden;
}

.matches-slider {
    display: flex;
    gap: 1rem;
    overflow-x: auto;
    scroll-behavior: smooth;
    scrollbar-width: none;
    -ms-overflow-style: none;
    cursor: grab;
    user-select: none;
    padding-bottom: 1rem;
    will-change: transform;
    transform: translateZ(0);
}

.matches-slider::-webkit-scrollbar {
    display: none;
}

.matches-slider.dragging {
    cursor: grabbing;
    scroll-behavior: auto;
}

.dazn-card {
    flex: 0 0 420px;
    height: 240px;
    border-radius: 4px;
    overflow: hidden;
    position: relative;
    cursor: pointer;
    transition: transform 0.15s ease-out, box-shadow 0.15s ease-out;
    text-decoration: none;
    color: inherit;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    will-change: transform;
    transform: translateZ(0);
}

.dazn-card:hover {
    transform: scale(1.01) translateZ(0);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
    text-decoration: none;
    color: inherit;
}

.dazn-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.3) 0%, rgba(0, 0, 0, 0.6) 100%);
    z-index: 1;
}

.dazn-card-content {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 0.6rem;
    z-index: 2;
    background: linear-gradient(180deg, 
        rgba(0, 0, 0, 0) 20%, 
        rgba(0, 0, 0, 0.6) 100%);
}

.dazn-card-date {
    position: absolute;
    top: 0.75rem;
    left: 0.75rem;
    background: var(--accent-primary);
    color: #000000;
    padding: 0.25rem 0.5rem;
    border-radius: 2px;
    font-size: 0.75rem;
    font-weight: 700;
    z-index: 3;
    text-transform: uppercase;
}

.dazn-card-title {
    color: white;
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 0.4rem;
    line-height: 1.3;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

.dazn-card-subtitle {
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.9rem;
    line-height: 1.3;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

/* تصميم البطاقات الملونة */
.dazn-card-green {
    background: linear-gradient(135deg, #2c5530 0%, #1e3a1f 100%);
}

.dazn-card-red {
    background: linear-gradient(135deg, #c23616 0%, #8b2635 100%);
}

.dazn-card-blue {
    background: linear-gradient(135deg, #2f3542 0%, #1e2a3a 100%);
}

.dazn-card-purple {
    background: linear-gradient(135deg, #5f27cd 0%, #341f97 100%);
}

/* تأثيرات خاصة للبطاقات مع الصور */
.dazn-card.with-bg-image::before {
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 0, 0, 0.7) 100%);
}

.dazn-card.fifa-card {
    background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 180"><defs><pattern id="stripes" patternUnits="userSpaceOnUse" width="4" height="4" patternTransform="rotate(45)"><rect width="2" height="4" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100%" height="100%" fill="%23c23616"/><rect width="100%" height="100%" fill="url(%23stripes)"/></svg>');
}

.dazn-card.transfer-card {
    background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 180"><defs><pattern id="grid" patternUnits="userSpaceOnUse" width="20" height="20"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></path></svg>');
}

.dazn-card.golden-ball-card {
    background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 180"><defs><radialGradient id="goldGrad" cx="50%" cy="50%" r="50%"><stop offset="0%" style="stop-color:rgba(255,215,0,0.3)"/><stop offset="100%" style="stop-color:rgba(255,215,0,0)"/></radialGradient></defs><rect width="100%" height="100%" fill="%232f3542"/><rect width="100%" height="100%" fill="url(%23goldGrad)"/></svg>');
}

/* ===== COMPETITION CARDS ===== */
.competition-card {
    flex: 0 0 160px;
    transition: transform 0.1s ease-out, box-shadow 0.1s ease-out;
    cursor: pointer;
    text-align: center;
    will-change: transform;
    transform: translateZ(0);
}

.competition-card:hover {
    transform: translateY(-3px) translateZ(0);
}

.competition-link {
    display: block;
    text-decoration: none;
    color: inherit;
    text-align: center;
    pointer-events: auto;
}

.competition-image {
    width: 160px;
    height: 160px;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 0.75rem;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    position: relative;
}

.competition-card:hover .competition-image {
    box-shadow: 0 8px 25px rgba(var(--accent-primary), 0.3);
    border-color: var(--accent-primary);
    transform: scale(1.02);
}

.competition-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    transition: transform 0.3s ease;
    user-select: none;
    pointer-events: none;
}

.competition-card:hover .competition-image img {
    transform: scale(1.05);
}

.competition-name {
    color: var(--text-primary);
    font-size: 0.95rem;
    font-weight: 600;
    margin: 0;
    line-height: 1.3;
    max-width: 160px;
    word-wrap: break-word;
    transition: color 0.3s ease;
}

.competition-card:hover .competition-name {
    color: var(--accent-primary);
}

/* تحسينات إضافية للسلايدر */
.matches-slider-container {
    position: relative;
    overflow: hidden;
    margin-bottom: 1rem;
}

.matches-slider {
    display: flex;
    gap: 1rem;
    overflow-x: auto;
    scroll-behavior: smooth;
    scrollbar-width: none;
    -ms-overflow-style: none;
    cursor: grab;
    user-select: none;
    padding: 1rem 0;
}

.matches-slider::-webkit-scrollbar {
    display: none;
}

.matches-slider.dragging {
    cursor: grabbing;
    scroll-behavior: auto;
}

/* تحسين عرض البطاقات على الشاشات المختلفة */
@media (max-width: 768px) {
    .competition-card {
        flex: 0 0 140px;
    }

    .competition-image {
        width: 140px;
        height: 140px;
    }

    .competition-name {
        font-size: 0.9rem;
        max-width: 140px;
    }
}

@media (max-width: 480px) {
    .competition-card {
        flex: 0 0 120px;
    }

    .competition-image {
        width: 120px;
        height: 120px;
    }

    .competition-name {
        font-size: 0.85rem;
        max-width: 120px;
    }
}



/* تجاوب مع الشاشات المتوسطة */
@media (max-width: 1024px) {
    .dazn-card {
        flex: 0 0 380px;
        height: 220px;
    }
}

/* تجاوب مع الشاشات الصغيرة */
@media (max-width: 768px) {
    .dazn-card {
        flex: 0 0 340px;
        height: 200px;
    }

    .dazn-card-title {
        font-size: 1rem;
    }

    .dazn-card-subtitle {
        font-size: 0.85rem;
    }
}

@media (max-width: 480px) {
    .dazn-card {
        flex: 0 0 300px;
        height: 180px;
    }

    .dazn-card-content {
        padding: 1rem;
    }

    .dazn-card-title {
        font-size: 0.95rem;
    }

    .dazn-card-subtitle {
        font-size: 0.8rem;
    }
}

.card {
    background: var(--gradient-card);
    border: 1px solid var(--border-primary);
    border-radius: 16px;
    padding: 0;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    min-height: 250px;
    display: flex;
    flex-direction: column;
    text-decoration: none;
    color: inherit;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.card-image {
    position: relative;
    transition: var(--transition);
}

.card:hover .card-image {
    transform: scale(1.02);
}

.hero-image-container {
    transition: var(--transition);
}

.hero-image-container:hover > div > div {
    transform: scale(1.02);
}

.card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    border-color: rgba(var(--accent-primary), 0.4);
}

.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(246, 192, 0, 0.03) 0%, transparent 50%);
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 1;
}

.card:hover::before {
    opacity: 1;
}

.card-header {
    position: relative;
    background: linear-gradient(135deg, rgba(var(--accent-primary), 0.08) 0%, rgba(var(--accent-secondary), 0.04) 100%);
    padding: 2rem 1.5rem;
    border-bottom: 1px solid rgba(var(--accent-primary), 0.1);
}

.card-icon {
    width: 85px;
    height: 85px;
    border-radius: 20px;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    color: #000000;
    box-shadow: 0 8px 25px rgba(var(--accent-primary), 0.4);
    margin-bottom: 1.5rem;
    transition: all 0.3s ease;
}

.card-content {
    padding: 2rem 1.5rem;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.card-title {
    font-size: 1.4rem;
    font-weight: 800;
    color: var(--text-primary);
    margin-bottom: 1rem;
    line-height: 1.2;
    background: linear-gradient(135deg, var(--text-primary) 0%, rgba(var(--accent-primary), 0.8) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.card-description {
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 1.5rem;
    font-size: 0.95rem;
}

.card-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-top: 1rem;
    border-top: 1px solid var(--border-primary);
}

.card-count {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--text-muted);
    font-size: 0.9rem;
    font-weight: 500;
}

.card-count i {
    color: var(--accent-primary);
    font-size: 1rem;
}

.card-arrow {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    background: rgba(var(--accent-primary), 0.1);
    border: 1px solid rgba(var(--accent-primary), 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--accent-primary);
    font-size: 1.1rem;
    transition: var(--transition);
}

.card:hover .card-arrow {
    background: var(--accent-primary);
    color: #000000;
    transform: scale(1.1);
}

.card:hover .card-icon {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 12px 35px rgba(var(--accent-primary), 0.5);
}

/* Live Indicator */
.card-live-indicator {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: #ff4757;
    color: white;
    padding: 0.4rem 0.8rem;
    border-radius: 15px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    z-index: 3;
    display: flex;
    align-items: center;
    gap: 0.4rem;
}

.card-live-indicator::before {
    content: '';
    width: 6px;
    height: 6px;
    background: white;
    border-radius: 50%;
    animation: pulse 2s infinite;
}

/* ===== SETTINGS SECTION ===== */
.settings-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 0 1rem;
}

.settings-section {
    margin-bottom: 2rem;
    border-radius: 12px;
    overflow: hidden;            
    border: 1px solid var(--border-primary);
    background: rgba(255, 255, 255, 0.03);
}

.settings-section-header {
    background: rgba(255, 255, 255, 0.05);
    padding: 1rem;
    border-bottom: 1px solid var(--border-primary);
}

.settings-section-title {
    color: var(--text-primary);
    font-size: 1.2rem;
    font-weight: 600;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.settings-section-title i {
    color: var(--accent-primary);
    font-size: 1rem;
}

.settings-item {
    padding: 1rem;
    border-bottom: 1px solid var(--border-primary);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.settings-item:last-child {
    border-bottom: none;
}

.settings-item .info {
    flex-grow: 1;
    padding-right: 1rem;
}

.settings-item .title {
    font-weight: 600;
    margin-bottom: 0.25rem;
    color: var(--text-primary);
    font-size: 1rem;
}

.settings-item .desc {
    font-size: 0.85rem;
    color: var(--text-secondary);
}

.settings-item .value {
    color: var(--accent-primary);
    margin-left: 1rem;
    font-weight: 600;
    font-size: 0.9rem;
}

/* Settings Footer Styles */
.settings-footer {
    margin-top: 3rem;
    margin-bottom: 2rem;
}

.footer-separator {
    height: 2px;
    background: linear-gradient(90deg, 
        transparent 0%, 
        var(--accent-primary) 20%, 
        var(--accent-secondary) 50%, 
        var(--accent-primary) 80%, 
        transparent 100%);
    margin-bottom: 2rem;
    border-radius: 1px;
    opacity: 0.7;
}

.footer-content {
    background: var(--gradient-card);
    border: 1px solid var(--border-primary);
    border-radius: 20px;
    padding: 2rem;
    text-align: center;
    backdrop-filter: blur(15px);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.footer-logo {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.footer-logo-img {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    object-fit: contain;
    box-shadow: 0 4px 15px rgba(var(--accent-primary), 0.3);
}

.footer-text {
    text-align: right;
}

.footer-app-name {
    color: var(--accent-primary);
    font-size: 1.8rem;
    font-weight: 800;
    margin: 0;
    line-height: 1;
}

.footer-version {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin: 0.25rem 0 0 0;
    font-weight: 500;
}

.footer-copyright {
    border-top: 1px solid var(--border-primary);
    padding-top: 1.5rem;
}

.footer-copyright p {
    color: var(--text-secondary);
    margin: 0.5rem 0;
    font-size: 0.95rem;
    line-height: 1.4;
}

.footer-copyright p:first-child {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1rem;
}

.footer-subtitle {
    opacity: 0.8;
    font-size: 0.85rem !important;
}

.switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 24px;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(255, 255, 255, 0.2);
    transition: .4s;
    border-radius: 24px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked + .slider {
    background-color: var(--accent-primary);
}

input:checked + .slider:before {
    transform: translateX(26px);
}

.color-picker {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    margin-top: 10px;
    justify-content: center;
    max-width: 160px;
}

.quality-selector-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(5px);
    z-index: 3000;
    display: flex;
    align-items: center;
    justify-content: center;
}

.quality-option:hover {
    border-color: var(--accent-primary) !important;
    background: rgba(var(--accent-primary), 0.1) !important;
    transform: translateY(-2px);
}

.color-option {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid transparent;
    transition: transform 0.2s, border-color 0.3s, box-shadow 0.3s;
    position: relative;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.color-option:hover {
    transform: scale(1.1);
}

.color-option:active {
    transform: scale(0.9);
}

.color-option.selected {
    border-color: var(--text-primary);
    transform: scale(1.1);
}

.color-option.selected::after {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-weight: bold;
    font-size: 14px;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
}

.about-section {
    padding: 15px;
    text-align: center;
    font-size: 12px;
    color: var(--text-secondary);
    background: var(--secondary-bg);
    margin: 15px;
    border-radius: 8px;
    border: 1px solid var(--border-primary);
}

.about-section p {
    margin: 8px 0;
    line-height: 1.5;
}



/* Responsive Settings */
@media (max-width: 768px) {
    .settings-container {
        padding: 0 0.5rem;
    }

    .settings-section {
        margin-bottom: 1.5rem;
    }

    .settings-section-header {
        padding: 1.25rem;
    }

    .settings-section-title {
        font-size: 1.2rem;
    }

    .settings-item {
        padding: 1.25rem;
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
    }

    .settings-item .info {
        padding-right: 0;
        width: 100%;
    }

    .settings-item .title {
        font-size: 1rem;
    }

    .settings-item .desc {
        font-size: 0.85rem;
    }

    .color-picker {
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
        max-width: 200px;
        margin: 1rem auto 0;
        justify-self: center;
    }

    .color-option {
        width: 32px;
        height: 32px;
    }

    .footer-content {
        padding: 1.5rem;
    }

    .footer-logo {
        flex-direction: column;
        gap: 0.75rem;
    }

    .footer-text {
        text-align: center;
    }

    .footer-app-name {
        font-size: 1.6rem;
    }
}

@media (max-width: 480px) {
    .settings-section-header {
        padding: 1rem;
    }

    .settings-section-title {
        font-size: 1.1rem;
    }

    .settings-item {
        padding: 1rem;
    }

    .settings-item .title {
        font-size: 0.95rem;
    }

    .settings-item .desc {
        font-size: 0.8rem;
    }

    .color-picker {
        grid-template-columns: repeat(4, 1fr);
        gap: 6px;
        max-width: 160px;
    }

    .color-option {
        width: 28px;
        height: 28px;
    }

    .footer-content {
        padding: 1.25rem;
    }

    .footer-app-name {
        font-size: 1.4rem;
    }

    .footer-version {
        font-size: 0.8rem;
    }

    .footer-copyright p {
        font-size: 0.85rem;
    }

    .footer-subtitle {
        font-size: 0.75rem !important;
    }
}

/* ===== CHANNEL CATEGORIES - مبسط ===== */
.channel-categories-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.channel-category-card {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid var(--border-primary);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    padding: 1.5rem;
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    min-height: 140px;
    justify-content: center;
}

.channel-category-card:hover {
    background: rgba(var(--accent-primary), 0.08);
    border-color: var(--accent-primary);
    transform: translateY(-3px);
    text-decoration: none;
    color: inherit;
}

.channel-category-icon {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    background: rgba(var(--accent-primary), 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--accent-primary);
    font-size: 1.4rem;
    margin-bottom: 1rem;
    transition: all 0.3s ease;
}

.channel-category-card:hover .channel-category-icon {
    background: var(--accent-primary);
    color: #000;
    transform: scale(1.05);
}

.channel-category-name {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
    line-height: 1.3;
}

.channel-category-desc {
    color: var(--text-secondary);
    font-size: 0.85rem;
    margin: 0;
    opacity: 0.9;
}

.channel-category-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    background: rgba(var(--accent-primary), 0.1);
    padding: 0.3rem 0.8rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--accent-primary);
    margin-top: 0.5rem;
    border: 1px solid rgba(var(--accent-primary), 0.2);
}

/* ===== CHANNEL SUB PAGE ===== */
.channel-sub-page {
    display: none;
}

.channel-sub-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border-primary);
}

.back-btn {
    padding: 0.75rem 1.5rem;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border-primary);
    border-radius: var(--border-radius);
    color: var(--text-primary);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-weight: 600;
    transition: var(--transition);
    text-decoration: none;
}

.back-btn:hover {
    background: var(--accent-primary);
    color: white;
    transform: translateX(5px);
}

.channel-sub-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 1.5rem;
}

.channel-item-wrapper {
    position: relative;
    width: 100%;
}

.channel-item {
    background: var(--gradient-card);
    border: 1px solid var(--border-primary);
    border-radius: 16px;
    padding: 1.5rem;
    text-decoration: none;
    color: inherit;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 1.25rem;
    position: relative;
    cursor: pointer;
    width: 100%;
    box-sizing: border-box;
    min-height: 100px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
}

.channel-item:hover {
    background: rgba(var(--accent-primary), 0.08);
    border-color: rgba(var(--accent-primary), 0.4);
    text-decoration: none;
    color: inherit;
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.channel-logo {
    width: 75px;
    height: 75px;
    border-radius: 16px;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    flex-shrink: 0;
    font-size: 1.4rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    overflow: hidden;
    position: relative;
}

.channel-logo img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    border-radius: 16px;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
}

.channel-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.channel-name {
    font-weight: 700;
    color: var(--text-primary);
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
    line-height: 1.3;
}

.channel-quality {
    font-size: 0.85rem;
    color: var(--accent-primary);
    background: rgba(var(--accent-primary), 0.1);
    padding: 0.4rem 0.8rem;
    border-radius: 10px;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    border: 1px solid rgba(var(--accent-primary), 0.2);
    width: fit-content;
}

.channel-status {
    width: 6px;
    height: 6px;
    background: #22c55e;
    border-radius: 50%;
    position: absolute;
    bottom: 8px;
    left: 8px;
    z-index: 15;
    border: 1px solid rgba(34, 197, 94, 0.3);
    box-shadow: 0 0 4px rgba(34, 197, 94, 0.4);
}

.channel-status::after {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: #22c55e;
    border-radius: 50%;
    opacity: 0.3;
    animation: statusGlow 2s ease-in-out infinite;
}

@keyframes statusGlow {
    0%, 100% { 
        transform: scale(1); 
        opacity: 0.4; 
    }
    50% { 
        transform: scale(1.3); 
        opacity: 0.1; 
    }
}

/* أنيميشن للحالة المباشرة */
@keyframes livePulse {
    0%, 100% { 
        opacity: 1; 
        transform: scale(1);
    }
    50% { 
        opacity: 0.8; 
        transform: scale(1.05);
    }
}

@keyframes statusPulse {
    0%, 100% { 
        opacity: 1; 
        transform: scale(1);
    }
    50% { 
        opacity: 0.6; 
        transform: scale(1.2);
    }
}


/* Responsive Design for Channel Categories */
@media (max-width: 768px) {
    .channel-categories-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 0.75rem;
    }

    .channel-category-card {
        padding: 1.25rem;
        min-height: 120px;
    }

    .channel-category-icon {
        width: 45px;
        height: 45px;
        font-size: 1.2rem;
        margin-bottom: 0.75rem;
    }

    .channel-category-name {
        font-size: 1rem;
    }

    .channel-category-desc {
        font-size: 0.8rem;
    }
}

@media (max-width: 480px) {
    .channel-categories-grid {
        grid-template-columns: 1fr;
        gap: 0.5rem;
    }

    .channel-category-card {
        padding: 1rem;
        min-height: 100px;
    }

    .channel-category-icon {
        width: 40px;
        height: 40px;
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
    }

    .channel-category-name {
        font-size: 0.95rem;
    }

    .channel-category-desc {
        font-size: 0.75rem;
    }

    .channel-category-badge {
        font-size: 0.7rem;
        padding: 0.25rem 0.6rem;
    }
}


@media (max-width: 768px) {
    .channel-sub-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1rem;
    }

    .channel-item {
        padding: 1.25rem;
        min-height: 85px;
    }

    .channel-logo {
        width: 65px;
        height: 65px;
        font-size: 1.2rem;
    }

    .channel-name {
        font-size: 1rem;
    }

    .channel-quality {
        font-size: 0.8rem;
        padding: 0.3rem 0.6rem;
    }

    .channel-status {
        width: 8px;
        height: 8px;
    }
}

@media (max-width: 480px) {
    .channel-categories-grid {
        grid-template-columns: 1fr;
    }

    .channel-sub-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }

    .channel-item {
        padding: 1rem;
        min-height: 80px;
    }

    .channel-logo {
        width: 60px;
        height: 60px;
        font-size: 1.1rem;
    }

    .channel-name {
        font-size: 0.95rem;
    }

    .channel-quality {
        font-size: 0.75rem;
        padding: 0.25rem 0.5rem;
    }

    .channel-status {
        width: 7px;
        height: 7px;
        top: 8px;
        right: 8px;
    }

    .search-container {
        padding: 0 0.5rem;
    }

    .filter-btn {
        padding: 0.3rem 0.6rem;
        font-size: 0.75rem;
    }
}


/* ===== SIMPLE NOTIFICATION SYSTEM ===== */
.notification-container {
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 5000;
    max-width: 380px;
    width: 100%;
    pointer-events: none;
    padding: 0 1rem;
}

.notification {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border: none;
    border-radius: 16px;
    padding: 1rem 1.25rem;
    margin-bottom: 0.75rem;
    color: #374151;
    font-size: 0.9rem;
    font-weight: 500;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
    transform: translateY(-30px) scale(0.95);
    opacity: 0;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    pointer-events: auto;
    position: relative;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    border-left: 3px solid #e5e7eb;
}

.notification.show {
    transform: translateY(0) scale(1);
    opacity: 1;
}

.notification-icon {
    width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
    flex-shrink: 0;
    border-radius: 50%;
    padding: 6px;
}

.notification.success {
    border-left-color: #10b981;
    background: rgba(240, 253, 244, 0.95);
    color: #065f46;
}

.notification.success .notification-icon {
    background: rgba(16, 185, 129, 0.1);
    color: #10b981;
}

.notification.error {
    border-left-color: #ef4444;
    background: rgba(254, 242, 242, 0.95);
    color: #991b1b;
}

.notification.error .notification-icon {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
}

.notification.info {
    border-left-color: #3b82f6;
    background: rgba(239, 246, 255, 0.95);
    color: #1e40af;
}

.notification.info .notification-icon {
    background: rgba(59, 130, 246, 0.1);
    color: #3b82f6;
}

.notification-text {
    flex: 1;
    line-height: 1.5;
    font-weight: 500;
}

.notification-close {
    width: 18px;
    height: 18px;
    border: none;
    background: rgba(107, 114, 128, 0.1);
    color: #6b7280;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    transition: all 0.2s ease;
    flex-shrink: 0;
    border-radius: 50%;
}

.notification-close:hover {
    background: rgba(107, 114, 128, 0.2);
    color: #374151;
    transform: scale(1.1);
}



/* Mobile responsive */
@media (max-width: 768px) {
    .notification-container {
        top: 70px;
        left: 1rem;
        right: 1rem;
        transform: none;
        max-width: none;
        padding: 0;
    }

    .notification {
        padding: 1rem;
        font-size: 0.85rem;
        border-radius: 14px;
        margin-bottom: 0.5rem;
    }

    .notification-icon {
        width: 16px;
        height: 16px;
        font-size: 0.8rem;
        padding: 5px;
    }

    .notification-close {
        width: 16px;
        height: 16px;
        font-size: 0.75rem;
    }
}

/* ===== PERFORMANCE OPTIMIZATIONS ===== */
/* تحسينات الأداء للأجهزة المختلفة */

/* تقليل حركة hover لتكون أقل تأثيراً */
.card:hover,
.channel-item:hover,
.nav-btn:hover,
.logo:hover,
.user-avatar-simple:hover,
.premium-btn:hover,
.contact-link:hover,
.league-link:hover .league-item,
.league-link:hover .league-arrow,
.theme-btn:hover,
.simple-login-btn:hover,
.form-input:focus,
.btn-primary:hover,
.btn-secondary:hover,
.hero-channels-btn:hover,
.hero-channels-btn:hover i:last-child,
.dazn-card:hover,
.competition-card:hover,
.competition-card:hover .competition-image,
.competition-card:hover .competition-image img,
.card:hover .card-arrow,
.card:hover .card-icon,
.card:hover::before,
.channel-category-card:hover,
.channel-category-card:hover .channel-category-icon,
.channel-item:hover,
.back-btn:hover,
.search-box:focus-within,
.search-clear:hover,
.search-result-item:hover,
.football-event-card:hover,
.welcome-channels-btn:hover,
.welcome-channels-btn:hover i,
.live-match-card:hover,
.favorite-btn:hover,
.competition-card-enhanced:hover,
.admin-tab:hover,
.admin-btn.primary:hover,
.admin-btn.secondary:hover,
.admin-btn.danger:hover,
.action-btn:hover,
.action-btn.delete:hover,
#jwPlayer .jw-settings-content-item:hover,
#jwPlayer .jw-settings-content-item.jw-settings-active,
#jwPlayer .jw-icon:hover,
.color-option:hover {
    transition-duration: 0.1s !important;
}

/* إزالة الأنيميشن غير الضرورية */
.loading-container,
.loading-logo img,
.logo:hover img,
.hero-channels-btn::before,
.welcome-channels-btn::before,
.search-result-item::before,
.football-event-card::after,
.search-box::before,
.search-box::after,
.live-dot::after,
.channel-status::after,
.tv-focused::after,
.tv-navigation-hint {
    animation: none !important;
    transition: none !important;
}


/* وضع الأداء المنخفض للأجهزة الضعيفة */
.low-performance-mode * {
    transition-duration: 0.1s !important;
    animation-duration: 0.1s !important;
}

.low-performance-mode .card:hover,
.low-performance-mode .channel-item:hover,
.low-performance-mode .nav-btn:hover {
    transform: none !important;
    box-shadow: none !important;
}

/* تحسينات للتلفاز */
.tv-optimized {
    font-size: 18px;
}

.tv-optimized .card,
.tv-optimized .channel-item,
.tv-optimized .nav-btn {
    padding: 1.5rem;
    border-radius: 8px;
}

/* تقليل الرسوم المتحركة للأجهزة الضعيفة */
@media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        transform: none !important;
    }
}

/* تحسين الأداء للشاشات اللمسية */
@media (hover: none) and (pointer: coarse) {
    .card:hover, .channel-item:hover, .nav-btn:hover {
        transform: none;
        box-shadow: none;
    }
}

/* تحسينات للذاكرة والأداء */
.card, .channel-item, .nav-btn {
    will-change: auto;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

/* ===== TV AND LARGE SCREEN SUPPORT ===== */
/* دعم الشاشات الكبيرة مثل Android TV و Smart TV */

/* Android TV Support - Base Settings */
.android-tv {
    cursor: none;
    overflow: hidden;
}

.android-tv * {
    cursor: none !important;
}

/* TV Remote Focus Styles - Enhanced */
.tv-focused {
    outline: 3px solid var(--accent-primary) !important;
    outline-offset: 3px !important;
    background: rgba(var(--accent-primary), 0.1) !important;
    transform: scale(1.05) !important;
    box-shadow: 0 0 25px rgba(var(--accent-primary), 0.5) !important;
    z-index: 100 !important;
    transition: all 0.2s ease !important;
}

.tv-focused::after {
    content: '';
    position: absolute;
    top: -6px;
    left: -6px;
    right: -6px;
    bottom: -6px;
    border: 2px solid var(--accent-primary);
    border-radius: 12px;
    background: rgba(var(--accent-primary), 0.05);
    z-index: -1;
    animation: tvFocusPulse 2s infinite;
}

@keyframes tvFocusPulse {
    0%, 100% { 
        opacity: 0.3;
        transform: scale(1);
    }
    50% { 
        opacity: 0.7;
        transform: scale(1.02);
    }
}

/* Android TV Specific Screen Sizes */
@media (min-width: 1280px) and (max-height: 720px) {
    /* 720p Android TV */
    html {
        font-size: 18px;
    }

    .main-content {
        padding: 2rem 3rem;
    }

    .channel-categories-grid {
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
    }

    .channel-category-card {
        min-height: 160px;
        padding: 2rem;
    }
}

@media (min-width: 1920px) and (max-height: 1080px) {
    /* 1080p Android TV */
    html {
        font-size: 20px;
    }

    .main-content {
        padding: 3rem 4rem;
    }

    .header {
        min-height: 80px;
    }

    .header-content {
        padding: 0 4rem;
    }

    .logo img {
        height: 50px;
    }

    .nav-btn {
        width: 60px;
        height: 60px;
        font-size: 1.5rem;
    }

    .user-avatar-simple {
        width: 55px;
        height: 55px;
        font-size: 1.4rem;
    }

    .premium-btn {
        padding: 1rem 2rem;
        font-size: 1.2rem;
    }

    .channel-categories-grid {
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 2.5rem;
    }

    .channel-sub-grid {
        grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
        gap: 2rem;
    }

    .channel-item {
        min-height: 120px;
        padding: 2rem;
    }

    .channel-logo {
        width: 90px;
        height: 90px;
    }

    .channel-name {
        font-size: 1.3rem;
    }
}

@media (min-width: 2560px) {
    /* 4K Android TV */
    html {
        font-size: 24px;
    }

    .main-content {
        padding: 4rem 6rem;
    }

    .channel-categories-grid {
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 3rem;
    }

    .channel-sub-grid {
        grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
        gap: 2.5rem;
    }

    .channel-item {
        min-height: 140px;
        padding: 2.5rem;
    }

    .channel-logo {
        width: 100px;
        height: 100px;
    }

    .channel-name {
        font-size: 1.5rem;
    }

    .football-event-card {
        flex: 0 0 500px;
        height: 300px;
    }

    .competition-card-enhanced {
        flex: 0 0 250px;
    }

    .competition-image-wrapper {
        width: 250px;
        height: 250px;
    }
}

/* TV Safe Zone - للتأكد من أن المحتوى لا يقطع على حواف الشاشة */
@media (orientation: landscape) and (min-width: 1280px) {
    .main-content {
        margin: 5% 5%;
        padding: 2rem;
    }

    .header-content {
        margin: 0 5%;
    }

    .sidebar {
        margin-right: 5%;
        width: calc(320px - 5%);
    }
}

/* Remote Control Optimizations */
.remote-mode .focusable:focus,
.remote-mode .tv-focused {
    outline: 4px solid var(--accent-primary) !important;
    outline-offset: 4px !important;
    background: rgba(var(--accent-primary), 0.15) !important;
    transform: scale(1.08) !important;
    box-shadow: 
        0 0 30px rgba(var(--accent-primary), 0.6),
        0 0 15px rgba(var(--accent-primary), 0.4) !important;
    border-radius: 16px !important;
}

/* Enhanced Card Focus for TV */
.remote-mode .card.tv-focused,
.remote-mode .channel-item.tv-focused,
.remote-mode .channel-category-card.tv-focused {
    border: 3px solid var(--accent-primary) !important;
    background: rgba(var(--accent-primary), 0.1) !important;
    transform: scale(1.05) translateY(-8px) !important;
}

.remote-mode .football-event-card.tv-focused,
.remote-mode .competition-card-enhanced.tv-focused {
    transform: scale(1.08) translateY(-10px) !important;
    box-shadow: 
        0 15px 50px rgba(0, 0, 0, 0.3),
        0 0 30px rgba(var(--accent-primary), 0.7) !important;
}

/* Button Focus States for TV Remote */
.remote-mode .btn.tv-focused,
.remote-mode .nav-btn.tv-focused,
.remote-mode .welcome-channels-btn.tv-focused {
    transform: scale(1.1) !important;
    box-shadow: 0 0 25px rgba(var(--accent-primary), 0.8) !important;
}

/* TV Navigation Indicators */
.tv-navigation-hint {
    position: fixed;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 1rem 2rem;
    border-radius: 25px;
    font-size: 1rem;
    font-weight: 600;
    display: none;
    z-index: 6000;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(var(--accent-primary), 0.5);
}

.remote-mode .tv-navigation-hint {
    display: block;
    animation: fadeInUp 0.5s ease;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

/* Android TV App Icon Style */
.tv-app-icon {
    display: none;
}

@media (orientation: landscape) and (min-width: 1280px) {
    .tv-app-icon {
        display: block;
        position: fixed;
        top: 2rem;
        left: 2rem;
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
        border-radius: 20px;
        z-index: 1001;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        color: #000;
    }
}

/* Fullscreen Mode for Android TV */
@media (display-mode: fullscreen) {
    .header {
        padding-top: env(safe-area-inset-top);
    }

    .main-content {
        padding-bottom: calc(2rem + env(safe-area-inset-bottom));
    }
}

/* Performance Optimizations for TV */
.tv-optimized * {
    will-change: transform, opacity;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

.tv-optimized .transition-disabled * {
    transition: none !important;
    animation: none !important;
}

/* TV Volume and Power Button Handling */
.tv-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 9999;
    display: none;
    align-items: center;
    justify-content: center;
}

.tv-overlay.active {
    display: flex;
}

.tv-message {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    padding: 3rem;
    text-align: center;
    max-width: 500px;
    border: 2px solid var(--accent-primary);
}

.tv-message h2 {
    color: var(--accent-primary);
    font-size: 2rem;
    margin-bottom: 1rem;
}

.tv-message p {
    color: var(--text-secondary);
    font-size: 1.2rem;
}

/* ===== RESPONSIVE DESIGN ===== */
@media (max-width: 768px) {
    html {
        font-size: 14px;
    }

    .section-title {
        font-size: 1.8rem;
    }

    .hero-section {
        padding: 1.5rem;
    }

    .hero-players-container {
        grid-template-columns: 1fr;
        gap: 2rem;
        text-align: center;
    }

    .hero-players-image {
        order: 2;
    }

    .hero-content {
        order: 1;
    }

    .hero-content h2 {
        font-size: 2rem;
    }

    .hero-features {
        align-items: center;
    }

    .hero-channels-btn {
        align-self: center;
    }

    .content-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }

    .settings-grid {
        grid-template-columns: 1fr;
    }

    .channel-categories-grid {
        grid-template-columns: 1fr;
    }

    .sidebar {
        width: 100%;
        right: -100%;
    }

    .sidebar-header {
        padding: 1.25rem;
    }

    .sidebar-title {
        font-size: 1.2rem;
    }

    .menu-item {
        padding: 0.875rem;
        font-size: 0.9rem;
    }

    .menu-item i {
        font-size: 1rem;
    }

    .contact-link {
        padding: 0.75rem;
        font-size: 0.85rem;
    }

    .profile-container {
        width: 95%;
        margin: 1rem;
    }

    .notification-container {
        top: 70px;
        left: 1rem;
        right: 1rem;
        transform: none;
        max-width: none;
    }

    .color-themes {
        grid-template-columns: repeat(5, 1fr);
    }
}

@media (max-width: 480px) {
    .header {
        padding: 0.3rem 0;
    }

    .header-content {
        padding: 0 0.5rem;
    }

    .logo {
        font-size: 1.2rem;
    }

    .user-info {
        padding: 0.4rem 0.6rem;
        gap: 0.4rem;
    }

    .user-avatar {
        width: 30px;
        height: 30px;
        font-size: 0.75rem;
        box-shadow: 0 2px 10px rgba(var(--accent-primary), 0.3), 
                    0 1px 4px rgba(0, 0, 0, 0.15);
    }

    .nav-btn {
        width: 32px;
        height: 32px;
        font-size: 0.85rem;
    }

    .main-app {
        margin-top: 45px;
    }

    .login-box {
        padding: 2rem 1.5rem;
    }

    .hero-info h2 {
        font-size: 1.6rem;
    }

    .card-content {
        padding: 1.2rem;
    }

    .team-logo {
        width: 50px;
        height: 50px;
        font-size: 1.3rem;
    }

    .color-themes {
        grid-template-columns: repeat(3, 1fr);
    }

    .color-theme {
        width: 40px;
        height: 40px;
    }
}

/* ===== SEARCH STYLES ===== */
.search-container {
    max-width: 800px;
    margin: 0 auto;
}

.search-box {
    position: relative;
    background: var(--gradient-card);
    border: 1px solid var(--border-primary);
    border-radius: 50px;
    padding: 0.75rem 1.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    transition: var(--transition);
    margin-bottom: 1.5rem;
}

.search-box:focus-within {
    border-color: var(--accent-primary);
    box-shadow: 0 0 20px rgba(var(--accent-primary), 0.2);
}

.search-icon {
    color: var(--text-muted);
    font-size: 1.1rem;
}

.search-input {
    flex: 1;
    border: none;
    background: transparent;
    color: var(--text-primary);
    font-size: 1rem;
    outline: none;
    padding: 0.5rem 0;
}

.search-input::placeholder {
    color: var(--text-muted);
}

.search-clear {
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 50%;
    transition: var(--transition);
}

.search-clear:hover {
    color: var(--accent-primary);
    background: rgba(var(--accent-primary), 0.1);
}



.search-results {
    margin-bottom: 2rem;
}

.search-results-title {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--accent-primary);
    margin-bottom: 1rem;
    text-align: center;
}

.search-results-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1rem;
}

.search-result-item {
    background: var(--gradient-card);
    border: 1px solid var(--border-primary);
    border-radius: var(--border-radius);
    padding: 1rem;
    text-decoration: none;
    color: inherit;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 1rem;
    position: relative;
}

.search-result-item:hover {
    background: rgba(var(--accent-primary), 0.05);
    border-color: var(--accent-primary);
    transform: translateY(-3px);
}

.search-result-icon {
    width: 45px;
    height: 45px;
    border-radius: 10px;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.1rem;
    flex-shrink: 0;
}

.search-result-info {
    flex: 1;
    min-width: 0;
}

.search-result-name {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 0.95rem;
    margin-bottom: 0.3rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.search-result-category {
    font-size: 0.8rem;
    color: var(--text-muted);
    background: rgba(var(--accent-primary), 0.1);
    padding: 0.2rem 0.6rem;
    border-radius: 10px;
    display: inline-block;
}

/* Performance Optimizations */
.lazy-load {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
}

.lazy-load.loaded {
    opacity: 1;
    transform: translateY(0);
}

/* Enhanced Mobile Responsiveness */
@media (max-width: 768px) {
    .search-box {
        padding: 0.6rem 1rem;
        margin-bottom: 1rem;
    }

    .search-input {
        font-size: 0.9rem;
    }

    .filter-btn {
        padding: 0.4rem 0.8rem;
        font-size: 0.8rem;
    }

    .search-results-grid {
        grid-template-columns: 1fr;
    }

    .search-result-item {
        padding: 0.75rem;
    }

    .search-result-icon {
        width: 40px;
        height: 40px;
        font-size: 1rem;
    }

    .hero-players-container {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }

    .hero-content h2 {
        font-size: 1.8rem;
        line-height: 1.3;
    }

    .hero-content p {
        font-size: 1rem;
        line-height: 1.6;
    }

    .hero-channels-btn {
        padding: 1rem 2rem;
        font-size: 1rem;
    }

    .content-grid {
        grid-template-columns: 1fr;
    }

    .channel-categories-grid {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }

    .channel-sub-grid {
        grid-template-columns: 1fr;
    }

    .sidebar {
        width: 100vw;
        right: -100vw;
    }
}

@media (max-width: 480px) {
    .hero-content h2 {
        font-size: 1.5rem;
    }

    .channel-categories-grid {
        grid-template-columns: 1fr;
    }

    .search-container {
        padding: 0 0.5rem;
    }

    .filter-btn {
        padding: 0.3rem 0.6rem;
        font-size: 0.75rem;
    }
}

/* Touch Improvements for Mobile */
@media (hover: none) {
    .card:hover,
    .channel-item:hover,
    .search-result-item:hover {
        transform: none;
    }

    .card:active,
    .channel-item:active,
    .search-result-item:active {
        transform: scale(0.98);
    }
}

/* ===== BEST OF FOOTBALL SECTION STYLES ===== */
.best-football-section {
    margin-bottom: 4rem;
}

.best-football-slider-container {
    position: relative;
    overflow: hidden;
}

.best-football-slider {
    display: flex;
    gap: 1.5rem;
    overflow-x: auto;
    scroll-behavior: smooth;
    padding: 1rem 0 2rem 0;
    scrollbar-width: none;
    -ms-overflow-style: none;
    cursor: grab;
    user-select: none;
    will-change: transform;
    transform: translateZ(0);
}

.best-football-slider::-webkit-scrollbar {
    display: none;
}

.best-football-slider.dragging {
    cursor: grabbing;
    scroll-behavior: auto;
}

.football-event-card {
    flex: 0 0 420px;
    position: relative;
    border-radius: 12px;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.12s ease-out, box-shadow 0.12s ease-out;
    background: var(--gradient-card);
    border: 1px solid var(--border-primary);
    height: 250px;
    margin-bottom: 10px;
    will-change: transform;
    transform: translateZ(0);
}

.football-event-card:hover {
    transform: translateY(-3px) translateZ(0);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
    border-color: var(--accent-primary);
}

.card-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    z-index: 1;
    border-radius: 12px;
}

.card-background::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 50%;
    background: linear-gradient(180deg, 
        transparent 0%, 
        rgba(0, 0, 0, 0.3) 50%, 
        rgba(0, 0, 0, 0.8) 100%);
    border-radius: 0 0 12px 12px;
}

/* حالات الأحداث الرياضية المحسنة */
.event-status-badge {
    position: absolute;
    top: 12px;
    left: 12px;
    padding: 6px 12px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 0.75rem;
    text-transform: uppercase;
    z-index: 10;
    border: 1px solid transparent;
    backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    gap: 5px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
}

/* الحالة: مباشر */
.event-status-badge.live {
    background: rgba(255, 0, 0, 0.9);
    color: white;
    border-color: rgba(255, 0, 0, 0.3);
    animation: livePulse 2s infinite;
}

.event-status-badge.live::before {
    content: '';
    width: 6px;
    height: 6px;
    background: white;
    border-radius: 50%;
    animation: statusPulse 1.5s infinite;
}

/* الحالة: قادم */
.event-status-badge.upcoming {
    background: rgba(34, 197, 94, 0.9);
    color: white;
    border-color: rgba(34, 197, 94, 0.3);
}

.event-status-badge.upcoming::before {
    content: '';
    width: 6px;
    height: 6px;
    background: white;
    border-radius: 50%;
}

/* الحالة: انتهى */
.event-status-badge.finished {
    background: rgba(107, 114, 128, 0.9);
    color: white;
    border-color: rgba(107, 114, 128, 0.3);
}

.event-status-badge.finished::before {
    content: '';
    width: 6px;
    height: 6px;
    background: white;
    border-radius: 50%;
}

/* إزالة الشارة القديمة */
.live-badge-football {
    display: none;
}

.logo-container-football {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 10;
}

.football-logo {
    font-size: 1.5rem;
    font-weight: 700;
    color: white;
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
    background: rgba(0, 0, 0, 0.3);
    padding: 8px 12px;
    border-radius: 8px;
    backdrop-filter: blur(5px);
}

.football-logo .sport {
    display: block;
    line-height: 1;
}

.football-logo .vision {
    display: block;
    line-height: 1;
}

.football-info {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(180deg, 
        transparent 0%, 
        rgba(0, 0, 0, 0.4) 40%, 
        rgba(0, 0, 0, 0.9) 100%);
    padding: 20px;
    z-index: 10;
}

.football-title {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 8px;
    color: #ffffff;
    line-height: 1.3;
    text-shadow: 0 2px 8px rgba(0, 0, 0, 0.7);
}

.football-subtitle {
    font-size: 0.95rem;
    color: rgba(255, 255, 255, 0.9);
    line-height: 1.4;
    text-shadow: 0 1px 4px rgba(0, 0, 0, 0.6);
}

/* Responsive Design for Channel Categories */
@media (max-width: 768px) {
    .channel-categories-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 0.75rem;
    }

    .channel-category-card {
        padding: 1.25rem;
        min-height: 120px;
    }

    .channel-category-icon {
        width: 45px;
        height: 45px;
        font-size: 1.2rem;
        margin-bottom: 0.75rem;
    }

    .channel-category-name {
        font-size: 1rem;
    }

    .channel-category-desc {
        font-size: 0.8rem;
    }

    /* Best of Football Section */
    .football-event-card {
        flex: 0 0 340px;
        height: 220px;
    }

    .football-logo {
        font-size: 2rem;
    }

    .logo-container-football {
        left: 20px;
    }

    .football-title {
        font-size: 1.5rem;
    }

    .ball-container {
        width: 60px;
        height: 60px;
        bottom: 20px;
        right: 20px;
    }

    .best-football-slider {
        gap: 1rem;
    }
}

@media (max-width: 480px) {
    .channel-categories-grid {
        grid-template-columns: 1fr;
        gap: 0.5rem;
    }

    .channel-category-card {
        padding: 1rem;
        min-height: 100px;
    }

    .channel-category-icon {
        width: 40px;
        height: 40px;
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
    }

    .channel-category-name {
        font-size: 0.95rem;
    }

    .channel-category-desc {
        font-size: 0.75rem;
    }

    .channel-category-badge {
        font-size: 0.7rem;
        padding: 0.25rem 0.6rem;
    }

    /* Best of Football Section */
    .football-event-card {
        flex: 0 0 300px;
        height: 200px;
    }

    .football-logo {
        font-size: 1.8rem;
    }

    .football-title {
        font-size: 1.3rem;
    }

    .football-subtitle {
        font-size: 1rem;
    }

    .ball-container {
        width: 50px;
        height: 50px;
    }
}

/* ===== SIMPLE WELCOME SECTION STYLES ===== */
.simple-welcome-section {
    background: linear-gradient(135deg, rgba(var(--accent-primary), 0.1) 0%, rgba(var(--accent-secondary), 0.05) 100%);
    border: 1px solid rgba(var(--accent-primary), 0.2);
    border-radius: 24px;
    padding: 2.5rem 2rem;
    margin: 1.5rem 0 3rem;
    text-align: center;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
    position: relative;
    overflow: hidden;
}

.simple-welcome-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
}

.welcome-container {
    max-width: 600px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2rem;
}

.welcome-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
}

.app-logo img {
    width: 70px;
    height: 70px;
    border-radius: 20px;
    box-shadow: 0 8px 30px rgba(var(--accent-primary), 0.4);
    transition: all 0.3s ease;
}

.app-logo img:hover {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 12px 40px rgba(var(--accent-primary), 0.6);
}

.welcome-title {
    font-size: 2.2rem;
    font-weight: 800;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin: 0;
    line-height: 1.2;
    letter-spacing: -0.02em;
}

.welcome-subtitle {
    font-size: 1rem;
    color: var(--text-secondary);
    margin: 0;
    line-height: 1.5;
    opacity: 0.9;
    font-weight: 500;
}

.welcome-action {
    margin-top: 0.5rem;
}

.welcome-channels-btn {
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    color: #000;
    border: none;
    padding: 1rem 2.5rem;
    border-radius: 50px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    transition: all 0.3s ease;
    box-shadow: 0 8px 25px rgba(var(--accent-primary), 0.3);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    position: relative;
    overflow: hidden;
}

.welcome-channels-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
}

.welcome-channels-btn:hover::before {
    left: 100%;
}

.welcome-channels-btn:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 12px 35px rgba(var(--accent-primary), 0.5);
}

.welcome-channels-btn:active {
    transform: translateY(-1px) scale(1.02);
}

.welcome-channels-btn i {
    font-size: 1.2rem;
    transition: all 0.3s ease;
}

.welcome-channels-btn:hover i {
    transform: scale(1.1);
}

/* Responsive Design for Welcome Section */
@media (max-width: 768px) {
    .simple-welcome-section {
        padding: 2rem 1.5rem;
        margin: 1rem 0 2.5rem;
        border-radius: 20px;
    }

    .welcome-container {
        gap: 1.5rem;
    }

    .app-logo img {
        width: 60px;
        height: 60px;
    }

    .welcome-title {
        font-size: 2rem;
    }

    .welcome-subtitle {
        font-size: 0.95rem;
    }

    .welcome-channels-btn {
        padding: 0.9rem 2rem;
        font-size: 1rem;
        border-radius: 40px;
    }
}

@media (max-width: 480px) {
    .simple-welcome-section {
        padding: 1.5rem 1rem;
        margin: 0.5rem 0 2rem;
        border-radius: 16px;
    }

    .welcome-container {
        gap: 1.25rem;
    }

    .app-logo img {
        width: 50px;
        height: 50px;
        border-radius: 16px;
    }

    .welcome-title {
        font-size: 1.8rem;
    }

    .welcome-subtitle {
        font-size: 0.9rem;
    }

    .welcome-channels-btn {
        padding: 0.8rem 1.5rem;
        font-size: 0.95rem;
        width: 100%;
        max-width: 280px;
        border-radius: 35px;
    }

    .welcome-channels-btn i {
        font-size: 1.1rem;
    }
}

/* Live Matches Section */
.live-matches-section {
    margin-bottom: 4rem;
}

.section-header-enhanced {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 2rem;
}

.section-title-group {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.section-icon {
    width: 65px;
    height: 65px;
    border-radius: 16px;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #000;
    font-size: 1.8rem;
    box-shadow: 0 6px 20px rgba(var(--accent-primary), 0.3);
}

.section-title {
    font-size: 1.8rem;
    font-weight: 800;
    color: var(--text-primary);
    margin: 0;
}

.section-subtitle {
    color: var(--text-secondary);
    font-size: 0.95rem;
    margin: 0;
}

.live-indicator-group {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: rgba(255, 71, 87, 0.1);
    padding: 0.5rem 1rem;
    border-radius: 20px;
    border: 1px solid rgba(255, 71, 87, 0.3);
}

.live-dot {
    width: 8px;
    height: 8px;
    background: #ff4757;
    border-radius: 50%;
    animation: livePulse 2s infinite;
}

.live-text {
    color: #ff4757;
    font-weight: 600;
    font-size: 0.9rem;
}

.live-matches-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 1.5rem;
}

.live-match-card {
    background: var(--gradient-card);
    border: 1px solid var(--border-primary);
    border-radius: 16px;
    padding: 1.5rem;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.live-match-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
    border-color: var(--accent-primary);
}

.match-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.match-league {
    color: var(--text-secondary);
    font-size: 0.85rem;
    font-weight: 600;
}

.live-badge {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    background: rgba(255, 71, 87, 0.1);
    color: #ff4757;
    padding: 0.3rem 0.8rem;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 600;
}

.live-badge i {
    animation: livePulse 2s infinite;
}

.match-teams {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
}

.team {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    flex: 1;
}

.team-logo {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #000;
    font-size: 1.1rem;
}

.team-name {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 0.9rem;
    text-align: center;
}

.match-score {
    text-align: center;
    margin: 0 1rem;
}

.score {
    font-size: 1.8rem;
    font-weight: 900;
    color: var(--accent-primary);
    line-height: 1;
    margin-bottom: 0.5rem;
}

.match-time {
    color: var(--text-secondary);
    font-size: 0.85rem;
    font-weight: 600;
}

.match-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.match-viewers {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--text-muted);
    font-size: 0.85rem;
}

.favorite-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid var(--border-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.3s ease;
}

.favorite-btn:hover {
    background: rgba(255, 71, 87, 0.2);
    border-color: #ff4757;
    color: #ff4757;
    transform: scale(1.1);
}

.favorite-btn.active {
    background: #ff4757;
    border-color: #ff4757;
    color: white;
}

/* Competitions Section */
.competitions-section {
    margin-bottom: 4rem;
}

.competitions-slider-container {
    position: relative;
    overflow: hidden;
}

.competitions-slider {
    display: flex;
    gap: 1.5rem;
    overflow-x: auto;
    scroll-behavior: smooth;
    padding: 1rem 0 2rem 0;
    scrollbar-width: none;
    -ms-overflow-style: none;
    will-change: transform;
    transform: translateZ(0);
}

.competitions-slider::-webkit-scrollbar {
    display: none;
}

.competition-card-enhanced {
    flex: 0 0 200px;
    cursor: pointer;
    transition: transform 0.1s ease-out;
    will-change: transform;
    transform: translateZ(0);
}

.competition-card-enhanced:hover {
    transform: translateY(-3px) translateZ(0);
}

.competition-image-wrapper {
    position: relative;
    width: 200px;
    height: 200px;
    border-radius: 16px;
    overflow: hidden;
    margin-bottom: 1rem;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

.competition-image-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}



.competition-info {
    text-align: center;
}

.competition-name {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0 0 0.5rem 0;
    line-height: 1.3;
}

.competition-desc {
    color: var(--text-secondary);
    font-size: 0.85rem;
    margin: 0;
    line-height: 1.4;
}

/* Responsive Design for Enhanced Live Section */
@media (max-width: 768px) {
    .hero-main-title {
        font-size: 2.5rem;
    }

    .hero-description {
        font-size: 1.1rem;
    }

    .hero-stats {
        gap: 2rem;
    }

    .stat-number {
        font-size: 2rem;
    }

    .hero-action-buttons {
        flex-direction: column;
        align-items: center;
    }

    .primary-action-btn,
    .secondary-action-btn {
        width: 100%;
        max-width: 300px;
        justify-content: center;
    }

    .live-matches-grid {
        grid-template-columns: 1fr;
    }

    .competitions-slider {
        gap: 1rem;
    }

    .competition-card-enhanced {
        flex: 0 0 160px;
    }

    .competition-image-wrapper {
        width: 160px;
        height: 160px;
    }


}

@media (max-width: 480px) {
    .enhanced-hero-section {
        min-height: 70vh;
    }

    .hero-main-title {
        font-size: 2rem;
    }

    .hero-stats {
        gap: 1.5rem;
    }

    .stat-number {
        font-size: 1.8rem;
    }

    .section-title {
        font-size: 1.5rem;
    }

    .live-match-card {
        padding: 1rem;
    }

    .score {
        font-size: 1.5rem;
    }
}



/* ===== ADMIN PANEL STYLES ===== */
.admin-tab {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border-primary);
    color: var(--text-primary);
    padding: 1rem 1.5rem;
    border-radius: 12px 12px 0 0;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    border-bottom: none;
}

.admin-tab:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: var(--accent-primary);
}

.admin-tab.active {
    background: var(--accent-primary);
    color: #000;
    border-color: var(--accent-primary);
}

.admin-tab-content {
    animation: fadeIn 0.3s ease;
}

.admin-input {
    width: 100%;
    padding: 1rem;
    border: 1px solid var(--border-primary);
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.05);
    color: var(--text-primary);
    font-size: 1rem;
    transition: all 0.3s ease;
}

.admin-input:focus {
    outline: none;
    border-color: var(--accent-primary);
    background: rgba(255, 255, 255, 0.1);
    box-shadow: 0 0 20px rgba(var(--accent-primary), 0.3);
}

.admin-btn {
    padding: 1rem 2rem;
    border: none;
    border-radius: 12px;
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.admin-btn.primary {
    background: var(--accent-primary);
    color: #000;
}

.admin-btn.primary:hover {
    background: var(--accent-secondary);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(var(--accent-primary), 0.4);
}

.admin-btn.secondary {
    background: rgba(255, 255, 255, 0.1);
    color: var(--text-primary);
    border: 1px solid var(--border-primary);
}

.admin-btn.secondary:hover {
    background: rgba(255, 255, 255, 0.15);
    border-color: var(--accent-primary);
    transform: translateY(-2px);
}

.admin-btn.danger {
    background: rgba(255, 71, 87, 0.2);
    color: #ff4757;
    border: 1px solid rgba(255, 71, 87, 0.5);
}

.admin-btn.danger:hover {
    background: #ff4757;
    color: white;
    transform: translateY(-2px);
}

.category-item, .channel-item-admin {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 1.2rem;
    margin-bottom: 0.75rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.category-item:hover, .channel-item-admin:hover {
    background: rgba(59, 130, 246, 0.05);
    border-color: rgba(59, 130, 246, 0.2);
    transform: translateY(-1px);
    box-shadow: 0 4px 16px rgba(59, 130, 246, 0.1);
}

.item-info {
    flex: 1;
}

.item-title {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 1rem;
    margin-bottom: 0.25rem;
}

.item-subtitle {
    color: var(--text-secondary);
    font-size: 0.85rem;
    opacity: 0.9;
}

.item-actions {
    display: flex;
    gap: 0.5rem;
}

.action-btn {
    width: 36px;
    height: 36px;
    border-radius: 10px;
    border: 1px solid transparent;
    background: rgba(255, 255, 255, 0.08);
    color: var(--text-primary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    backdrop-filter: blur(5px);
}

.action-btn:hover {
    background: rgba(59, 130, 246, 0.15);
    color: #3b82f6;
    border-color: rgba(59, 130, 246, 0.3);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
}

.action-btn.delete {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
    border-color: rgba(239, 68, 68, 0.2);
}

.action-btn.delete:hover {
    background: rgba(239, 68, 68, 0.2);
    color: #ffffff;
    border-color: rgba(239, 68, 68, 0.4);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* ===== VIDEO PLAYER STYLES ===== */
#videoPlayerModal {
    animation: fadeInPlayer 0.3s ease-out;
}

@keyframes fadeInPlayer {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* JW Player Custom Styles */
#jwPlayer .jw-label-live, #jwPlayer .jw-text-live {
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)) !important;
    color: #000 !important;
    border-radius: 25px !important;
    padding: 4px 12px !important;
    font-weight: bold !important;
    font-size: 14px !important;
    display: inline-flex !important;
    align-items: center;
    gap: 6px;
    text-shadow: none !important;
}

#jwPlayer .live-logo {
    display: inline-block;
    height: 1.2em;
    opacity: 0.9;
}

#jwPlayer .live-logo img {
    height: 100%;
    width: auto;
    display: block;
}

#jwPlayer .jw-settings-menu {
    background: rgba(0, 0, 0, 0.8) !important;
    backdrop-filter: blur(12px);
    border-radius: 14px !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    padding: 0 !important;
    overflow: hidden;
    animation: fadeIn 0.25s ease-in-out;
}

#jwPlayer .jw-settings-topbar {
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)) !important;
    color: #000 !important;
    font-weight: bold !important;
    padding: 10px !important;
    font-size: 15px !important;
    border-bottom: 1px solid rgba(255, 255, 255, 0.15);
}

#jwPlayer .jw-settings-content-item {
    color: white !important;
    font-size: 14px !important;
    padding: 8px 12px !important;
    transition: background 0.2s ease-in-out;
}

#jwPlayer .jw-settings-content-item:hover {
    background: rgba(255, 255, 255, 0.15) !important;
}

#jwPlayer .jw-settings-content-item.jw-settings-active {
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)) !important;
    color: #000 !important;
    border-radius: 8px !important;
}

#jwPlayer .jw-icon {
    color: white !important;
}

#jwPlayer .jw-icon:hover {
    color: var(--accent-primary) !important;
}

#jwPlayer .jw-progress {
    background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)) !important;
    height: 4px !important;
    border-radius: 2px !important;
    transition: width 0.2s ease-out !important;
}

#jwPlayer .jw-buffer {
    background: rgba(255, 255, 255, 0.3) !important;
    transition: width 0.3s ease-out !important;
}

#jwPlayer .jw-rail {
    background: rgba(255, 255, 255, 0.15) !important;
}

/* Mobile Responsive for Player */
@media (max-width: 768px) {
    #playerBackBtn {
        width: 45px !important;
        height: 45px !important;
        font-size: 1.1rem !important;
        top: 15px !important;
        right: 15px !important;
    }

    #jwPlayerContainer {
        padding: 70px 15px 15px !important;
    }

    #videoPlayerModal div[style*="top: 20px; left: 20px"] {
        top: 15px !important;
        left: 15px !important;
        padding: 6px 10px !important;
    }

    #videoPlayerModal div[style*="top: 20px; left: 20px"] img {
        height: 25px !important;
    }
}

/* ===== UTILITY CLASSES ===== */
.hidden {
    display: none !important;
}

.text-center {
    text-align: center;
}

/* ===== SCROLLBAR ===== */
::-webkit-scrollbar {
    width: 6px;
}

::-webkit-scrollbar-track {
    background: var(--primary-bg);
}

::-webkit-scrollbar-thumb {
    background: var(--border-primary);
    border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--accent-primary);
}

</style>
<body>
    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-container">
            <div class="loading-logo">
                <img src="https://iili.io/FSF1DcG.md.png" alt="Nova Logo">
            </div>
        </div>
    </div>

    <!-- Login Page -->
    <div class="login-page" id="loginPage">
        <div class="simple-login-container">
            <div class="simple-login-box">
                <!-- Logo -->
                <div class="simple-logo">
                    <img src="https://iili.io/FSF1DcG.md.png" alt="شعار التطبيق" class="logo-img">
                </div>

                <!-- Title -->
                <p class="simple-subtitle">احصل على إمكانية الوصول إلى الأحداث الرياضية المباشرة، أحدث القنوات الناقلة للمباريات بجودة فائقة، والمزيد، تابع بنفسك.</p>

                <!-- Login Form -->
                <form id="loginForm" class="simple-form">
                    <div class="simple-input-group">
                        <input type="text" class="simple-input" id="usernameInput" placeholder="اسم المستخدم" required>
                    </div>

                    <div class="simple-input-group" id="passwordGroup" style="display: none;">
                        <input type="password" class="simple-input" id="passwordInput" placeholder="كلمة المرور">
                    </div>

                    <button type="submit" class="simple-login-btn">
                        دخول
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- TV App Icon -->
    <div class="tv-app-icon">
        <i class="fas fa-tv"></i>
    </div>

    <!-- TV Navigation Overlay -->
    <div class="tv-overlay" id="tvOverlay">
        <div class="tv-message">
            <h2>Nova Sports TV</h2>
            <p>مُحسن للعرض على Android TV</p>
            <p>استخدم الريموت للتنقل بين القوائم</p>
        </div>
    </div>

    <!-- Main App -->
    <div class="main-app hidden" id="mainApp">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <!-- Left side: Logo and User profile -->
                <div class="header-left">
                    <div class="logo" onclick="showSection('live')" style="margin-right: 1rem;" tabindex="0">
                        <img src="https://iili.io/FSF1DcG.md.png" alt="شعار التطبيق" style="height: 40px; width: auto; object-fit: contain;">
                    </div>
                    <div class="user-avatar-simple" id="userAvatar">
                        <span id="userName">ض</span>
                    </div>
                </div>

                <!-- Center: Empty space for balance -->
                <div class="header-center">
                </div>

                <!-- Right side: Menu and Premium button -->
                <div class="header-right">
                    <button class="premium-btn" onclick="showPremiumMessage()" title="Premium" tabindex="0">
                        Premium
                    </button>
                    <button class="nav-btn" onclick="toggleSidebar()" title="القائمة" tabindex="0">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Live Section -->
            <section id="liveSection" class="section">

                <!-- Simple Welcome Section -->
                <div class="simple-welcome-section">
                    <div class="welcome-container">
                        <div class="welcome-header">
                            <div class="app-logo">
                                <img src="https://iili.io/FSF1DcG.md.png" alt="Nova Logo">
                            </div>
                            <h1 class="welcome-title">مرحباً بك في NoVA</h1>
                            <p class="welcome-subtitle">أفضل تطبيق لمشاهدة القنوات والأحداث الرياضية</p>
                        </div>

                        <div class="welcome-action">
                            <button class="welcome-channels-btn" onclick="showSection('channels')" tabindex="0">
                                <i class="fas fa-play-circle"></i>
لمُشاهدة القنوات الرياضية
                            </button>
                        </div>
                    </div>
                </div>



                <!-- Competitions Section -->
                <div class="competitions-section">
                    <div class="section-header-enhanced">
                        <div class="section-title-group">
                            <div class="section-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div>
                                <h3 class="section-title">أبرز البطولات</h3>
                                <p class="section-subtitle">كُل البطولات عبر تطبيقنا!</p>
                            </div>
                        </div>
                    </div>

                    <div class="competitions-slider-container">
                        <div class="competitions-slider" id="competitionsSlider">
                            <!-- Champions League -->
                            <div class="competition-card-enhanced" onclick="showNotification('دوري أبطال أوروبا - أقوى بطولة أوروبية', 'info')" tabindex="0">
                                <div class="competition-image-wrapper">
                                    <img src="https://static.diceplatform.com/prod/original/dce.uefatv/section/UCL/UCL_square_web_medium.NYP1J.NHNqx.png" alt="Champions League">
                                </div>
                                <div class="competition-info">
                                    <h4 class="competition-name">دوري أبطال أوروبا</h4>
                                    <p class="competition-desc">البطولة الأوروبية الأقوى</p>
                                </div>
                            </div>

                            <!-- Premier League -->
                            <div class="competition-card-enhanced" onclick="showNotification('الدوري الإنجليزي الممتاز - أقوى دوري في العالم', 'info')" tabindex="0">
                                <div class="competition-image-wrapper">
                                    <img src="https://play-lh.googleusercontent.com/7fWZqkilW8bBXzlqp6NCg4-F2Qt8GKcIrWhaj0Ii7oSvDvTQg3UcYBxmA9Uq5Ojpow" alt="Premier League">
                                </div>
                                <div class="competition-info">
                                    <h4 class="competition-name">الدوري الإنجليزي</h4>
                                    <p class="competition-desc">أقوى دوري في العالم</p>
                                </div>
                            </div>

                            <!-- Serie A -->
                            <div class="competition-card-enhanced" onclick="showNotification('الدوري الإيطالي - دوري التكتيكات والمهارة', 'info')" tabindex="0">
                                <div class="competition-image-wrapper">
                                    <img src="https://play-lh.googleusercontent.com/9cNj8ixTiQx1g0hvrQ8Sh52suPWLEY0m0NZ5SfzsFfFqqGCzP2LfaY-FDl1jBKTOuSWs" alt="Serie A">
                                </div>
                                <div class="competition-info">
                                    <h4 class="competition-name">الدوري الإيطالي</h4>
                                    <p class="competition-desc">دوري التكتيكات والمهارة</p>
                                </div>
                            </div>

                            <!-- Bundesliga -->
                            <div class="competition-card-enhanced" onclick="showNotification('الدوري الألماني - دوري الجماهير والإثارة', 'info')" tabindex="0">
                                <div class="competition-image-wrapper">
                                    <img src="https://yt3.googleusercontent.com/i2WkDV4qQdzKK-xaP4wtZ2yR9fsbwqOJ6VBDAhCnbvJ01emai6lesuPbBzBlPTuxmtOWdAM5zg=s900-c-k-c0x00ffffff-no-rj" alt="Bundesliga">
                                </div>
                                <div class="competition-info">
                                    <h4 class="competition-name">الدوري الألماني</h4>
                                    <p class="competition-desc">دوري الجماهير والإثارة</p>
                                </div>
                            </div>

                            <!-- La Liga -->
                            <div class="competition-card-enhanced" onclick="showNotification('الليجا الإسبانية - دوري المهارة والفن', 'info')" tabindex="0">
                                <div class="competition-image-wrapper">
                                    <img src="https://images.seeklogo.com/logo-png/61/1/la-liga-logo-png_seeklogo-614181.png" alt="La Liga">
                                </div>
                                <div class="competition-info">
                                    <h4 class="competition-name">الليجا الإسبانية</h4>
                                    <p class="competition-desc">دوري المهارة والفن</p>
                                </div>
                            </div>

                            <!-- Ligue 1 -->
                            <div class="competition-card-enhanced" onclick="showNotification('الدوري الفرنسي - دوري المواهب الشابة', 'info')" tabindex="0">
                                <div class="competition-image-wrapper">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Logo_Ligue_1_2024.jpg/1200px-Logo_Ligue_1_2024.jpg" alt="Ligue 1">
                                </div>
                                <div class="competition-info">
                                    <h4 class="competition-name">الدوري الفرنسي</h4>
                                    <p class="competition-desc">دوري المواهب الشابة</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Best of Football Section -->
                <div class="best-football-section">
                    <div class="section-header-enhanced">
                        <div class="section-title-group">
                            <div class="section-icon">
                                <i class="fas fa-futbol"></i>
                            </div>
                            <div>
                                <h3 class="section-title">الأحداث الرياضية</h3>
                                <p class="section-subtitle">أبرز المباريات والأحداث المهمة</p>
                            </div>
                        </div>
                    </div>

                    <div class="best-football-slider-container">
                        <div class="best-football-slider" id="bestOfFootballSlider">
                            <!-- First Football Event Card -->
                            <div class="football-event-card">
                                <div class="card-background" style="background-image: url('https://c.top4top.io/p_3499bjfz31.jpg'); background-size: cover; background-position: center;"></div>
                                <div class="road-lines"></div>

                                <div class="football-info">
                                    <div class="football-title">برشلونة ضد ريال مدريد</div>
                                    <div class="football-subtitle">الكلاسيكو - الدوري الإسباني</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </section>

            <!-- Channels Section -->
            <section id="channelsSection" class="section hidden">

                <!-- Main Categories -->
                <div class="channel-categories-main" id="channelCategoriesMain">
                    <!-- Search Bar for Main Categories -->
                    <div class="search-container" style="margin-bottom: 2rem;">
                        <div class="search-box">
                            <i class="fas fa-search search-icon" style="font-size: 1.2rem;"></i>
                            <input type="text" id="mainChannelSearchInput" class="search-input" placeholder="ابحث في جميع القنوات..." onkeyup="filterMainChannels()">
                            <button class="search-clear" id="mainSearchClearBtn" onclick="clearMainSearch()" style="display: none;">
                                <i class="fas fa-times-circle" style="font-size: 1.1rem;"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Search Results for Main Page -->
                    <div class="search-results" id="mainSearchResults" style="display: none;">
                        <h3 class="search-results-title">نتائج البحث</h3>
                        <div class="search-results-grid" id="mainSearchResultsGrid"></div>
                    </div>

                    <div class="channel-categories-grid" id="channelCategoriesGrid">
                        <!-- Dynamic content will be loaded here -->
                    </div>
                </div>

                <!-- Sub Pages -->
                <div class="channel-sub-page" id="channelSubPage">
                    <div class="channel-sub-header">
                        <button class="back-btn" onclick="backToChannelCategories()">
                            <i class="fas fa-chevron-right"></i>
                            رجوع
                        </button>
                        <h3 id="channelSubTitle">القنوات</h3>
                    </div>
                    <div class="channel-sub-grid" id="channelSubGrid">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </section>



            <!-- Settings Section -->
            <section id="settingsSection" class="section hidden">
                <div class="settings-container">
                    <!-- إعدادات المظهر -->
                    <div class="settings-section">
                        <div class="settings-section-header">
                            <h3 class="settings-section-title">
                                <i class="fas fa-palette"></i>
                                المظهر والألوان
                            </h3>
                        </div>



                        <div class="settings-item">
                            <div class="info">
                                <div class="title">لون التطبيق</div>
                                <div class="desc">اختر اللون المُفضل للتطبيق</div>
                                <div class="color-picker">
                                    <div class="color-option selected" style="background-color: #ca8a04;" data-color="yellow" onclick="changeThemeColor('yellow')"></div>
                                    <div class="color-option" style="background-color: #dc2626;" data-color="red" onclick="changeThemeColor('red')"></div>
                                    <div class="color-option" style="background-color: #2563eb;" data-color="blue" onclick="changeThemeColor('blue')"></div>
                                    <div class="color-option" style="background-color: #16a34a;" data-color="green" onclick="changeThemeColor('green')"></div>
                                    <div class="color-option" style="background-color: #db2777;" data-color="pink" onclick="changeThemeColor('pink')"></div>  
                                    <div class="color-option" style="background-color: #e11d48;" data-color="rose" onclick="changeThemeColor('rose')"></div>   
                                    <div class="color-option" style="background-color: #c026d3;" data-color="fuchsia" onclick="changeThemeColor('fuchsia')"></div>
                                    <div class="color-option" style="background-color: #0d9488;" data-color="teal" onclick="changeThemeColor('teal')"></div>                               
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- إعدادات الاستخدام -->
                    <div class="settings-section">
                        <div class="settings-section-header">
                            <h3 class="settings-section-title">
                                <i class="fas fa-cog"></i>
                                إعدادات الاستخدام
                            </h3>
                        </div>

                        <div class="settings-item">
                            <div class="info">
                                <div class="title">الإشعارات</div>
                                <div class="desc">تفعيل إشعارات التطبيق المهمة</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="notificationsSwitch" checked>
                                <span class="slider"></span>
                            </label>
                        </div>



                        <div class="settings-item">
                            <div class="info">
                                <div class="title">حفظ البيانات</div>
                                <div class="desc">تقليل استهلاك البيانات أثناء البث المباشر</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="dataSaverSwitch">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- إعدادات الحساب -->
                    <div class="settings-section">
                        <div class="settings-section-header">
                            <h3 class="settings-section-title">
                                <i class="fas fa-user"></i>
                                إعدادات الحساب
                            </h3>
                        </div>

                        <div class="settings-item">
                            <div class="info">
                                <div class="title">تسجيل الخروج</div>
                                <div class="desc">الخروج من التطبيق والعودة لصفحة تسجيل الدخول</div>
                            </div>
                            <button onclick="logout()" class="admin-btn secondary" style="padding: 0.75rem 1.5rem; font-size: 0.9rem; border-radius: 8px;">
                                <i class="fas fa-sign-out-alt"></i>
                                خروج
                            </button>
                        </div>
                    </div>

                    <!-- Footer Section -->
                    <div class="settings-footer">
                        <div class="footer-separator"></div>
                        <div class="footer-content">
                            <div class="footer-logo">
                                <img src="https://iili.io/FSF1DcG.md.png" alt="Nova Logo" class="footer-logo-img">
                                <div class="footer-text">
                                    <h4 class="footer-app-name">Nova</h4>
                                    <p class="footer-version">الإصدار 1.0</p>
                                </div>
                            </div>
                            <div class="footer-copyright">
                                <p>جميع الحقوق محفوظة © 2025</p>
                                <p class="footer-subtitle">منصة Nova للبث الرياضي المباشر</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>







        <!-- Admin Section -->
            <section id="adminSection" class="section hidden">
                <div style="max-width: 800px; margin: 0 auto;">
                    <!-- Admin Data Management Section -->
                    <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.1rem; font-weight: 600;">
                            إدارة البيانات
                        </h3>
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <button onclick="autoSaveAllChanges()" class="admin-btn primary">حفظ تلقائي</button>
                            <button onclick="downloadBackupData()" class="admin-btn secondary">نسخة احتياطية</button>
                            <button onclick="resetToDefault()" class="admin-btn danger">إعادة تعيين</button>
                        </div>
                    </div>

                    <div style="text-align: center; margin-bottom: 2rem;">
                        <div style="display: inline-flex; align-items: center; gap: 1rem; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 1.5rem 2rem;">
                            <div style="width: 48px; height: 48px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-shield-alt" style="color: #000; font-size: 1.3rem;"></i>
                            </div>
                            <div style="text-align: right;">
                                <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--text-primary); margin: 0 0 0.25rem 0;">
                                    لوحة التحكم
                                </h2>
                                <p style="color: var(--text-secondary); font-size: 0.9rem; margin: 0;">
                                    إدارة الأحداث الرياضية والإعدادات
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Admin Tabs -->
                    <div style="display: flex; gap: 0; margin-bottom: 2rem; background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 0.5rem; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <button class="admin-tab active" onclick="switchAdminTab('events')" data-tab="events" style="flex: 1;">
                            <i class="fas fa-futbol"></i>
                            إدارة الأحداث
                        </button>
                        <button class="admin-tab" onclick="switchAdminTab('backup')" data-tab="backup" style="flex: 1;">
                            <i class="fas fa-cog"></i>
                            إدارة النظام
                        </button>
                    </div>



                    <!-- Events Management -->
                    <div id="adminEventsTab" class="admin-tab-content">
                        <div style="background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem;">
                            <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 32px; height: 32px; background: rgba(var(--accent-primary), 0.15); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--accent-primary);">
                                    <i class="fas fa-plus" style="font-size: 0.9rem;"></i>
                                </div>
                                إضافة حدث رياضي جديد
                            </h3>
                            <div style="display: grid; gap: 1rem; margin-bottom: 1rem;">
                                <input type="text" id="newEventTitle" placeholder="عنوان الحدث (مثل: برشلونة ضد ريال مدريد)" class="admin-input">
                                <input type="text" id="newEventSubtitle" placeholder="الوصف (مثل: الكلاسيكو - الدوري الإسباني)" class="admin-input">
                                <input type="text" id="newEventImage" class="admin-input" placeholder="رابط الصورة (اختياري)" onkeyup="previewNewEventImage()">
                                <!-- معاينة الصورة الجديدة -->
                                <div id="newEventImagePreview" style="display: none; margin-top: 0.5rem; text-align: center;">
                                    <img id="newEventImagePreviewImg" src="" alt="معاينة الصورة" style="max-width: 200px; max-height: 150px; border-radius: 8px; border: 1px solid var(--border-primary);">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="newEventLink">الرابط</label>
                                <div style="display: flex; gap: 0.5rem;">
                                    <input type="text" id="newEventLink" class="admin-input" placeholder="مثال: go:501 أو http://..." required>
                                    <button type="button" class="admin-btn secondary" onclick="generateEventNumber()" title="توليد رقم تلقائي">
                                        <i class="fas fa-magic"></i>
                                    </button>
                                </div>
                            </div>
                            <div style="color: var(--text-muted); font-size: 0.85rem; margin-top: -0.5rem;">
                                <i class="fas fa-info-circle"></i>
                                استخدم التنسيق go:رقم لإنشاء رابط خاص (مثل: go:500)
                            </div>
                            <label style="color: var(--text-primary); font-weight: 600; margin-bottom: 0.5rem;">حالة الحدث:</label>
                            <select id="newEventStatus" class="admin-input">
                                <option value="upcoming">قادم</option>
                                <option value="live">مباشر</option>
                                <option value="finished">انتهى</option>
                            </select>
                            <button onclick="addNewEvent()" class="admin-btn primary">
                                <i class="fas fa-plus"></i>
                                إضافة حدث
                            </button>
                        </div>

                        <div style="background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1.5rem;">
                            <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 32px; height: 32px; background: rgba(var(--accent-primary), 0.15); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--accent-primary);">
                                    <i class="fas fa-list" style="font-size: 0.9rem;"></i>
                                </div>
                                الأحداث الرياضية الحالية
                            </h3>
                            <div id="eventsList"></div>
                        </div>

                        <!-- Edit Event Modal -->
                        <div id="editEventModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 5000; align-items: center; justify-content: center;">
                            <div style="background: var(--secondary-bg); border: 1px solid var(--border-primary); border-radius: 16px; padding: 2rem; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                                    <h3 style="color: var(--text-primary); margin: 0;">تعديل الحدث الرياضي</h3>
                                    <button onclick="closeEditEventModal()" style="background: none; border: none; color: var(--text-secondary); font-size: 1.5rem; cursor: pointer;">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                <div style="display: grid; gap: 1rem;">
                                    <input type="hidden" id="editEventIndex">
                                    <input type="text" id="editEventTitle" class="admin-input" placeholder="عنوان الحدث">
                                    <input type="text" id="editEventSubtitle" class="admin-input" placeholder="الوصف">
                                    <input type="text" id="editEventImage" class="admin-input" placeholder="رابط الصورة (اختياري)" onkeyup="previewEditEventImage()">
                                    <!-- معاينة الصورة في التعديل -->
                                    <div id="editEventImagePreview" style="display: none; margin-top: 0.5rem; text-align: center;">
                                        <img id="editEventImagePreviewImg" src="" alt="معاينة الصورة" style="max-width: 200px; max-height: 150px; border-radius: 8px; border: 1px solid var(--border-primary);">
                                    </div>
                                    <div class="form-group">
                                        <label for="editEventLink">الرابط</label>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <input type="text" id="editEventLink" class="admin-input" placeholder="مثال: go:501 أو http://..." required>
                                            <button type="button" class="admin-btn secondary" onclick="generateEditEventNumber()" title="توليد رقم تلقائي">
                                                <i class="fas fa-magic"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <select id="editEventStatus" class="admin-input">
                                        <option value="upcoming">قادم</option>
                                        <option value="live">مباشر</option>
                                        <option value="finished">انتهى</option>
                                    </select>
                                    <button onclick="saveEventChanges()" class="admin-btn primary">
                                        <i class="fas fa-save"></i>
                                        حفظ التغييرات
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System Management -->
                    <div id="adminBackupTab" class="admin-tab-content hidden">
                        <div style="display: grid; gap: 2rem;">
                            <div style="background: rgba(255, 71, 87, 0.1); border: 1px solid rgba(255, 71, 87, 0.3); border-radius: 16px; padding: 2rem;">
                                <h3 style="color: #ff4757; margin-bottom: 1rem;">إعادة تعيين البيانات</h3>
                                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                                    حذف جميع البيانات والعودة للإعدادات الافتراضية
                                </p>
                                <button onclick="resetToDefault()" class="admin-btn danger">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    إعادة تعيين للافتراضي
                                </button>
                            </div>
                        </div>
                    </div>
           <!-- System Management -->
                    <div id="adminBackupTab" class="admin-tab-content hidden">
                        <div style="display: grid; gap: 2rem;">
                            <div style="background: rgba(255, 71, 87, 0.1); border: 1px solid rgba(255, 71, 87, 0.3); border-radius: 16px; padding: 2rem;">
                                <h3 style="color: #ff4757; margin-bottom: 1rem;">إعادة تعيين البيانات</h3>
                                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                                    حذف جميع البيانات والعودة للإعدادات الافتراضية
                                </p>
                                <button onclick="resetToDefault()" class="admin-btn danger">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    إعادة تعيين للافتراضي
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3 class="sidebar-title">القائمة</h3>
            <button class="close-btn" onclick="toggleSidebar()">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <nav class="sidebar-nav">
            <div class="menu-section">
                <a href="#" class="menu-item" onclick="showSection('live'); closeSidebar();">
                    <i class="fas fa-home"></i>
                    <span>الرئيسية</span>
                </a>
                <a href="#" class="menu-item" onclick="showSection('channels'); closeSidebar();">
                    <i class="fas fa-tv"></i>
                    <span>القنوات</span>
                </a>
                <a href="#" class="menu-item" onclick="showSection('settings'); closeSidebar();">
                    <i class="fas fa-cog"></i>
                    <span>الإعدادات</span>
                </a>
                <a href="#" class="menu-item admin-only" id="adminMenuItem" onclick="showSection('admin'); closeSidebar();" style="display: none;">
                    <i class="fas fa-shield-alt"></i>
                    <span>لوحة التحكم</span>
                </a>
            </div>

            <div class="menu-footer">
                <a href="https://t.me/NovaSporrt" target="_blank" rel="noopener noreferrer" class="contact-link">
                    <i class="fab fa-telegram-plane"></i>
                    <span>الدعم الفني</span>
                </a>
            </div>
        </nav>
    </aside>



    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer">
        <!-- Notifications will be dynamically added here -->
    </div>



    <script>

// معالجة النقر على القنوات
        function handleChannelClick(event, channelNumber) {
            event.preventDefault();

            try {
                console.log('النقر على القناة رقم:', channelNumber);

                if (!channelNumber) {
                    showNotification('رقم القناة غير صالح', 'error');
                    return;
                }

                // فتح الرابط باستخدام رقم القناة
                const url = `go:${channelNumber}`;
                console.log('فتح الرابط:', url);
                window.open(url, '_blank');

            } catch (error) {
                console.error('خطأ في معالجة النقر:', error);
                showNotification('خطأ في فتح القناة', 'error');
            }
        }

        // ===== FIREBASE CONFIGURATION =====
        // إعدادات Firebase الصحيحة
        const firebaseConfig = {
            apiKey: "AIzaSyDY3v5WMeJMMKEh0LATA8_bUy9Bx9DnMcI",
            authDomain: "novaagoaldata.firebaseapp.com",
            databaseURL: "https://novaagoaldata-default-rtdb.firebaseio.com",
            projectId: "novaagoaldata",
            storageBucket: "novaagoaldata.firebasestorage.app",
            messagingSenderId: "1039435605690",
            appId: "1:1039435605690:web:46ee4cd6eeab511d604483",
            measurementId: "G-6NXXZB3Z4X"
        };

        // Initialize Firebase
        let database;
        let storage = null;
        let firebaseAvailable = false;

        // Initialize Firebase connection
        function initializeFirebase() {
            try {
                if (typeof firebase !== 'undefined') {
                    firebase.initializeApp(firebaseConfig);
                    database = firebase.database();
                    storage = firebase.storage();
                    firebaseAvailable = true;
                    console.log('Firebase initialized successfully');
                    return true;
                } else {
                    console.log('Firebase SDK not available, using localStorage fallback');
                    firebaseAvailable = false;
                    return false;
                }
            } catch (error) {
                console.warn('Firebase initialization failed, using localStorage fallback:', error);
                firebaseAvailable = false;
                return false;
            }
        }

        // Global Variables
        let currentUser = null;
        let isAdmin = false;

        let currentThemeColor = localStorage.getItem('Nova_color') || 'yellow';
        let settings = JSON.parse(localStorage.getItem('Nova_settings')) || {
            notifications: true,
            autoplay: false,
            quality: 'auto',
            sound: true
        };

        // Admin credentials
        const ADMIN_USERNAME = 'nova_admin';
        const ADMIN_PASSWORD = 'admin2008';

        // Global Variables
        let searchTimeout;



        // Load channel data from Firebase or localStorage
        let channelData = {};

        // Sports Events Data
        let sportsEvents = [];

        // Default sports events
        const defaultSportsEvents = [
            {
                id: "default_1",
                title: "لا توجد أحداث",
                subtitle: "Error",
                image: "",
                link: "go:500",
                status: "upcoming",
                timestamp: Date.now(),
                permanent: true
            }
        ];

        // Default channel data
        const defaultChannelData = {
            'bein-hd': {
                title: 'beIN SPORTS HD',
                baseNumber: 100,
                image: 'https://c.top4top.io/p_3408jzbg31.jpg',
                channels: [
                    'beIN Sports 1 HD',
                    'beIN Sports 2 HD',
                    'beIN Sports 3 HD',
                    'beIN Sports 4 HD',
                    'beIN Sports 5 HD',
                    'beIN Sports 6 HD',
                    'beIN Sports 7 HD',
                    'beIN Sports 8 HD',
                    'beIN Sports 9 HD',
                    'beIN Sports Global HD',
                    'beIN Sports News HD'
                ]
            },
            'fjr-s': {
                title: 'FAJER HD',
                baseNumber: 200,
                image: 'https://l.top4top.io/p_34951cu721.jpg',
                channels: [
                    'FaJER 1 HD',
                    'FaJER 2 HD',
                    'FaJER 3 HD',
                    'FaJER 4 HD',
                    'FaJER 5 HD'
                ]
            },
            'sports-general': {
                title: 'القنوات الرياضية',
                baseNumber: 300,
                image: 'https://c.top4top.io/p_3499bjfz31.jpg',
                channels: [
                    'NRT SPORTS',
                    'AVA SPORTS',
                    'LD SPORTS',
                    'ASTERA SPORTS',
                    'DUHOK SPORTS',
                    'DAISYNA SPORTS'
                ]
            },
            'c-alwanhd': {
                title: 'Alwan Sports HD',
                baseNumber: 400,
                image: 'https://l.top4top.io/p_34951cu721.jpg',
                channels: [
                    'Alwan 1 HD',
                    'Alwan 2 HD',
                    'Alwan 3 HD',
                    'Alwan 4 HD',
                    'Alwan 5 HD',
                    'Alwan 6 HD'
                ]
            },
             'cc-thmanyah': {
                title: 'Thmanyah Sports HD',
                baseNumber: 500,
                image: 'https://thmanyah.com/_next/image?url=%2Fimages%2Ffootball-cover-sm-2.webp&w=1200&q=100',
                channels: [
                    'Thmanyah 1 HD',
                    'Thmanyah 2 HD',
                    'Thmanyah 3 HD'
                ]
            },
        };

        // Firebase Realtime Functions
        let channelDataListener = null;
        let eventsListener = null;
        let connectionState = {
            firebase: false,
            retryCount: 0,
            maxRetries: 3
        };

        // Firebase Authentication Functions
        async function initializeFirebaseAuth() {
            if (!firebaseAvailable || !firebase.auth) {
                console.log('Firebase Auth غير متاح');
                return false;
            }

            try {
                // مراقبة حالة المصادقة
                firebase.auth().onAuthStateChanged(async (user) => {
                    if (user) {
                        console.log('المستخدم مسجل دخول:', user.uid);
                        currentUser = user;

                        // تحقق من صلاحيات الإدارة
                        const token = await user.getIdTokenResult();
                        isAdmin = token.claims.admin === true || user.uid === 'nova_admin';

                        // سجل عملية الدخول
                        await logUserAction('login', `المستخدم ${user.uid} سجل دخول`);

                    } else {
                        console.log('المستخدم غير مسجل دخول');
                        currentUser = null;
                        isAdmin = false;
                    }

                    updateUIBasedOnAuth();
                });

                return true;
            } catch (error) {
                console.error('خطأ في تهيئة Firebase Auth:', error);
                return false;
            }
        }

        // تسجيل الدخول للإدارة
        async function adminLogin(username, password) {
            if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                try {
                    // إنشاء مستخدم مؤقت للإدارة
                    const adminUser = {
                        uid: 'nova_admin',
                        displayName: 'Nova Admin'
                    };

                    currentUser = adminUser;
                    isAdmin = true;

                    await logUserAction('admin_login', 'تسجيل دخول إدارة ناجح');

                    return true;
                } catch (error) {
                    console.error('خطأ في تسجيل دخول الإدارة:', error);
                    return false;
                }
            }
            return false;
        }

        // تسجيل الأنشطة
        async function logUserAction(action, details = null) {
            if (!firebaseAvailable || !database || !currentUser) {
                return;
            }

            try {
                const logEntry = {
                    timestamp: Date.now(),
                    action: action,
                    userId: currentUser.uid,
                    details: details
                };

                await database.ref('systemLogs').push(logEntry);
            } catch (error) {
                console.warn('خطأ في تسجيل النشاط:', error);
            }
        }

        // تحديث واجهة المستخدم حسب حالة المصادقة
        function updateUIBasedOnAuth() {
            const adminElements = document.querySelectorAll('.admin-only');
            adminElements.forEach(element => {
                element.style.display = isAdmin ? 'block' : 'none';
            });
        }

        // نظام مبسط لمراقبة Firebase
        function enableChannelDataRealtimeSync() {
            if (!firebaseAvailable || !database) return;

            try {
                if (channelDataListener) {
                    database.ref('channelData').off('value', channelDataListener);
                    channelDataListener = null;
                }

                channelDataListener = database.ref('channelData').on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data && typeof data === 'object' && Object.keys(data).length > 0) {
                        channelData = data;
                        localStorage.setItem('Nova_channelData', JSON.stringify(channelData));
                        refreshChannelsDisplayIfActive();
                        refreshAdminDisplayIfActive();
                    }
                });

                console.log('تم تفعيل المراقبة في الوقت الفعلي للقنوات');
            } catch (error) {
                console.error('خطأ في تفعيل المراقبة:', error);
            }
        }

        // تفعيل مراقبة تغييرات الأحداث في الوقت الفعلي
        function enableEventsRealtimeSync() {
            if (!firebaseAvailable || !database) return;

            try {
                // إزالة المستمع السابق إن وجد
                if (eventsListener) {
                    database.ref('sportsEvents').off('value', eventsListener);
                }

                // إضافة مستمع جديد للتغييرات
                eventsListener = database.ref('sportsEvents').on('value', (snapshot) => {
                    const data = snapshot.val();

                    if (data && Array.isArray(data)) {
                        console.log('تم تحديث الأحداث الرياضية في الوقت الفعلي');

                        // تحديث البيانات المحلية
                        sportsEvents = data;
                        localStorage.setItem('Nova_sportsEvents', JSON.stringify(sportsEvents));

                        // تحديث عرض الأحداث
                        updateSportsEventsDisplay();
                    }
                }, (error) => {
                    console.error('خطأ في مراقبة تغييرات الأحداث:', error);
                });

                console.log('تم تفعيل المراقبة في الوقت الفعلي للأحداث');
            } catch (error) {
                console.error('خطأ في تفعيل المراقبة في الوقت الفعلي:', error);
            }
        }

        // إيقاف المراقبة في الوقت الفعلي
        function disableRealtimeSync() {
            if (database) {
                if (channelDataListener) {
                    database.ref('channelData').off('value', channelDataListener);
                    channelDataListener = null;
                }
                if (eventsListener) {
                    database.ref('sportsEvents').off('value', eventsListener);
                    eventsListener = null;
                }
                console.log('تم إيقاف المراقبة في الوقت الفعلي');
            }
        }

        // تحديث عرض القنوات إذا كانت الصفحة مفتوحة
        function refreshChannelsDisplayIfActive() {
            const channelsSection = document.getElementById('channelsSection');
            if (channelsSection && !channelsSection.classList.contains('hidden')) {
                // إعادة تحميل الفئات إذا كانت صفحة القنوات مفتوحة
                const channelCategoriesMain = document.getElementById('channelCategoriesMain');
                if (channelCategoriesMain && channelCategoriesMain.style.display !== 'none') {
                    // تحديث عرض الفئات مباشرة
                    updateChannelCategoriesDisplay();
                    console.log('تم تحديث عرض القنوات في الوقت الفعلي');
                }

                // تحديث صفحة فرعية للقنوات إذا كانت مفتوحة
                const channelSubPage = document.getElementById('channelSubPage');
                if (channelSubPage && channelSubPage.style.display !== 'none') {
                    const currentCategory = channelSubPage.dataset.currentCategory;
                    if (currentCategory && channelData[currentCategory]) {
                        showChannelSubPage(currentCategory);
                    }
                }
            }
        }

        // تحديث لوحة التحكم إذا كانت مفتوحة
        function refreshAdminDisplayIfActive() {
            const adminSection = document.getElementById('adminSection');
            if (adminSection && !adminSection.classList.contains('hidden')) {
                // تحديث قائمة الفئات
                const categoriesTab = document.getElementById('adminCategoriesTab');
                if (categoriesTab && !categoriesTab.classList.contains('hidden')) {
                    loadCategoriesList();
                    loadChannelCategorySelects();
                }

                // تحديث قائمة القنوات
                const channelsTab = document.getElementById('adminChannelsTab');
                if (channelsTab && !channelsTab.classList.contains('hidden')) {
                    loadChannelCategorySelects();
                    const currentCategory = document.getElementById('channelListCategorySelect')?.value;
                    if (currentCategory) {
                        loadChannelsForCategory();
                    }
                }

                console.log('تم تحديث لوحة التحكم في الوقت الفعلي');
            }
        }

        // تتبع الصفحة الفرعية الحالية للقنوات
        function showChannelSubPage(categoryId) {
            const category = channelData[categoryId];
            if (!category) {
                showNotification('الفئة غير موجودة', 'error');
                return;
            }

            // إخفاء الصفحة الرئيسية وإظهار الصفحة الفرعية
            document.getElementById('channelCategoriesMain').style.display = 'none';
            const subPage = document.getElementById('channelSubPage');
            subPage.style.display = 'block';
            subPage.dataset.currentCategory = categoryId; // حفظ الفئة الحالية

            // تحديث العنوان
            document.getElementById('channelSubTitle').textContent = category.title;

            // تحديث شبكة القنوات
            const subGrid = document.getElementById('channelSubGrid');
            let html = '';

            category.channels.forEach((channel, index) => {
                const channelName = typeof channel === 'string' ? channel : channel.name;
                const channelNumber = category.baseNumber + index;

                html += `
                    <div class="channel-item-wrapper">
                        <div class="channel-item" onclick="handleChannelClick(event, ${channelNumber})" style="cursor: pointer;">
                            <div class="channel-logo">
                                ${getChannelLogo(channelName, categoryId)}
                            </div>
                            <div class="channel-info">
                                <div class="channel-name">${channelName}</div>
                                <div class="channel-quality">HD</div>
                            </div>
                            <div class="channel-status"></div>
                        </div>
                    </div>
                `;
            });

            subGrid.innerHTML = html;
        }

        async function loadChannelDataFromFirebase() {
            if (!firebaseAvailable || !database) {
                console.log('Firebase غير متاح، تحميل من التخزين المحلي');
                return loadChannelDataFromLocalStorage();
            }

            try {
                const snapshot = await database.ref('channelData').once('value');
                const data = snapshot.val();

                if (data && typeof data === 'object') {
                    channelData = data;
                    // تحقق من صحة البيانات
                    let isValid = true;
                    for (const categoryId in channelData) {
                        const category = channelData[categoryId];
                        if (!category.title || !category.baseNumber || !Array.isArray(category.channels)) {
                            isValid = false;
                            break;
                        }
                    }

                    if (isValid) {
                        localStorage.setItem('Nova_channelData', JSON.stringify(channelData));

                        // تفعيل المراقبة في الوقت الفعلي بعد التحميل الأول
                        enableChannelDataRealtimeSync();

                        return true;
                    }
                }

                // إذا لم توجد بيانات صحيحة، استخدم البيانات الافتراضية
                channelData = JSON.parse(JSON.stringify(defaultChannelData));
                await saveChannelDataToFirebase();
                return true;

            } catch (error) {
                console.error('خطأ في تحميل البيانات من Firebase:', error);
                loadChannelDataFromLocalStorage();
                return false;
            }
        }

        async function saveChannelDataToFirebase() {
            if (!firebaseAvailable || !database) {
                return saveChannelDataToLocalStorage();
            }

            try {
                await database.ref('channelData').set(channelData);
                localStorage.setItem('Nova_channelData', JSON.stringify(channelData));
                console.log('تم حفظ بيانات القنوات بنجاح');
                return true;
            } catch (error) {
                console.error('خطأ في حفظ البيانات:', error);
                return saveChannelDataToLocalStorage();
            }
        }

        async function loadSportsEventsFromFirebase() {
            if (!firebaseAvailable || !database) {
                console.log('Firebase غير متاح، تحميل الأحداث محلياً');
                loadSportsEventsFromLocalStorage();
                updateSportsEventsDisplay();
                return false;
            }

            try {
                console.log('محاولة تحميل الأحداث الرياضية من Firebase...');
                const snapshot = await database.ref('sportsEvents').once('value');
                const data = snapshot.val();

                if (data && Array.isArray(data) && data.length > 0) {
                    // تحقق محسن من صحة البيانات مع إضافة المعرفات المفقودة
                    const validEvents = data.filter(event => 
                        event && 
                        event.title && 
                        event.subtitle && 
                        event.link && 
                        event.status
                    ).map(event => ({
                        ...event,
                        id: event.id || generateUniqueId(),
                        timestamp: event.timestamp || Date.now(),
                        permanent: event.permanent || false
                    }));

                    if (validEvents.length > 0) {
                        sportsEvents = validEvents;

                        // حفظ البيانات المحدثة محلياً وفي Firebase
                        localStorage.setItem('Nova_sportsEvents', JSON.stringify(validEvents));

                        // إعادة حفظ في Firebase إذا تم إضافة معرفات جديدة
                        const hasNewIds = validEvents.some(event => !data.find(d => d.id === event.id));
                        if (hasNewIds) {
                            await database.ref('sportsEvents').set(validEvents);
                        }

                        console.log(`تم تحميل ${validEvents.length} حدث رياضي من Firebase بنجاح`);
                        updateSportsEventsDisplay();

                        // تفعيل المراقبة في الوقت الفعلي بعد التحميل الأول
                        enableEventsRealtimeSync();

                        return true;
                    } else {
                        console.warn('البيانات المحملة من Firebase غير صالحة');
                    }
                }

                // إذا لم توجد بيانات صالحة، استخدم البيانات الافتراضية
                console.log('لا توجد أحداث صالحة في Firebase، استخدام البيانات الافتراضية');
                sportsEvents = [...defaultSportsEvents];
                await saveSportsEventsToFirebase();
                updateSportsEventsDisplay();
                return true;

            } catch (error) {
                console.error('خطأ في تحميل الأحداث من Firebase:', error.message || error);
                loadSportsEventsFromLocalStorage();
                updateSportsEventsDisplay();
                return false;
            }
        }

        async function saveSportsEventsToFirebase() {
            if (!firebaseAvailable || !database) {
                console.log('Firebase غير متاح، حفظ الأحداث محلياً فقط');
                return saveSportsEventsToLocalStorage();
            }

            try {
                console.log('حفظ الأحداث الرياضية في Firebase...');

                // تحقق من صحة بيانات الأحداث
                if (!Array.isArray(sportsEvents)) {
                    console.warn('بيانات الأحداث غير صحيحة، استخدام البيانات الافتراضية');
                    sportsEvents = [...defaultSportsEvents];
                }

                // تنظيف البيانات قبل الحفظ مع معالجة محسنة للأخطاء
                const cleanEvents = sportsEvents.filter(event => {
                    if (!event || typeof event !== 'object') return false;
                    if (!event.title || typeof event.title !== 'string' || !event.title.trim()) return false;
                    if (!event.subtitle || typeof event.subtitle !== 'string' || !event.subtitle.trim()) return false;
                    if (!event.link || typeof event.link !== 'string' || !event.link.trim()) return false;
                    if (!event.status || typeof event.status !== 'string') return false;
                    return true;
                }).map(event => ({
                    id: event.id || generateUniqueId(),
                    title: event.title.trim(),
                    subtitle: event.subtitle.trim(),
                    image: event.image || null,
                    link: event.link.trim(),
                    status: event.status,
                    timestamp: event.timestamp || Date.now(),
                    category: event.category || 'general',
                    permanent: event.permanent || false,
                    lastModified: Date.now()
                }));

                if (cleanEvents.length === 0) {
                    console.warn('لا توجد أحداث صالحة للحفظ، استخدام البيانات الافتراضية');
                    cleanEvents.push(...defaultSportsEvents.map(event => ({
                        ...event,
                        id: event.id || generateUniqueId(),
                        timestamp: event.timestamp || Date.now(),
                        category: event.category || 'general',
                        permanent: true,
                        lastModified: Date.now()
                    })));
                }

                // حفظ باستخدام set مع retry mechanism
                let retryCount = 0;
                const maxRetries = 3;

                while (retryCount < maxRetries) {
                    try {
                        await database.ref('sportsEvents').set(cleanEvents);
                        break;
                    } catch (setError) {
                        retryCount++;
                        if (retryCount >= maxRetries) throw setError;
                        console.log(`محاولة إعادة الحفظ ${retryCount}/${maxRetries}`);
                        await new Promise(resolve => setTimeout(resolve, 1000 * retryCount));
                    }
                }

                // تحديث المتغير المحلي والتخزين المحلي
                sportsEvents = cleanEvents;
                localStorage.setItem('Nova_sportsEvents', JSON.stringify(cleanEvents));

                // إضافة نسخة احتياطية إضافية
                localStorage.setItem('Nova_sportsEvents_backup', JSON.stringify({
                    data: cleanEvents,
                    timestamp: Date.now(),
                    version: '2.0'
                }));

                console.log(`تم حفظ ${cleanEvents.length} حدث رياضي في Firebase بنجاح`);

                // تحديث العرض
                updateSportsEventsDisplay();
                return true;

            } catch (error) {
                console.error('خطأ في حفظ الأحداث في Firebase:', error.message || error);
                console.log('التراجع للحفظ المحلي...');
                return saveSportsEventsToLocalStorage();
            }
        }

        

        // Fallback functions for localStorage
        function loadChannelDataFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('Nova_channelData');
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    if (parsedData && typeof parsedData === 'object') {
                        channelData = parsedData;

                        // حذف قنوات SSC إذا وجدت
                        if (channelData.ssc) {
                            console.log('تم حذف قنوات SSC من البيانات المحلية');
                            delete channelData.ssc;
                            saveChannelDataToLocalStorage();
                        }

                        for (const categoryId in channelData) {
                            const category = channelData[categoryId];
                            if (!category.title || !category.baseNumber || !Array.isArray(category.channels)) {
                                console.warn(`بيانات غير صحيحة للفئة ${categoryId}، استخدام البيانات الافتراضية`);
                                channelData = JSON.parse(JSON.stringify(defaultChannelData));
                                saveChannelDataToLocalStorage();
                                break;
                            }
                            category.channels = category.channels.map(channel => {
                                if (typeof channel === 'string') {
                                    return { name: channel, image: null };
                                }
                                return channel;
                            });
                        }
                    } else {
                        throw new Error('بيانات غير صحيحة');
                    }
                } else {
                    channelData = JSON.parse(JSON.stringify(defaultChannelData));
                    saveChannelDataToLocalStorage();
                }
            } catch (e) {
                console.warn('خطأ في تحميل بيانات القنوات، استخدام البيانات الافتراضية:', e);
                channelData = JSON.parse(JSON.stringify(defaultChannelData));
                saveChannelDataToLocalStorage();
            }
        }

        function loadSportsEventsFromLocalStorage() {
            try {
                // محاولة تحميل البيانات الأساسية أولاً
                const savedEvents = localStorage.getItem('Nova_sportsEvents');

                if (savedEvents) {
                    const parsedEvents = JSON.parse(savedEvents);
                    if (Array.isArray(parsedEvents) && parsedEvents.length > 0) {
                        // إضافة معرفات فريدة للأحداث التي لا تحتوي عليها
                        sportsEvents = parsedEvents.map(event => ({
                            ...event,
                            id: event.id || generateUniqueId(),
                            timestamp: event.timestamp || Date.now(),
                            permanent: event.permanent || false
                        }));

                        console.log(`تم تحميل ${sportsEvents.length} حدث من التخزين المحلي`);
                    } else {
                        throw new Error('بيانات غير صحيحة أو فارغة');
                    }
                } else {
                    // محاولة استعادة النسخة الاحتياطية
                    const backupData = localStorage.getItem('Nova_sportsEvents_backup');
                    if (backupData) {
                        const backup = JSON.parse(backupData);
                        if (backup.data && Array.isArray(backup.data)) {
                            console.log('استعادة البيانات من النسخة الاحتياطية');
                            sportsEvents = backup.data;
                            // إعادة حفظ البيانات المستعادة
                            localStorage.setItem('Nova_sportsEvents', JSON.stringify(sportsEvents));
                        } else {
                            throw new Error('نسخة احتياطية غير صالحة');
                        }
                    } else {
                        throw new Error('لا توجد بيانات محفوظة');
                    }
                }

                // تحديث العرض مباشرة بعد التحميل
                updateSportsEventsDisplay();

            } catch (e) {
                console.warn('خطأ في تحميل بيانات الأحداث، استخدام البيانات الافتراضية:', e);
                sportsEvents = [...defaultSportsEvents.map(event => ({
                    ...event,
                    id: event.id || generateUniqueId(),
                    timestamp: event.timestamp || Date.now(),
                    permanent: true
                }))];
                saveSportsEventsToLocalStorage();
                updateSportsEventsDisplay();
            }
        }

        function saveSportsEventsToLocalStorage() {
            try {
                // التأكد من وجود معرفات فريدة لجميع الأحداث
                const eventsWithIds = sportsEvents.map(event => ({
                    ...event,
                    id: event.id || generateUniqueId(),
                    timestamp: event.timestamp || Date.now(),
                    lastModified: Date.now()
                }));

                // حفظ البيانات الأساسية
                localStorage.setItem('Nova_sportsEvents', JSON.stringify(eventsWithIds));

                // حفظ نسخة احتياطية
                localStorage.setItem('Nova_sportsEvents_backup', JSON.stringify({
                    data: eventsWithIds,
                    timestamp: Date.now(),
                    version: '2.0'
                }));

                // تحديث البيانات في الذاكرة
                sportsEvents = eventsWithIds;

                console.log(`تم حفظ ${eventsWithIds.length} حدث محلياً مع النسخة الاحتياطية`);
                return true;

            } catch (e) {
                console.error('خطأ في حفظ بيانات الأحداث:', e);
                return false;
            }
        }

        function saveChannelDataToLocalStorage() {
            try {
                // حذف قنوات SSC إذا وجدت قبل الحفظ
                const dataToSave = { ...channelData };
                if (dataToSave.ssc) {
                    delete dataToSave.ssc;
                }

                localStorage.setItem('Nova_channelData', JSON.stringify(dataToSave));
                channelData = dataToSave; // تحديث البيانات في الذاكرة
                console.log('تم حفظ البيانات محلياً بنجاح');
                return true;
            } catch (e) {
                console.error('خطأ في حفظ بيانات القنوات:', e);
                return false;
            }
        }

        // Unified functions that use Firebase when available
        async function loadChannelData() {
            await loadChannelDataFromFirebase();
        }

        async function saveChannelData() {
            return await saveChannelDataToFirebase();
        }

        async function loadSportsEvents() {
            await loadSportsEventsFromFirebase();
        }

        async function saveSportsEvents() {
            return await saveSportsEventsToFirebase();
        }

        // وظيفة لإعادة الاتصال بـ Firebase في حالة انقطاع الاتصال
        async function reconnectToFirebase() {
            if (!firebaseAvailable) return false;

            try {
                console.log('محاولة إعادة الاتصال بـ Firebase...');
                const isConnected = await testFirebaseConnection();

                if (isConnected) {
                    enableChannelDataRealtimeSync();
                    enableEventsRealtimeSync();
                    console.log('تم إعادة الاتصال بـ Firebase بنجاح');
                    showNotification('تم إعادة الاتصال بقاعدة البيانات', 'success', 3000);
                    return true;
                }
                return false;
            } catch (error) {
                console.error('فشل في إعادة الاتصال:', error);
                return false;
            }
        }

        // مراقبة حالة الاتصال بالإنترنت
        function setupConnectionMonitoring() {
            window.addEventListener('online', async () => {
                console.log('تم استعادة الاتصال بالإنترنت');
                showNotification('تم استعادة الاتصال بالإنترنت', 'info', 2000);

                // محاولة إعادة الاتصال بـ Firebase
                setTimeout(async () => {
                    await reconnectToFirebase();
                }, 1000);
            });

            window.addEventListener('offline', () => {
                console.log('تم فقدان الاتصال بالإنترنت');
                showNotification('تم فقدان الاتصال - سيتم استخدام البيانات المحلية', 'error', 3000);
            });
        }

        // وظيفة للتحقق من صحة اتصال Firebase
        async function testFirebaseConnection() {
            if (!firebaseAvailable || !database) {
                return false;
            }

            try {
                console.log('اختبار الاتصال بـ Firebase...');
                await database.ref('.info/connected').once('value');
                console.log('تم الاتصال بـ Firebase بنجاح');
                return true;
            } catch (error) {
                console.error('فشل في الاتصال بـ Firebase:', error);
                return false;
            }
        }



        // Initialize Firebase and load data
        async function initializeApp() {
            try {
                console.log('بدء تهيئة التطبيق...');

                // Initialize Firebase in background
                initializeFirebase();

                // Load from local storage first for speed
                const localDataLoaded = await Promise.race([
                    Promise.all([loadChannelDataFromLocalStorage(), loadSportsEventsFromLocalStorage()]),
                    new Promise(resolve => setTimeout(() => resolve(true), 100)) // timeout after 100ms
                ]);

                // إعداد مراقبة الاتصال
                setupConnectionMonitoring();

                // Try Firebase in background without blocking UI
                if (firebaseAvailable) {
                    setTimeout(async () => {
                        try {
                            const isConnected = await testFirebaseConnection();
                            if (isConnected) {
                                // اختبار صلاحيات الكتابة
                                try {
                                    const testRef = database.ref('permissions_test');
                                    await testRef.set({ test: true });
                                    await testRef.remove();
                                    console.log('صلاحيات الكتابة متاحة');
                                } catch (permError) {
                                    console.warn('لا توجد صلاحيات كتابة - وضع القراءة فقط');
                                }
                                
                                // Load Firebase data in background
                                await loadChannelData();
                                await loadSportsEvents();
                                console.log('تم تحميل البيانات بنجاح من Firebase');
                            } else {
                                console.warn('لا يمكن الاتصال بـ Firebase، سيتم استخدام التخزين المحلي فقط');
                                firebaseAvailable = false;
                            }
                        } catch (error) {
                            console.warn('خطأ في Firebase، سيستمر بالبيانات المحلية:', error);
                            firebaseAvailable = false;
                        }
                    }, 200);
                }

                return true;
            } catch (error) {
                console.error('خطأ في تهيئة التطبيق:', error);
                return false;
            }
        }





        // Initialize app properly - محسن للسرعة مع دعم Android TV
        async function startApp() {
            try {
                // تحميل البيانات المحلية أولاً لعرض سريع
                loadChannelDataFromLocalStorage();
                loadSportsEventsFromLocalStorage();
                
                // عرض المحتوى فوراً
                updateSportsEventsDisplay();
                updateChannelCategoriesDisplay();
                
                // تهيئة Firebase في الخلفية
                setTimeout(async () => {
                    try {
                        await initializeApp();
                    } catch (error) {
                        console.warn('خطأ في تهيئة Firebase، سيستمر التطبيق بالبيانات المحلية:', error);
                    }
                }, 50);
                
                // تهيئة Android TV
                initializeAndroidTV();
                
                console.log('تم تهيئة التطبيق بنجاح');
            } catch (error) {
                console.error('خطأ في بدء التطبيق:', error);
                // Fallback to localStorage
                loadChannelDataFromLocalStorage();
                loadSportsEventsFromLocalStorage();
                updateSportsEventsDisplay();
                updateChannelCategoriesDisplay();
            }
        }

        // وظائف Android TV الإضافية
        function initializeAndroidTV() {
            // تحقق من Android TV
            if (tvRemote && tvRemote.isAndroidTV) {
                console.log('تم اكتشاف Android TV - تفعيل الميزات المحسنة');
                
                // إظهار رسالة ترحيب للتلفاز
                setTimeout(() => {
                    showTVWelcomeMessage();
                }, 2000);
                
                // إعداد اختصارات الريموت
                setupTVShortcuts();
                
                // تحسين الأداء للتلفاز
                optimizeForTV();
                
                // مراقبة حالة الشبكة
                monitorNetworkForTV();
            }
        }

        function showTVWelcomeMessage() {
            const overlay = document.getElementById('tvOverlay');
            if (overlay) {
                overlay.classList.add('active');
                setTimeout(() => {
                    overlay.classList.remove('active');
                }, 4000);
            }
        }

        function setupTVShortcuts() {
            // اختصارات إضافية لـ Android TV
            document.addEventListener('keydown', function(event) {
                switch(event.key) {
                    case 'F1':
                        event.preventDefault();
                        showSection('live');
                        break;
                    case 'F2':
                        event.preventDefault();
                        showSection('channels');
                        break;
                    case 'F3':
                        event.preventDefault();
                        showSection('settings');
                        break;
                    case 'F4':
                        event.preventDefault();
                        toggleSidebar();
                        break;
                }
            });
        }

        function optimizeForTV() {
            // تحسين الأداء للتلفاز
            document.body.classList.add('tv-optimized');
            
            // تقليل الحركات للأجهزة الضعيفة
            if (navigator.hardwareConcurrency < 4) {
                document.body.classList.add('low-performance-mode');
            }
            
            // تحسين التمرير للتلفاز
            const smoothScroll = {
                behavior: 'smooth',
                block: 'center',
                inline: 'center'
            };
            
            // إعداد التمرير المحسن
            window.tvScrollOptions = smoothScroll;
        }

        function monitorNetworkForTV() {
            // مراقبة حالة الشبكة لـ Android TV
            if ('connection' in navigator) {
                const connection = navigator.connection;
                
                function updateConnectionStatus() {
                    const isSlowConnection = connection.effectiveType === '2g' || 
                                          connection.effectiveType === 'slow-2g';
                    
                    if (isSlowConnection) {
                        document.body.classList.add('slow-connection');
                        showNotification('اتصال إنترنت بطيء - تم تفعيل وضع توفير البيانات', 'info', 5000);
                    } else {
                        document.body.classList.remove('slow-connection');
                    }
                }
                
                connection.addEventListener('change', updateConnectionStatus);
                updateConnectionStatus();
            }
        }

        // تحسين معالجة الأخطاء لـ Android TV
        function handleTVError(error, context) {
            console.error(`خطأ في Android TV (${context}):`, error);
            
            // إظهار رسالة خطأ مُحسنة للتلفاز
            const errorMessage = {
                'network': 'تحقق من اتصال الإنترنت',
                'loading': 'فشل في تحميل المحتوى',
                'playback': 'مشكلة في تشغيل الفيديو',
                'default': 'حدث خطأ غير متوقع'
            };
            
            showNotification(
                errorMessage[context] || errorMessage.default, 
                'error', 
                5000
            );
        }

        // تنظيف المراقبة عند إغلاق الصفحة
        window.addEventListener('beforeunload', () => {
            disableRealtimeSync();
        });

        // تنظيف المراقبة عند فقدان التركيز لفترة طويلة
        let visibilityTimeout;
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                // إيقاف المراقبة بعد 5 دقائق من عدم النشاط
                visibilityTimeout = setTimeout(() => {
                    disableRealtimeSync();
                    console.log('تم إيقاف المراقبة في الوقت الفعلي بسبب عدم النشاط');
                }, 5 * 60 * 1000);
            } else {
                // إعادة تفعيل المراقبة عند العودة
                if (visibilityTimeout) {
                    clearTimeout(visibilityTimeout);
                }
                if (firebaseAvailable && database) {
                    enableChannelDataRealtimeSync();
                    enableEventsRealtimeSync();
                    console.log('تم إعادة تفعيل المراقبة في الوقت الفعلي');
                    if (isAdminMode()) {
                        showNotification('تم إعادة تفعيل المزامنة التلقائية', 'info', 2000);
                    }
                }
            }
        });

        // توليد رقم تلقائي للأحداث
        function generateEventNumber() {
            // العثور على أعلى رقم مستخدم
            let highestNumber = 499; // البداية من 500

            sportsEvents.forEach(event => {
                if (event.link && event.link.startsWith('go:')) {
                    const number = parseInt(event.link.replace('go:', ''));
                    if (!isNaN(number) && number > highestNumber) {
                        highestNumber = number;
                    }
                }
            });

            const newNumber = highestNumber + 1;
            const eventLinkInput = document.getElementById('newEventLink');
            if (eventLinkInput) {
                eventLinkInput.value = `go:${newNumber}`;
                showNotification(`تم توليد الرقم: go:${newNumber}`, 'success');
            }
        }

        // توليد رقم تلقائي للأحداث في التعديل
        function generateEditEventNumber() {
            let highestNumber = 499;

            sportsEvents.forEach(event => {
                if (event.link && event.link.startsWith('go:')) {
                    const number = parseInt(event.link.replace('go:', ''));
                    if (!isNaN(number) && number > highestNumber) {
                        highestNumber = number;
                    }
                }
            });

            const newNumber = highestNumber + 1;
            const eventLinkInput = document.getElementById('editEventLink');
            if (eventLinkInput) {
                eventLinkInput.value = `go:${newNumber}`;
                showNotification(`تم توليد الرقم: go:${newNumber}`, 'success');
            }
        }

        // تحميل نسخة احتياطية من الأحداث الرياضية فقط (للأدمن فقط)
        function downloadBackupData() {
            if (!isAdminMode()) {
                showNotification('هذه الميزة متاحة للمشرفين فقط', 'error');
                return;
            }

            try {
                const backupData = {
                    sportsEvents: sportsEvents,
                    timestamp: new Date().toISOString(),
                    version: '1.0'
                };

                const dataStr = JSON.stringify(backupData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});

                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `nova-events-backup-${new Date().toISOString().slice(0,10)}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                showNotification('تم تحميل النسخة الاحتياطية للأحداث الرياضية بنجاح', 'success');
            } catch (error) {
                console.error('خطأ في تحميل البيانات:', error);
                showNotification('فشل في تحميل النسخة الاحتياطية', 'error');
            }
        }

        // استيراد الأحداث الرياضية من ملف (للأدمن فقط)
        function importBackupData() {
            if (!isAdminMode()) {
                showNotification('هذه الميزة متاحة للمشرفين فقط', 'error');
                return;
            }

            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);

                        if (importedData.sportsEvents) {
                            const confirmImport = confirm('هل تريد استيراد الأحداث الرياضية؟ سيتم استبدال الأحداث الحالية.');

                            if (confirmImport) {
                                sportsEvents = importedData.sportsEvents;
                                localStorage.setItem('Nova_sportsEvents', JSON.stringify(sportsEvents));

                                if (firebaseAvailable && database) {
                                    saveSportsEventsToFirebase();
                                }

                                updateSportsEventsDisplay();
                                loadEventsList();
                                showNotification('تم استيراد الأحداث الرياضية بنجاح', 'success');
                            }
                        } else {
                            showNotification('ملف البيانات غير صحيح أو لا يحتوي على أحداث رياضية', 'error');
                        }
                    } catch (error) {
                        console.error('خطأ في استيراد البيانات:', error);
                        showNotification('فشل في قراءة ملف البيانات', 'error');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // التحقق من وضع الأدمن
        function isAdminMode() {
            return document.getElementById('adminSection') && !document.getElementById('adminSection').classList.contains('hidden');
        }

        // وظيفة الحفظ التلقائي للأحداث الرياضية فقط
        async function autoSaveAllChanges() {
            if (!isAdminMode()) {
                showNotification('هذه الميزة متاحة للمشرفين فقط', 'error');
                return;
            }

            // إظهار مؤشر الحفظ
            const button = event.target;
            const originalContent = button.innerHTML;
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> جاري الحفظ...';
            button.disabled = true;

            try {
                // حفظ الأحداث الرياضية فقط
                if (sportsEvents && sportsEvents.length > 0) {
                    console.log('حفظ الأحداث الرياضية...');

                    const success = await saveSportsEvents();

                    if (success) {
                        showNotification('تم حفظ الأحداث الرياضية بنجاح في Firebase', 'success', 4000);
                        await logUserAction('auto_save', 'تم الحفظ التلقائي للأحداث الرياضية');
                        updateSportsEventsDisplay();
                    } else {
                        throw new Error('فشل في حفظ الأحداث الرياضية');
                    }
                } else {
                    showNotification('لا توجد أحداث رياضية للحفظ', 'info', 3000);
                }

            } catch (error) {
                console.error('خطأ في الحفظ التلقائي:', error);
                showNotification(`فشل في الحفظ التلقائي: ${error.message}`, 'error', 5000);

                // محاولة الحفظ المحلي كبديل
                try {
                    saveSportsEventsToLocalStorage();
                    showNotification('تم الحفظ محلياً كبديل للأحداث الرياضية', 'info', 3000);
                } catch (localError) {
                    console.error('فشل أيضاً في الحفظ المحلي:', localError);
                    showNotification('فشل في الحفظ بالكامل', 'error', 4000);
                }
            } finally {
                // إعادة تعيين حالة الزر
                button.innerHTML = originalContent;
                button.disabled = false;
            }
        }

        // إعادة تعيين الأحداث الرياضية للافتراضي
        async function resetToDefault() {
            if (!isAdminMode()) {
                showNotification('هذه الميزة متاحة للمشرفين فقط', 'error');
                return;
            }

            const confirmText = 'إعادة تعيين';
            const userInput = prompt(`تحذير: هذا سيحذف جميع الأحداث الرياضية المخصصة ويعيدها للإعدادات الافتراضية.\n\nلتأكيد العملية، اكتب: ${confirmText}`);

            if (userInput !== confirmText) {
                showNotification('تم إلغاء العملية', 'info');
                return;
            }

            showNotification('جاري إعادة تعيين الأحداث الرياضية...', 'info');

            try {
                // إعادة تعيين الأحداث الرياضية فقط
                sportsEvents = [...defaultSportsEvents];

                // حفظ البيانات الافتراضية
                if (firebaseAvailable && database) {
                    try {
                        await database.ref('sportsEvents').set(sportsEvents);
                        console.log('تم حفظ الأحداث الافتراضية في Firebase');
                    } catch (firebaseError) {
                        console.error('خطأ في حفظ Firebase:', firebaseError);
                    }
                }

                // حفظ محلي
                localStorage.setItem('Nova_sportsEvents', JSON.stringify(sportsEvents));

                // تحديث العروض
                loadEventsList();
                updateSportsEventsDisplay();

                showNotification('تم إعادة تعيين الأحداث الرياضية بنجاح', 'success');
                console.log('تم إعادة تعيين الأحداث الرياضية للافتراضي');

            } catch (error) {
                console.error('خطأ في إعادة التعيين:', error);
                showNotification('فشل في إعادة التعيين: ' + error.message, 'error');
            }
        }

        // تحديث عرض فئات القنوات الرئيسية
        function updateChannelCategoriesDisplay() {
            const categoriesGrid = document.getElementById('channelCategoriesGrid');
            if (!categoriesGrid) {
                console.warn('عنصر categoriesGrid غير موجود');
                return;
            }

            console.log('تحديث عرض فئات القنوات:', Object.keys(channelData).length, 'فئة');

            let html = '';
            for (const categoryId in channelData) {
                const category = channelData[categoryId];
                if (!category) continue;

                const categoryImage = category.image || 'https://c.top4top.io/p_3499bjfz31.jpg';
                const channelCount = category.channels ? category.channels.length : 0;

                html += `
                    <div class="channel-category-card" onclick="showChannelSubPage('${categoryId}')">
                        <div style="width: 100%; height: 100px; border-radius: 10px; margin-bottom: 1rem; position: relative; overflow: hidden; background: url('${categoryImage}') center/cover;">
                            <div style="position: absolute; bottom: 10px; left: 10px; z-index: 2; color: white;">
                            </div>
                        </div>
                        <div class="channel-category-name">${category.title}</div>
                        <div class="channel-category-desc">الرقم الأساسي: ${category.baseNumber}</div>
                        <div class="channel-category-badge">
                            <i class="fas fa-video" style="font-size: 1.1rem;"></i>
                            <span>${channelCount} قناة</span>
                        </div>
                    </div>
                `;
            }

            categoriesGrid.innerHTML = html;
            console.log('تم تحديث عرض الفئات بنجاح');

            // إضافة تحديث للبحث إذا كان نشطاً
            const searchInput = document.getElementById('mainChannelSearchInput');
            if (searchInput && searchInput.value.trim()) {
                filterMainChannels();
            }
        }

        

        // ===== وظائف لوحة التحكم المحسنة =====

        // تحميل بيانات لوحة التحكم
        async function loadAdminData() {
            try {
                loadEventsList();
                showNotification('تم تحميل بيانات لوحة التحكم', 'success');
            } catch (error) {
                console.error('خطأ في تحميل بيانات لوحة التحكم:', error);
                showNotification('خطأ في تحميل بيانات لوحة التحكم', 'error');
            }
        }

        // تبديل التبويبات في لوحة التحكم
        function switchAdminTab(tabName) {
            // إخفاء جميع التبويبات
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });

            // إزالة الحالة النشطة من جميع الأزرار
            document.querySelectorAll('.admin-tab').forEach(btn => {
                btn.classList.remove('active');
            });

            // إظهار التبويب المحدد
            const targetTab = document.getElementById(`admin${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Tab`);
            if (targetTab) {
                targetTab.classList.remove('hidden');
            }

            // تفعيل الزر المحدد
            const activeBtn = document.querySelector(`[data-tab="${tabName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }

            // تحميل البيانات حسب التبويب
            switch(tabName) {
                case 'events':
                    loadEventsList();
                    break;
            }
        }

        // تحميل قائمة الأحداث
        function loadEventsList() {
            const eventsList = document.getElementById('eventsList');
            if (!eventsList) return;

            if (sportsEvents.length === 0) {
                eventsList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
                        <i class="fas fa-futbol" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <h3>لا توجد أحداث رياضية</h3>
                        <p>ابدأ بإضافة حدث رياضي جديد</p>
                    </div>
                `;
                return;
            }

            eventsList.innerHTML = sportsEvents.map((event, index) => {
                const statusIcon = event.status === 'live' ? 'fas fa-circle text-danger' : 
                                 event.status === 'finished' ? 'fas fa-check-circle text-success' : 
                                 'fas fa-clock text-warning';
                const statusText = event.status === 'live' ? 'مباشر' : 
                                 event.status === 'finished' ? 'انتهى' : 'قادم';
                const statusColor = event.status === 'live' ? '#ff4757' : 
                                  event.status === 'finished' ? '#2ed573' : '#ffa502';

                return `
                    <div class="category-item" style="align-items: flex-start;">
                        <div style="display: flex; gap: 1rem; align-items: flex-start; flex: 1;">
                            <div style="width: 80px; height: 60px; border-radius: 8px; overflow: hidden; flex-shrink: 0; background: var(--border-primary);">
                                <img src="${event.image}" alt="${event.title}" style="width: 100%; height: 100%; object-fit: cover;" onerror="this.style.display='none'">
                            </div>
                            <div class="item-info" style="flex: 1;">
                                <div class="item-title">${event.title}</div>
                                <div class="item-subtitle">${event.subtitle}</div>
                                <div style="margin-top: 0.5rem;">
                                    <span style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: 600; background: rgba(${statusColor === '#ff4757' ? '255, 71, 87' : statusColor === '#2ed573' ? '46, 213, 115' : '255, 165, 2'}, 0.1); color: ${statusColor}; border: 1px solid rgba(${statusColor === '#ff4757' ? '255, 71, 87' : statusColor === '#2ed573' ? '46, 213, 115' : '255, 165, 2'}, 0.3);">
                                        <i class="${statusIcon}" style="font-size: 0.7rem;"></i>
                                        ${statusText}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="item-actions">
                            <button class="action-btn" onclick="editEvent(${index})" title="تعديل">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" onclick="deleteEvent(${index})" title="حذف">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // وظيفة توليد معرف فريد
        function generateUniqueId() {
            return Date.now().toString(36) + Math.random().toString(36).substring(2);
        }

        // إضافة حدث رياضي جديد مع تحسينات
        async function addNewEvent() {
            const title = document.getElementById('newEventTitle')?.value.trim();
            const subtitle = document.getElementById('newEventSubtitle')?.value.trim();
            const image = document.getElementById('newEventImage')?.value.trim();
            const link = document.getElementById('newEventLink')?.value.trim();
            const status = document.getElementById('newEventStatus')?.value;

            // التحقق من صحة البيانات
            if (!title || !subtitle || !link || !status) {
                showNotification('يرجى ملء جميع الحقول المطلوبة', 'error');
                return;
            }

            // التحقق من صحة الرابط
            if (!link.startsWith('go:') && !link.startsWith('http')) {
                showNotification('الرابط يجب أن يبدأ بـ go: أو http', 'error');
                return;
            }

            // التحقق من عدم تكرار الحدث
            const eventExists = sportsEvents.some(event => 
                event.title === title && event.subtitle === subtitle
            );

            if (eventExists) {
                showNotification('حدث بنفس العنوان والوصف موجود بالفعل', 'error');
                return;
            }

            showNotification('جاري إضافة الحدث...', 'info');

            try {
                const newEvent = {
                    id: generateUniqueId(),
                    title: title,
                    subtitle: subtitle,
                    image: image || null,
                    link: link,
                    status: status,
                    timestamp: Date.now(),
                    category: 'general',
                    permanent: false,
                    lastModified: Date.now()
                };

                console.log('محاولة إضافة حدث رياضي جديد:', newEvent);

                // إضافة الحدث للمصفوفة
                sportsEvents.push(newEvent);

                // حفظ البيانات مع معالجة محسنة للأخطاء
                const saved = await saveSportsEvents();

                if (saved) {
                    // تنظيف النموذج
                    clearAddEventForm();

                    // تحديث العروض
                    loadEventsList();
                    updateSportsEventsDisplay();

                    console.log('تم إضافة الحدث بنجاح:', title);
                    showNotification('تم إضافة الحدث بنجاح وحفظه بشكل آمن', 'success');
                } else {
                    // إزالة الحدث إذا فشل الحفظ
                    sportsEvents.pop();
                    showNotification('فشل في حفظ الحدث - يرجى المحاولة مرة أخرى', 'error');
                }

            } catch (error) {
                console.error('خطأ في إضافة الحدث:', error);
                // إزالة الحدث إذا حدث خطأ
                if (sportsEvents.length > 0 && sportsEvents[sportsEvents.length - 1].title === title) {
                    sportsEvents.pop();
                }
                showNotification('فشل في إضافة الحدث: ' + error.message, 'error');
            }
        }

        // تنظيف نموذج إضافة الحدث
        function clearAddEventForm() {
            const fields = ['newEventTitle', 'newEventSubtitle', 'newEventImage', 'newEventLink'];
            fields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) field.value = '';
            });

            const statusField = document.getElementById('newEventStatus');
            if (statusField) statusField.value = 'upcoming';

            const preview = document.getElementById('newEventImagePreview');
            if (preview) preview.style.display = 'none';
        }

        // تعديل حدث رياضي
        function editEvent(eventIndex) {
            const event = sportsEvents[eventIndex];
            if (!event) {
                showNotification('الحدث غير موجود', 'error');
                return;
            }

            // ملء نموذج التعديل
            document.getElementById('editEventIndex').value = eventIndex;
            document.getElementById('editEventTitle').value = event.title;
            document.getElementById('editEventSubtitle').value = event.subtitle;
            document.getElementById('editEventImage').value = event.image || '';
            document.getElementById('editEventLink').value = event.link;
            document.getElementById('editEventStatus').value = event.status;

            // إظهار معاينة الصورة إذا وجدت
            if (event.image) {
                const preview = document.getElementById('editEventImagePreview');
                const img = document.getElementById('editEventImagePreviewImg');
                if (preview && img) {
                    img.src = event.image;
                    preview.style.display = 'block';
                }
            }

            // إظهار النموذج
            document.getElementById('editEventModal').style.display = 'flex';
        }

        // إغلاق نموذج تعديل الحدث
        function closeEditEventModal() {
            document.getElementById('editEventModal').style.display = 'none';
        }

        // حفظ تغييرات الحدث
        async function saveEventChanges() {
            const eventIndex = parseInt(document.getElementById('editEventIndex')?.value);
            const title = document.getElementById('editEventTitle')?.value.trim();
            const subtitle = document.getElementById('editEventSubtitle')?.value.trim();
            const image = document.getElementById('editEventImage')?.value.trim();
            const link = document.getElementById('editEventLink')?.value.trim();
            const status = document.getElementById('editEventStatus')?.value;

            if (isNaN(eventIndex) || !title || !subtitle || !link || !status) {
                showNotification('بيانات غير صحيحة', 'error');
                return;
            }

            try {
                if (!sportsEvents[eventIndex]) {
                    showNotification('الحدث غير موجود', 'error');
                    return;
                }

                // احفظ البيانات القديمة للتراجع في حالة الخطأ
                const oldEventData = { ...sportsEvents[eventIndex] };

                // تحديث الحدث مع الاحتفاظ بالمعلومات الأساسية
                sportsEvents[eventIndex] = {
                    ...sportsEvents[eventIndex], // الاحتفاظ بالـ ID والبيانات الأساسية
                    title: title,
                    subtitle: subtitle,
                    image: image || null,
                    link: link,
                    status: status,
                    lastModified: Date.now()
                };

                const saved = await saveSportsEvents();

                if (saved) {
                    closeEditEventModal();
                    loadEventsList();
                    updateSportsEventsDisplay();
                    showNotification('تم تحديث الحدث بنجاح', 'success');
                } else {
                    // استعادة البيانات القديمة في حالة فشل الحفظ
                    sportsEvents[eventIndex] = oldEventData;
                    showNotification('فشل في حفظ التغييرات', 'error');
                }

            } catch (error) {
                console.error('خطأ في تحديث الحدث:', error);
                showNotification('فشل في تحديث الحدث: ' + error.message, 'error');
            }
        }

        // حذف حدث رياضي
        async function deleteEvent(eventIndex) {
            const event = sportsEvents[eventIndex];
            if (!event) {
                showNotification('الحدث غير موجود', 'error');
                return;
            }

            // منع حذف الأحداث الدائمة
            if (event.permanent) {
                showNotification('لا يمكن حذف الأحداث الافتراضية', 'error');
                return;
            }

            if (!confirm(`هل أنت متأكد من حذف الحدث "${event.title}"؟`)) {
                return;
            }

            try {
                // احفظ الحدث المحذوف للتراجع
                const deletedEvent = { ...event };
                const deletedIndex = eventIndex;

                // حذف الحدث
                sportsEvents.splice(eventIndex, 1);

                const saved = await saveSportsEvents();

                if (saved) {
                    loadEventsList();
                    updateSportsEventsDisplay();
                    showNotification('تم حذف الحدث بنجاح', 'success');
                } else {
                    // استعادة الحدث المحذوف في حالة فشل الحفظ
                    sportsEvents.splice(deletedIndex, 0, deletedEvent);
                    showNotification('فشل في حذف الحدث', 'error');
                }

            } catch (error) {
                console.error('خطأ في حذف الحدث:', error);
                showNotification('فشل في حذف الحدث: ' + error.message, 'error');
            }
        }

        // توليد رقم تلقائي للأحداث
        function generateEventNumber() {
            const input = document.getElementById('newEventLink');
            if (!input) return;

            // Find the highest existing event number
            let maxNumber = 500; // Start from 500
            sportsEvents.forEach(event => {
                if (event.link && event.link.startsWith('go:')) {
                    const number = parseInt(event.link.replace('go:', ''));
                    if (!isNaN(number) && number > maxNumber) {
                        maxNumber = number;
                    }
                }
            });

            // Set next available number
            input.value = `go:${maxNumber + 1}`;
            showNotification(`تم توليد الرقم التلقائي: ${maxNumber + 1}`, 'success');
        }

        function generateEditEventNumber() {
            const input = document.getElementById('editEventLink');
            if (!input) return;

            // Find the highest existing event number
            let maxNumber = 500; // Start from 500
            sportsEvents.forEach(event => {
                if (event.link && event.link.startsWith('go:')) {
                    const number = parseInt(event.link.replace('go:', ''));
                    if (!isNaN(number) && number > maxNumber) {
                        maxNumber = number;
                    }
                }
            });

            // Set next available number
            input.value = `go:${maxNumber + 1}`;
            showNotification(`تم توليد الرقم التلقائي: ${maxNumber + 1}`, 'success');
        }

        // ===== نظام تحكم محسن لـ Android TV =====
        class TVRemoteController {
            constructor() {
                this.focusableElements = [];
                this.currentFocusIndex = -1;
                this.isRemoteMode = false;
                this.isAndroidTV = this.detectAndroidTV();
                this.lastInputTime = Date.now();
                this.remoteDetectionDelay = 3000;
                this.updateTimeout = null;
                this.isUpdating = false;
                this.lastUpdateTime = 0;
                this.updateThrottle = 300;
                this.init();
            }

            detectAndroidTV() {
                const userAgent = navigator.userAgent.toLowerCase();
                const platform = navigator.platform.toLowerCase();
                
                // تحقق من Android TV
                if (userAgent.includes('android') && userAgent.includes('tv')) {
                    return true;
                }
                
                // تحقق من الشاشات الكبيرة مع عدم وجود touch
                if (window.screen.width >= 1280 && window.screen.height >= 720) {
                    if (!('ontouchstart' in window) && !navigator.maxTouchPoints) {
                        return true;
                    }
                }
                
                return false;
            }

            init() {
                console.log('تهيئة نظام التحكم بالريموت لـ Android TV');
                
                // إضافة كلاسات خاصة بـ Android TV
                if (this.isAndroidTV) {
                    document.body.classList.add('android-tv', 'tv-optimized');
                    this.enableRemoteMode();
                }
                
                // إعداد مراقبة الأحداث
                document.addEventListener('keydown', this.handleKeyDown.bind(this));
                document.addEventListener('click', this.handleClick.bind(this));
                document.addEventListener('touchstart', this.handleTouch.bind(this));
                document.addEventListener('mousemove', this.handleMouseMove.bind(this));
                
                // إعداد مراقبة تغييرات DOM
                this.setupMutationObserver();
                
                // تحديث العناصر القابلة للتركيز
                setTimeout(() => {
                    this.updateFocusableElements();
                }, 500);
                
                // إضافة مؤشر التنقل للتلفاز
                this.addTVNavigationHint();
            }

            addTVNavigationHint() {
                if (this.isAndroidTV) {
                    const hint = document.createElement('div');
                    hint.className = 'tv-navigation-hint';
                    hint.innerHTML = `
                        <i class="fas fa-gamepad"></i>
                        استخدم الأسهم للتنقل • Enter للاختيار • Back للرجوع
                    `;
                    document.body.appendChild(hint);
                }
            }

            setupMutationObserver() {
                const observer = new MutationObserver((mutations) => {
                    // تجاهل التغييرات الطفيفة
                    const significantChange = mutations.some(mutation => 
                        mutation.type === 'childList' && 
                        (mutation.addedNodes.length > 0 || mutation.removedNodes.length > 0) ||
                        (mutation.type === 'attributes' && 
                         ['class', 'style'].includes(mutation.attributeName) &&
                         mutation.target.classList.contains('section'))
                    );

                    if (!significantChange) return;

                    clearTimeout(this.updateTimeout);
                    this.updateTimeout = setTimeout(() => {
                        if (!this.isUpdating) {
                            this.throttledUpdate();
                        }
                    }, 300); // تأخير أطول
                });

                observer.observe(document.body, {
                    childList: true,
                    subtree: true,
                    attributes: true,
                    attributeFilter: ['class', 'style']
                });
            }

            // تحديث محدود بالوقت
            throttledUpdate() {
                const now = Date.now();
                if (now - this.lastUpdateTime < this.updateThrottle) {
                    return; // تجاهل إذا كان التحديث حديثاً جداً
                }

                this.lastUpdateTime = now;
                this.updateFocusableElements();
            }

            updateFocusableElements() {
                if (this.isUpdating) return; // منع التداخل
                this.isUpdating = true;

                try {
                    // العناصر القابلة للتركيز - مبسطة للسرعة
                    const selectors = [
                        'button:not([disabled]):not(.hidden)',
                        'a[href]:not(.hidden)',
                        '.card:not(.hidden)',
                        '.channel-item:not(.hidden)',
                        '.channel-category-card:not(.hidden)',
                        '.nav-btn:not(.hidden)',
                        '.welcome-channels-btn:not(.hidden)'
                    ];

                    const newElements = [];

                    selectors.forEach(selector => {
                        try {
                            const elements = document.querySelectorAll(selector);
                            elements.forEach(element => {
                                try {
                                    const computedStyle = window.getComputedStyle(element);
                                    const isVisible = computedStyle.display !== 'none' && 
                                                    computedStyle.visibility !== 'hidden' && 
                                                    computedStyle.opacity !== '0' &&
                                                    element.offsetParent !== null;

                                    if (isVisible && this.isElementInViewport(element)) {
                                        newElements.push(element);
                                        this.makeFocusable(element);
                                    }
                                } catch (e) {
                                    // تجاهل العنصر في حالة حدوث خطأ
                                }
                            });
                        } catch (e) {
                            // تجاهل المحدد في حالة حدوث خطأ
                        }
                    });

                    // تحديث العناصر فقط إذا كان هناك تغيير كبير
                    if (Math.abs(newElements.length - this.focusableElements.length) > 1) {
                        this.focusableElements = newElements;

                        // ترتيب العناصر حسب الموقع
                        this.focusableElements.sort((a, b) => {
                            try {
                                const rectA = a.getBoundingClientRect();
                                const rectB = b.getBoundingClientRect();

                                if (Math.abs(rectA.top - rectB.top) > 50) {
                                    return rectA.top - rectB.top; // ترتيب عمودي
                                }
                                return rectA.left - rectB.left; // ترتيب أفقي
                            } catch (e) {
                                return 0;
                            }
                        });

                        // طباعة الرسالة فقط عند التغيير الكبير
                        console.log(`تم تحديث العناصر: ${this.focusableElements.length} عنصر قابل للتركيز`);
                    }

                } catch (error) {
                    console.warn('خطأ في تحديث العناصر القابلة للتركيز:', error);
                } finally {
                    this.isUpdating = false;
                }
            }

            isElementInViewport(element) {
                const rect = element.getBoundingClientRect();
                return (
                    rect.top >= 0 &&
                    rect.left >= 0 &&
                    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) + 200 &&
                    rect.right <= (window.innerWidth || document.documentElement.clientWidth)
                );
            }

            makeFocusable(element) {
                if (!element.hasAttribute('tabindex') && element.tagName !== 'INPUT' && element.tagName !== 'SELECT') {
                    element.setAttribute('tabindex', '0');
                }
                element.classList.add('focusable');
            }

            setInitialFocus() {
                if (this.focusableElements.length > 0 && this.currentFocusIndex === -1) {
                    this.currentFocusIndex = 0;
                    if (this.isRemoteMode) {
                        this.focusElement(this.focusableElements[0]);
                    }
                }
            }

            handleKeyDown(event) {
                // اكتشاف استخدام الريموت مع أزرار Android TV الإضافية
                const remoteKeys = [
                    'ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 
                    'Enter', 'Space', 'Escape', 'Backspace',
                    'MediaPlayPause', 'MediaStop', 'MediaTrackNext', 'MediaTrackPrevious',
                    'ContextMenu', 'Home', 'End', 'PageUp', 'PageDown'
                ];
                
                if (remoteKeys.includes(event.key) || event.key.startsWith('Media')) {
                    this.enableRemoteMode();
                }

                if (!this.isRemoteMode && !this.isAndroidTV) return;

                // تحديث العناصر إذا لزم الأمر
                if (this.focusableElements.length === 0) {
                    this.updateFocusableElements();
                }

                // معالجة الأزرار
                switch (event.key) {
                    case 'ArrowDown':
                        event.preventDefault();
                        this.moveVertically(1);
                        this.showTVHint('↓ التحرك لأسفل');
                        break;
                    case 'ArrowUp':
                        event.preventDefault();
                        this.moveVertically(-1);
                        this.showTVHint('↑ التحرك لأعلى');
                        break;
                    case 'ArrowRight':
                        event.preventDefault();
                        this.moveHorizontally(1);
                        this.showTVHint('→ التحرك يميناً');
                        break;
                    case 'ArrowLeft':
                        event.preventDefault();
                        this.moveHorizontally(-1);
                        this.showTVHint('← التحرك يساراً');
                        break;
                    case 'Enter':
                    case ' ':
                        event.preventDefault();
                        this.activateCurrentElement();
                        this.showTVHint('✓ تم الاختيار');
                        break;
                    case 'Escape':
                    case 'Backspace':
                        event.preventDefault();
                        this.handleEscape();
                        this.showTVHint('← العودة');
                        break;
                    case 'Home':
                        event.preventDefault();
                        showSection('live');
                        this.showTVHint('🏠 الصفحة الرئيسية');
                        break;
                    case 'ContextMenu':
                        event.preventDefault();
                        toggleSidebar();
                        this.showTVHint('☰ فتح القائمة');
                        break;
                    case 'PageUp':
                        event.preventDefault();
                        window.scrollBy(0, -window.innerHeight / 2);
                        this.showTVHint('⇈ تمرير لأعلى');
                        break;
                    case 'PageDown':
                        event.preventDefault();
                        window.scrollBy(0, window.innerHeight / 2);
                        this.showTVHint('⇊ تمرير لأسفل');
                        break;
                    // أزرار الوسائط
                    case 'MediaPlayPause':
                        event.preventDefault();
                        this.showTVHint('⏯️ تشغيل/إيقاف');
                        break;
                    case 'MediaStop':
                        event.preventDefault();
                        this.showTVHint('⏹️ إيقاف');
                        break;
                    // أرقام الريموت للانتقال المباشر
                    case '0':
                    case '1':
                    case '2':
                    case '3':
                    case '4':
                    case '5':
                    case '6':
                    case '7':
                    case '8':
                    case '9':
                        event.preventDefault();
                        this.handleNumberKey(event.key);
                        break;
                }
                
                this.lastInputTime = Date.now();
            }

            showTVHint(message) {
                if (!this.isAndroidTV) return;
                
                const hint = document.querySelector('.tv-navigation-hint');
                if (hint) {
                    hint.innerHTML = `<i class="fas fa-gamepad"></i> ${message}`;
                    hint.style.display = 'block';
                    
                    clearTimeout(this.hintTimeout);
                    this.hintTimeout = setTimeout(() => {
                        hint.innerHTML = `
                            <i class="fas fa-gamepad"></i>
                            استخدم الأسهم للتنقل • Enter للاختيار • Back للرجوع
                        `;
                    }, 2000);
                }
            }

            handleNumberKey(number) {
                const sections = ['live', 'channels', 'settings'];
                const sectionIndex = parseInt(number) - 1;
                
                if (sectionIndex >= 0 && sectionIndex < sections.length) {
                    showSection(sections[sectionIndex]);
                    this.showTVHint(`${number} - ${this.getSectionName(sections[sectionIndex])}`);
                } else if (number === '0') {
                    toggleSidebar();
                    this.showTVHint('0 - القائمة');
                }
            }

            getSectionName(section) {
                const names = {
                    'live': 'الرئيسية',
                    'channels': 'القنوات',
                    'settings': 'الإعدادات',
                    'admin': 'لوحة التحكم'
                };
                return names[section] || section;
            }

            moveVertically(direction) {
                if (this.focusableElements.length === 0) return;

                const currentElement = this.focusableElements[this.currentFocusIndex];
                if (!currentElement) {
                    this.currentFocusIndex = 0;
                    this.focusElement(this.focusableElements[0]);
                    return;
                }

                const currentRect = currentElement.getBoundingClientRect();
                let bestMatch = null;
                let bestDistance = Infinity;

                this.focusableElements.forEach((element, index) => {
                    if (index === this.currentFocusIndex) return;

                    const rect = element.getBoundingClientRect();
                    const verticalDistance = (rect.top - currentRect.top) * direction;
                    const horizontalDistance = Math.abs(rect.left - currentRect.left);

                    if (verticalDistance > 20) { // التحرك في الاتجاه الصحيح
                        const totalDistance = verticalDistance + (horizontalDistance * 0.3);
                        if (totalDistance < bestDistance) {
                            bestDistance = totalDistance;
                            bestMatch = index;
                        }
                    }
                });

                if (bestMatch !== null) {
                    this.currentFocusIndex = bestMatch;
                } else {
                    // الانتقال للطرف الآخر
                    this.currentFocusIndex = direction > 0 ? 0 : this.focusableElements.length - 1;
                }

                this.focusElement(this.focusableElements[this.currentFocusIndex]);
            }

            moveHorizontally(direction) {
                if (this.focusableElements.length === 0) return;

                const currentElement = this.focusableElements[this.currentFocusIndex];
                if (!currentElement) {
                    this.currentFocusIndex = 0;
                    this.focusElement(this.focusableElements[0]);
                    return;
                }

                const currentRect = currentElement.getBoundingClientRect();
                let bestMatch = null;
                let bestDistance = Infinity;

                this.focusableElements.forEach((element, index) => {
                    if (index === this.currentFocusIndex) return;

                    const rect = element.getBoundingClientRect();
                    const horizontalDistance = (rect.left - currentRect.left) * direction;
                    const verticalDistance = Math.abs(rect.top - currentRect.top);

                    if (horizontalDistance > 10) { // التحرك في الاتجاه الصحيح
                        const totalDistance = horizontalDistance + (verticalDistance * 0.5);
                        if (totalDistance < bestDistance) {
                            bestDistance = totalDistance;
                            bestMatch = index;
                        }
                    }
                });

                if (bestMatch !== null) {
                    this.currentFocusIndex = bestMatch;
                } else {
                    // البحث في نفس الصف
                    this.moveInSameRow(direction, currentRect);
                }

                this.focusElement(this.focusableElements[this.currentFocusIndex]);
            }

            moveInSameRow(direction, currentRect) {
                const sameRowElements = this.focusableElements.filter((element, index) => {
                    if (index === this.currentFocusIndex) return false;
                    const rect = element.getBoundingClientRect();
                    return Math.abs(rect.top - currentRect.top) < 50;
                });

                if (sameRowElements.length > 0) {
                    const sortedElements = sameRowElements.sort((a, b) => a.getBoundingClientRect().left - b.getBoundingClientRect().left);
                    const targetElement = direction > 0 ? sortedElements[0] : sortedElements[sortedElements.length - 1];
                    this.currentFocusIndex = this.focusableElements.indexOf(targetElement);
                }
            }

            focusElement(element) {
                if (!element) return;

                // إزالة التركيز من جميع العناصر
                this.focusableElements.forEach(el => {
                    el.classList.remove('tv-focused');
                    el.blur();
                });

                // إضافة التركيز للعنصر الحالي
                element.classList.add('tv-focused');
                element.focus();

                // التمرير للعنصر إذا كان خارج الشاشة
                this.scrollToElement(element);

                console.log('تركيز على:', element.className, element.textContent?.substring(0, 30));
            }

            scrollToElement(element) {
                const rect = element.getBoundingClientRect();
                const isInView = (
                    rect.top >= 0 &&
                    rect.left >= 0 &&
                    rect.bottom <= window.innerHeight &&
                    rect.right <= window.innerWidth
                );

                if (!isInView) {
                    element.scrollIntoView({
                        behavior: 'smooth',
                        block: 'center',
                        inline: 'center'
                    });
                }
            }

            activateCurrentElement() {
                const currentElement = this.focusableElements[this.currentFocusIndex];
                if (!currentElement) return;

                // محاكاة النقر
                const event = new MouseEvent('click', {
                    bubbles: true,
                    cancelable: true,
                    view: window
                });

                currentElement.dispatchEvent(event);
                console.log('تم تنشيط العنصر:', currentElement.className);

                // تحديث العناصر بعد التفاعل
                setTimeout(() => {
                    this.updateFocusableElements();
                }, 500);
            }

            handleEscape() {
                // التعامل مع زر الهروب - إغلاق النوافذ المنبثقة أو العودة
                const modals = document.querySelectorAll('[style*="display: flex"], [style*="display: block"]:not(.main-app)');
                const visibleModal = Array.from(modals).find(modal => {
                    const style = window.getComputedStyle(modal);
                    return style.display !== 'none' && modal.classList.contains('overlay', 'modal');
                });

                if (visibleModal) {
                    const closeBtn = visibleModal.querySelector('.close-btn, .profile-close, [onclick*="close"]');
                    if (closeBtn) {
                        closeBtn.click();
                    }
                } else {
                    // العودة للقسم الرئيسي
                    showSection('live');
                }
            }

            enableRemoteMode() {
                if (!this.isRemoteMode) {
                    this.isRemoteMode = true;
                    document.body.classList.add('remote-mode');
                    console.log('تم تفعيل وضع التحكم بالريموت');

                    this.updateFocusableElements();
                    this.setInitialFocus();
                }
                this.lastInputTime = Date.now();
            }

            handleClick(event) {
                // إيقاف وضع الريموت عند النقر بالماوس
                this.lastInputTime = Date.now();
                setTimeout(() => {
                    if (Date.now() - this.lastInputTime > this.remoteDetectionDelay) {
                        this.disableRemoteMode();
                    }
                }, this.remoteDetectionDelay);
            }

            handleTouch() {
                // إيقاف وضع الريموت عند اللمس
                this.disableRemoteMode();
            }

            handleMouseMove() {
                // إيقاف وضع الريموت عند حركة الماوس
                this.lastInputTime = Date.now();
                setTimeout(() => {
                    if (Date.now() - this.lastInputTime > this.remoteDetectionDelay) {
                        this.disableRemoteMode();
                    }
                }, this.remoteDetectionDelay);
            }

            disableRemoteMode() {
                if (this.isRemoteMode) {
                    this.isRemoteMode = false;
                    document.body.classList.remove('remote-mode');

                    // إزالة التركيز من جميع العناصر
                    this.focusableElements.forEach(el => {
                        el.classList.remove('tv-focused');
                        el.blur();
                    });

                    console.log('تم إيقاف وضع التحكم بالريموت');
                }
            }

            // إعادة تحديث العناصر عند تغيير القسم مع منع التذبذب
            onSectionChange() {
                // إيقاف التحديثات المؤقتة
                clearTimeout(this.updateTimeout);

                // تأخير أطول للسماح للقسم الجديد بالتحميل الكامل
                setTimeout(() => {
                    if (!this.isUpdating) {
                        this.updateFocusableElements();
                        this.setInitialFocus();
                    }
                }, 800); // تأخير أطول
            }
        }

        // إنشاء نسخة من التحكم بالريموت
        const tvRemote = new TVRemoteController();

        // ربط التحكم بالريموت مع تغيير الأقسام
        const originalShowSection = window.showSection;
        window.showSection = function(section) {
            originalShowSection(section);
            tvRemote.onSectionChange();
        };

        // Start the app
        startApp();



        // Firebase connection status
        let firebaseStatus = {
            connected: false,
            lastCheck: null
        };

        // Monitor Firebase connection
        async function monitorFirebaseConnection() {
            if (firebaseAvailable && database) {
                try {
                    const snapshot = await database.ref('.info/connected').once('value');
                    const connected = snapshot.val();

                    if (connected) {
                        if (!firebaseStatus.connected) {
                            firebaseStatus.connected = true;
                            console.log('اتصال Firebase نشط');
                        }
                    } else {
                        if (firebaseStatus.connected) {
                            firebaseStatus.connected = false;
                            console.warn('انقطع اتصال Firebase');
                        }
                    }
                } catch (error) {
                    if (firebaseStatus.connected) {
                        firebaseStatus.connected = false;
                        console.warn('انقطع اتصال Firebase:', error);
                    }
                }
            }

            firebaseStatus.lastCheck = new Date();
        }

        // Check Firebase connection periodically
        setInterval(monitorFirebaseConnection, 30000); // كل 30 ثانية

        // Initialize App - محسن للسرعة
        window.addEventListener('DOMContentLoaded', () => {
            try {
                // إخفاء شاشة التحميل بسرعة أكبر
                const loadingOverlay = document.getElementById('loadingOverlay');
                if (loadingOverlay) {
                    loadingOverlay.style.opacity = '0';
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                        if (!checkSavedLogin()) {
                            const loginPage = document.getElementById('loginPage');
                            if (loginPage) {
                                loginPage.classList.remove('hidden');
                            }
                        }
                    }, 100);
                }

                // تهيئة سريعة للعناصر الأساسية
                applyThemeColor();
                initializeSettings();
                
                // تأجيل Firebase إلى ما بعد ظهور الواجهة
                setTimeout(() => {
                    monitorFirebaseConnection();
                }, 100);
                
                // تأجيل تهيئة الهيدر للحصول على أداء أفضل
                requestAnimationFrame(() => {
                    initializeHeaderScroll();
                });
                
            } catch (error) {
                console.error('Critical error during app load:', error);
                // إخفاء شاشة التحميل حتى مع الأخطاء
                const loadingOverlay = document.getElementById('loadingOverlay');
                if (loadingOverlay) {
                    loadingOverlay.style.display = 'none';
                }
            }
        });

        // Header Scroll Animation (Simplified)
        function initializeHeaderScroll() {
            let lastScrollTop = 0;
            let isScrolling = false;
            let hideTimeout;
            const header = document.querySelector('.header');
            const mainContent = document.querySelector('.main-content');

            if (!header) return;

            window.addEventListener('scroll', function() {
                if (!isScrolling) {
                    window.requestAnimationFrame(function() {
                        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                        const scrollDirection = scrollTop > lastScrollTop ? 'down' : 'up';
                        const scrollSpeed = Math.abs(scrollTop - lastScrollTop);

                        // Clear any existing timeout
                        clearTimeout(hideTimeout);

                        // إخفاء الهيدر عند السحب للأسفل بسرعة
                        if (scrollDirection === 'down' && scrollTop > 100 && scrollSpeed > 5) {
                            header.classList.add('header-hidden');
                            if (mainContent) mainContent.classList.add('header-hidden');
                        } else if (scrollDirection === 'up' || scrollTop <= 60) {
                            header.classList.remove('header-hidden');
                            if (mainContent) mainContent.classList.remove('header-hidden');
                        }

                        // إظهار الهيدر عند التوقف عن السحب
                        hideTimeout = setTimeout(() => {
                            if (scrollTop > 100) {
                                header.classList.remove('header-hidden');
                                if (mainContent) mainContent.classList.remove('header-hidden');
                            }
                        }, 2000);

                        // إضافة تأثير الخلفية عند السحب
                        if (scrollTop > 30) {
                            header.classList.add('header-scrolled');
                        } else {
                            header.classList.remove('header-scrolled');
                        }

                        lastScrollTop = scrollTop;
                        isScrolling = false;
                    });
                }
                isScrolling = true;
            }, { passive: true });

            // إظهار الهيدر عند hover في الجزء العلوي
            document.addEventListener('mousemove', function(e) {
                if (e.clientY < 60 && header.classList.contains('header-hidden')) {
                    header.classList.remove('header-hidden');
                    if (mainContent) mainContent.classList.remove('header-hidden');
                }
            });
        }



        // Initialize Settings
        function initializeSettings() {


            // Notifications switch
            const notificationsSwitch = document.getElementById('notificationsSwitch');
            if (notificationsSwitch) {
                notificationsSwitch.addEventListener('change', function() {
                    const previousSetting = settings.notifications;
                    settings.notifications = this.checked;
                    localStorage.setItem('Nova_settings', JSON.stringify(settings));

                    // إظهار إشعار واحد فقط لتأكيد التغيير (مع تجاوز إعدادات الإشعارات مؤقتاً)
                    const tempNotifications = settings.notifications;
                    settings.notifications = true; // تفعيل مؤقت لإظهار رسالة التأكيد
                    showNotification(this.checked ? 'تم تفعيل الإشعارات' : 'تم إلغاء الإشعارات', 'success');

                    // إعادة الإعداد للحالة الصحيحة
                    setTimeout(() => {
                        settings.notifications = tempNotifications;
                    }, 100);
                });
                notificationsSwitch.checked = settings.notifications;
            }

            // Data saver switch
            const dataSaverSwitch = document.getElementById('dataSaverSwitch');
            if (dataSaverSwitch) {
                dataSaverSwitch.addEventListener('change', function() {
                    settings.dataSaver = this.checked;
                    localStorage.setItem('Nova_settings', JSON.stringify(settings));
                    showNotification(this.checked ? 'الميزة لا تعمل حاليا' : 'الميزة لا تعمل حاليا', 'erorr');
                });
                dataSaverSwitch.checked = settings.dataSaver || false;
            }


        }





        // Login Functions
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;

            // Check if admin login
            if (username === ADMIN_USERNAME) {
                if (password === ADMIN_PASSWORD) {
                    login(username, true);
                } else {
                    showNotification('كلمة مرور الأدمن غير صحيحة', 'error');
                    return;
                }
            } else {
                login(username || 'ضيف', false);
            }
        });

        // Show password field when admin username is entered
        document.getElementById('usernameInput').addEventListener('input', function() {
            const passwordGroup = document.getElementById('passwordGroup');
            const passwordInput = document.getElementById('passwordInput');

            if (this.value.trim() === ADMIN_USERNAME) {
                passwordGroup.style.display = 'block';
                passwordInput.required = true;
            } else {
                passwordGroup.style.display = 'none';
                passwordInput.required = false;
                passwordInput.value = '';
            }
        });

        function login(username, adminStatus = false) {
            showNotification('جاري تسجيل الدخول...', 'success');
            setTimeout(() => {
                currentUser = username;
                isAdmin = adminStatus;
                const loginData = {
                    username: username,
                    isAdmin: adminStatus,
                    loginTime: new Date().getTime(),
                    isLoggedIn: true
                };
                localStorage.setItem('Nova_user', JSON.stringify(loginData));
                updateUserDisplay(username);
                updateAdminUI();
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');

                if (adminStatus) {
                    showNotification(`مرحباً أدمن ${username}! تم تفعيل صلاحيات الإدارة`, 'success');
                } else {
                    showNotification(`مرحباً ${username}!`, 'success');
                }
            }, 800);
        }

        function enterAsGuest() {
            login('ضيف');
        }

        function checkSavedLogin() {
            const savedUser = localStorage.getItem('Nova_user');
            if (savedUser) {
                try {
                    const loginData = JSON.parse(savedUser);
                    const currentTime = new Date().getTime();
                    const thirtyDays = 30 * 24 * 60 * 60 * 1000;

                    if (loginData.isLoggedIn && (currentTime - loginData.loginTime) < thirtyDays) {
                        currentUser = loginData.username;
                        isAdmin = loginData.isAdmin || false;
                        updateUserDisplay(loginData.username);
                        updateAdminUI();
                        document.getElementById('loginPage').classList.add('hidden');
                        document.getElementById('mainApp').classList.remove('hidden');
                        return true;
                    } else {
                        localStorage.removeItem('Nova_user');
                    }
                } catch (e) {
                    localStorage.removeItem('Nova_user');
                }
            }
            return false;
        }

        function logout() {
            // إيقاف المراقبة في الوقت الفعلي
            disableRealtimeSync();

            // Clear all user data
            localStorage.removeItem('Nova_user');

            // Reset variables
            currentUser = null;
            isAdmin = false;

            // Reset UI
            document.getElementById('loginPage').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');

            // Clear input fields
            const usernameInput = document.getElementById('usernameInput');
            const passwordInput = document.getElementById('passwordInput');
            const passwordGroup = document.getElementById('passwordGroup');

            if (usernameInput) usernameInput.value = '';
            if (passwordInput) passwordInput.value = '';
            if (passwordGroup) {
                passwordGroup.style.display = 'none';
                passwordInput.required = false;
            }

            // Update displays
            updateUserDisplay('ضيف');
            updateAdminUI();

            showNotification('تم تسجيل الخروج بنجاح', 'success');
        }

        // Admin UI Functions
        function updateAdminUI() {
            const adminMenuItem = document.getElementById('adminMenuItem');
            if (adminMenuItem) {
                adminMenuItem.style.display = isAdmin ? 'block' : 'none';
            }
        }

        // Navigation Functions
        async function showSection(section) {
            // Check admin access for admin section
            if (section === 'admin' && !isAdmin) {
                showNotification('ليس لديك صلاحية للوصول إلى لوحة التحكم', 'error');
                return;
            }

            // إيقاف تحديثات الريموت مؤقتاً أثناء التبديل
            if (tvRemote) {
                tvRemote.isUpdating = true;
                clearTimeout(tvRemote.updateTimeout);
            }

            // استخدام requestAnimationFrame لتحسين الأداء
            requestAnimationFrame(() => {
                // إخفاء جميع الأقسام
                document.querySelectorAll('.section').forEach(sec => {
                    sec.classList.add('hidden');
                });

                // إظهار القسم المحدد
                const targetSection = document.getElementById(section + 'Section');
                if (targetSection) {
                    targetSection.classList.remove('hidden');
                }

                // إعادة تعيين صفحة القنوات إلى الحالة الافتراضية
                if (section === 'channels') {
                    const categoriesMain = document.getElementById('channelCategoriesMain');
                    const subPage = document.getElementById('channelSubPage');
                    if (categoriesMain) categoriesMain.style.display = 'block';
                    if (subPage) subPage.style.display = 'none';
                }

                closeSidebar();

                // إعادة تشغيل تحديثات الريموت بعد انتهاء التبديل
                if (tvRemote) {
                    setTimeout(() => {
                        tvRemote.isUpdating = false;
                        tvRemote.onSectionChange();
                    }, 100);
                }
            });
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            if (sidebar) {
                sidebar.classList.toggle('active');
            }
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            if (sidebar && sidebar.classList.contains('active')) {
                sidebar.classList.remove('active');
            }
        }



        // Theme Color Functions
        function changeThemeColor(color) {
            currentThemeColor = color;
            localStorage.setItem('Nova_color', color);
            applyThemeColor();

            // Update active color indicator
            document.querySelectorAll('.color-option').forEach(theme => {
                theme.classList.remove('selected');
            });
            const selectedTheme = document.querySelector(`.color-option[data-color="${color}"]`);
            if (selectedTheme) {
                selectedTheme.classList.add('selected');
            }

            showNotification(`تم تغيير اللون إلى ${getColorName(color)}`, 'success');
        }

        function applyThemeColor() {
            try {
                // Apply theme class to document
                const currentClasses = document.documentElement.className.split(' ');
                const filteredClasses = currentClasses.filter(cls => !cls.startsWith('theme-'));
                document.documentElement.className = filteredClasses.concat([`theme-${currentThemeColor}`]).join(' ');

                // Update active color indicator with delay to ensure DOM is ready
                setTimeout(() => {
                    try {
                        const colorOptions = document.querySelectorAll('.color-option');
                        colorOptions.forEach(theme => {
                            if (theme && theme.classList) {
                                theme.classList.remove('selected');
                            }
                        });

                        const activeTheme = document.querySelector(`.color-option[data-color="${currentThemeColor}"]`);
                        if (activeTheme && activeTheme.classList) {
                            activeTheme.classList.add('selected');
                        }
                    } catch (innerError) {
                        console.warn('Error updating color indicators:', innerError);
                    }
                }, 100);
            } catch (error) {
                console.warn('Error applying theme color:', error);
            }
        }

        function getColorName(color) {
            const colorNames = {
                'red': 'الأحمر',
                'blue': 'الأزرق',
                'green': 'الأخضر',
                'purple': 'البنفسجي',
                'orange': 'البرتقالي',
                'pink': 'الوردي',
                'cyan': 'السماوي',
                'yellow': 'الأصفر',
                'indigo': 'النيلي',
                'emerald': 'الزمردي',
                'teal': 'الفيروزي',
                'rose': 'الوردي الداكن',
                'violet': 'البنفسجي الفاتح',
                'amber': 'العنبري',
                'lime': 'الليموني',
                'sky': 'السماوي الفاتح',
                'fuchsia': 'الفوشيا',
                'slate': 'الرمادي الداكن'
            };
            return colorNames[color] || color;
        }

        // Settings Functions
        function toggleDaznSetting(element) {
            element.classList.toggle('active');

            // Save settings
            const settingItem = element.closest('.dazn-setting-item');
            if (settingItem) {
                const settingTitle = settingItem.querySelector('.dazn-setting-title');
                if (settingTitle) {
                    const settingName = settingTitle.textContent.trim();
                    settings[settingName] = element.classList.contains('active');
                    localStorage.setItem('Nova_settings', JSON.stringify(settings));
                }
            }

            showNotification('تم حفظ الإعداد', 'success');
        }

        function toggleSetting(element) {
            toggleDaznSetting(element);
        }





        // Get channel logo function
        function getChannelLogo(channelName, categoryId) {
            // beIN Sports channels
            if (channelName.includes('beIN Sports')) {
                if (channelName.includes('News')) return '<img src="https://e.top4top.io/p_3506no4v61.jpg" alt="Logo" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                return '<img src="https://d.top4top.io/p_3495cezyj1.jpg" alt="beIN" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
            }

            // Sports General channels
            if (categoryId === 'c-alwanhd') {
                if (channelName.includes('Alwan 1 HD')) return '<img src="https://c.top4top.io/p_35061ypdb1.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('Alwan 2 HD')) return '<img src="https://d.top4top.io/p_3506bds121.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('Alwan 3 HD')) return '<img src="https://f.top4top.io/p_3506g56rs1.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('Alwan 4 HD')) return '<img src="https://e.top4top.io/p_3506jml4i1.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';       
                if (channelName.includes('Alwan 5 HD')) return '<img src="https://g.top4top.io/p_3506jg7f11.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('Alwan 6 HD')) return '<img src="https://h.top4top.io/p_3506uyx4x1.jpg" alt="alwna" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';         
                return '<img src="https://j.top4top.io/p_3497y0uz51.jpg" alt="Sports" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
            }

            // FaJER channels
            if (categoryId === 'fjr-s') {
                if (channelName.includes('FaJER 1 HD')) return '<img src="https://i.ibb.co/0cY46br/AL-FAJER-1.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('FaJER 2 HD')) return '<img src="https://i.ibb.co/P4CR80X/AL-FAJER-2.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('FaJER 3 HD')) return '<img src="https://i.ibb.co/yXf7bTT/AL-FAJER-3.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('FaJER 4 HD')) return '<img src="https://i.ibb.co/sFfdsqc/AL-FAJER-4.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';       
                if (channelName.includes('FaJER 5 HD')) return '<img src="https://i.ibb.co/W6VV956/AL-FAJER-5.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                return '<img src="https://j.top4top.io/p_3497y0uz51.jpg" alt="Sports" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
            }

            // Sports General channels
            if (categoryId === 'sports-general') {
                if (channelName.includes('NRT')) return '<img src="https://f.top4top.io/p_35068pcjx1.jpg" alt="NRT" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('AVA')) return '<img src="https://g.top4top.io/p_3506dl9kx1.jpg" alt="AVA" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('LD')) return '<img src="https://e.top4top.io/p_3506b73rk1.jpg" alt="LD" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('ASTERA')) return '<img src="https://d.top4top.io/p_3506rgu7i1.jpg" alt="ASTERA" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';       
                if (channelName.includes('DUHOK')) return '<img src="https://c.top4top.io/p_35062fdhw1.jpg" alt="DUHOK" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                if (channelName.includes('DAISYNA')) return '<img src="https://d.top4top.io/p_3410wcw3d1.jpg" alt="DAISYNA" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';         
                return '<img src="https://j.top4top.io/p_3497y0uz51.jpg" alt="Sports" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
            }

                       // Thmanyah channels
            if (categoryId === 'cc-thmanyah') {
                if (channelName.includes('Thmanyah')) return '<img src="https://i.top4top.io/p_3513fvawe1.jpg" alt="alwan" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
                return '<img src="https://j.top4top.io/p_3497y0uz51.jpg" alt="Sports" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
            }

            // Default channel logo
            return '<img src="https://i.imgur.com/6y7JuWP.png" alt="Channel" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">';
        }

        // Channel Functions
        function showChannelSubPage(categoryId) {
            try {
                const data = channelData[categoryId];
                if (!data) {
                    console.error('Channel data not found for category:', categoryId);
                    showNotification('خطأ في تحميل بيانات القنوات', 'error');
                    return;
                }

                // Hide main search results
                const mainSearchResults = document.getElementById('mainSearchResults');
                if (mainSearchResults) {
                    mainSearchResults.style.display = 'none';
                }

                // Clear main search if active
                const mainSearchInput = document.getElementById('mainChannelSearchInput');
                if (mainSearchInput && mainSearchInput.value) {
                    mainSearchInput.value = '';
                    const mainSearchClearBtn = document.getElementById('mainSearchClearBtn');
                    if (mainSearchClearBtn) {
                        mainSearchClearBtn.style.display = 'none';
                    }
                    // Show categories grid again
                    const categoriesGrid = document.querySelector('.channel-categories-grid');
                    if (categoriesGrid) {
                        categoriesGrid.style.display = 'grid';
                    }
                }

                const categoriesMain = document.getElementById('channelCategoriesMain');
                const subPage = document.getElementById('channelSubPage');
                const subTitle = document.getElementById('channelSubTitle');
                const grid = document.getElementById('channelSubGrid');

                if (!categoriesMain || !subPage || !subTitle || !grid) {
                    console.error('Required channel page elements not found');
                    showNotification('خطأ في عناصر الصفحة', 'error');
                    return;
                }

                // Show sub page
                categoriesMain.style.display = 'none';
                subPage.style.display = 'block';
                subTitle.textContent = data.title;

                // Clear previous content
                grid.innerHTML = '';

                // Generate channel items
                const channelItems = data.channels.map((channel, index) => {
                    try {
                        const channelName = typeof channel === 'string' ? channel : channel.name;
                        const quality = channelName.includes('HD') ? 'HD' : channelName.includes('SD') ? 'SD' : 'LIVE';
                        const channelNumber = data.baseNumber + index;
                        const channelLogo = getChannelLogo(channelName, categoryId);

                        return `
                            <div class="channel-item-wrapper">
                                <a href="go:${channelNumber}" class="channel-item" target="_blank" rel="noopener noreferrer">
                                    <div class="channel-status"></div>
                                    <div class="channel-logo">
                                        ${channelLogo}
                                    </div>
                                    <div class="channel-info">
                                        <div class="channel-name">${channelName}</div>
                                        <div class="channel-quality">${quality}</div>
                                    </div>
                                </a>
                            </div>
                        `;
                    } catch (itemError) {
                        console.warn('Error creating channel item:', itemError);
                        return '';
                    }
                }).filter(item => item !== '');

                // Insert content with simple animation
                grid.innerHTML = channelItems.join('');
                
                // Add simple slide-down animation
                if (subPage) {
                    subPage.style.opacity = '0';
                    subPage.style.transform = 'translateY(-10px)';
                    setTimeout(() => {
                        subPage.style.transition = 'all 0.2s ease-out';
                        subPage.style.opacity = '1';
                        subPage.style.transform = 'translateY(0)';
                    }, 10);
                }

            } catch (error) {
                console.error('Error in showChannelSubPage:', error);
                showNotification('حدث خطأ في تحميل القنوات', 'error');
            }
        }

        function backToChannelCategories() {
            try {
                const channelCategoriesMain = document.getElementById('channelCategoriesMain');
                const channelSubPage = document.getElementById('channelSubPage');

                if (channelCategoriesMain) {
                    channelCategoriesMain.style.display = 'block';
                }

                if (channelSubPage) {
                    channelSubPage.style.display = 'none';
                    // إعادة تعيين الأنيميشن
                    channelSubPage.style.transition = '';
                    channelSubPage.style.opacity = '';
                    channelSubPage.style.transform = '';
                }

            } catch (error) {
                console.error('Error in backToChannelCategories:', error);
                showNotification('خطأ في الرجوع للفئات', 'error');
            }
        }





        // Simple Notification System
        let notificationCounter = 0;

        function showNotification(message, type = 'success', duration = 3000) {
            // التحقق من إعدادات الإشعارات
            if (!settings.notifications && type !== 'error') {
                return;
            }

            notificationCounter++;
            const notificationId = `notification-${notificationCounter}`;

            // Get icon based on type
            let iconClass = 'fas fa-info-circle';
            if (type === 'success') iconClass = 'fas fa-check-circle';
            else if (type === 'error') iconClass = 'fas fa-exclamation-triangle';

            // Create notification element
            const notification = document.createElement('div');
            notification.id = notificationId;
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-icon">
                    <i class="${iconClass}"></i>
                </div>
                <div class="notification-text">${message}</div>
                <button class="notification-close" onclick="removeNotification('${notificationId}')">
                    <i class="fas fa-times"></i>
                </button>
            `;

            // Add to container
            const container = document.getElementById('notificationContainer');
            if (container) {
                container.appendChild(notification);

                // Show immediately
                notification.classList.add('show');

                // Auto remove after duration
                setTimeout(() => {
                    removeNotification(notificationId);
                }, duration);
            }
        }

        function showPremiumMessage() {
            showNotification('قريباً!', 'info');
        }

        function removeNotification(notificationId) {
            const notification = document.getElementById(notificationId);
            if (notification) {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(-50px)';

                setTimeout(() => {
                    if (notification && notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 100);
            }
        }



        // تبسيط إدارة بيانات المستخدم
        function updateUserDisplay(username) {
            try {
                // Update user avatar with first letter
                const userName = document.getElementById('userName');
                if (userName) {
                    const firstLetter = username ? username.charAt(0).toUpperCase() : 'ض';
                    userName.textContent = firstLetter;
                }
            } catch (error) {
                console.warn('Error updating user display:', error);
            }
        }

        // ===== IMAGE PREVIEW FUNCTIONS =====
        function showImagePreview(imageUrl, previewId, imgId) {
            try {
                const preview = document.getElementById(previewId);
                const img = document.getElementById(imgId);
                
                if (preview && img && imageUrl && imageUrl.trim()) {
                    img.src = imageUrl.trim();
                    preview.style.display = 'block';
                    
                    // إضافة معالج للأخطاء
                    img.onerror = function() {
                        hideImagePreview(previewId);
                    };
                } else {
                    hideImagePreview(previewId);
                }
            } catch (error) {
                console.warn('خطأ في عرض معاينة الصورة:', error);
                hideImagePreview(previewId);
            }
        }

        function hideImagePreview(previewId) {
            try {
                const preview = document.getElementById(previewId);
                if (preview) {
                    preview.style.display = 'none';
                    
                    // مسح src الصورة
                    const img = preview.querySelector('img');
                    if (img) {
                        img.src = '';
                    }
                }
            } catch (error) {
                console.warn('خطأ في إخفاء معاينة الصورة:', error);
            }
        }

        // معاينة الصور في نماذج الإدخال
        function previewNewEventImage() {
            const imageUrl = document.getElementById('newEventImage')?.value.trim();
            if (imageUrl) {
                showImagePreview(imageUrl, 'newEventImagePreview', 'newEventImagePreviewImg');
            } else {
                hideImagePreview('newEventImagePreview');
            }
        }

        function previewEditEventImage() {
            const imageUrl = document.getElementById('editEventImage')?.value.trim();
            if (imageUrl) {
                showImagePreview(imageUrl, 'editEventImagePreview', 'editEventImagePreviewImg');
            } else {
                hideImagePreview('editEventImagePreview');
            }
        }

        

        // Initialize default section
        document.addEventListener('DOMContentLoaded', function() {
            // تحميل البيانات مع ضمان العرض
            Promise.all([
                loadChannelData(),
                loadSportsEvents()
            ]).then(() => {
                // ضمان تحديث العرض بعد تحميل البيانات
                updateSportsEventsDisplay();
                console.log('تم تحميل جميع البيانات وتحديث العرض');
            }).catch(error => {
                console.error('خطأ في تحميل البيانات:', error);
                // في حالة الخطأ، استخدم البيانات الافتراضية
                sportsEvents = [...defaultSportsEvents];
                updateSportsEventsDisplay();
            });

            showSection('live');
            initializeMatchesSlider();



            // Initialize admin panel
            loadAdminData();

            // تحديث العرض مرة أخرى للتأكد
            setTimeout(() => {
                updateSportsEventsDisplay();
            }, 500);


        });

        // ===== ADMIN PANEL FUNCTIONS =====

        async function switchAdminTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });

            // Remove active class from all tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab content
            document.getElementById(`admin${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Tab`).classList.remove('hidden');

            // Add active class to selected tab
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // Load specific data for the tab with error handling
            try {
                if (tabName === 'events') {
                    loadEventsList();
                }
            } catch (error) {
                console.error('خطأ في تحميل بيانات التبويب:', error);
                showNotification('خطأ في تحميل البيانات', 'error');
            }
        }

        async function loadAdminData() {
            // التأكد من وجود البيانات
            if (!channelData || Object.keys(channelData).length === 0) {
                console.log('تحميل بيانات القنوات الافتراضية...');
                channelData = JSON.parse(JSON.stringify(defaultChannelData));
                await saveChannelData();
            }

            if (!sportsEvents || sportsEvents.length === 0) {
                console.log('تحميل بيانات الأحداث الافتراضية...');
                sportsEvents = [...defaultSportsEvents];
                await saveSportsEvents();
            }

            // تحميل قوائم الإدارة
            loadEventsList();
        }

        // ===== SPORTS EVENTS MANAGEMENT FUNCTIONS =====

        function loadEventsList() {
            const eventsList = document.getElementById('eventsList');
            if (!eventsList) return;

            if (sportsEvents.length === 0) {
                eventsList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
                        <i class="fas fa-futbol" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <h3>لا توجد أحداث رياضية</h3>
                        <p>ابدأ بإضافة حدث رياضي جديد</p>
                    </div>
                `;
                return;
            }

            eventsList.innerHTML = sportsEvents.map((event, index) => {
                const statusIcon = event.status === 'live' ? 'fas fa-circle text-danger' : 
                                 event.status === 'finished' ? 'fas fa-check-circle text-success' : 
                                 'fas fa-clock text-warning';
                const statusText = event.status === 'live' ? 'مباشر' : 
                                 event.status === 'finished' ? 'انتهى' : 'قادم';
                const statusColor = event.status === 'live' ? '#ff4757' : 
                                  event.status === 'finished' ? '#2ed573' : '#ffa502';

                return `
                    <div class="category-item" style="align-items: flex-start;">
                        <div style="display: flex; gap: 1rem; align-items: flex-start; flex: 1;">
                            <div style="width: 80px; height: 60px; border-radius: 8px; overflow: hidden; flex-shrink: 0; background: var(--border-primary);">
                                <img src="${event.image}" alt="${event.title}" style="width: 100%; height: 100%; object-fit: cover;" onerror="this.style.display='none'">
                            </div>
                            <div class="item-info" style="flex: 1;">
                                <div class="item-title">${event.title}</div>
                                <div class="item-subtitle">${event.subtitle}</div>
                                <div style="margin-top: 0.5rem;">
                                    <span style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: 600; background: rgba(${statusColor === '#ff4757' ? '255, 71, 87' : statusColor === '#2ed573' ? '46, 213, 115' : '255, 165, 2'}, 0.1); color: ${statusColor}; border: 1px solid rgba(${statusColor === '#ff4757' ? '255, 71, 87' : statusColor === '#2ed573' ? '46, 213, 115' : '255, 165, 2'}, 0.3);">
                                        <i class="${statusIcon}" style="font-size: 0.7rem;"></i>
                                        ${statusText}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="item-actions">
                            <button class="action-btn" onclick="editEvent(${index})" title="تعديل">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" onclick="deleteEvent(${index})" title="حذف">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        async function addNewEvent() {
            const title = document.getElementById('newEventTitle').value.trim();
            const subtitle = document.getElementById('newEventSubtitle').value.trim();
            const image = document.getElementById('newEventImage').value.trim();
            const link = document.getElementById('newEventLink').value.trim();
            const status = document.getElementById('newEventStatus').value;

            if (!title || !subtitle) {
                showNotification('يرجى ملء العنوان والوصف على الأقل', 'error');
                return;
            }

            const newEvent = {
                title: title,
                subtitle: subtitle,
                image: image || 'https://via.placeholder.com/400x250?text=حدث+رياضي',
                link: link || null,
                status: status
            };

            sportsEvents.push(newEvent);

            const saved = await saveSportsEvents();
            if (saved) {
                showNotification('تم إضافة الحدث بنجاح', 'success');

                // Clear inputs and preview
                document.getElementById('newEventTitle').value = '';
                document.getElementById('newEventSubtitle').value = '';
                document.getElementById('newEventImage').value = '';
                document.getElementById('newEventLink').value = '';
                document.getElementById('newEventStatus').value = 'upcoming';
                hideImagePreview('newEventImagePreview');

                // Refresh displays
                loadEventsList();
                updateSportsEventsDisplay();
            } else {
                showNotification('خطأ في حفظ البيانات', 'error');
            }
        }

        function editEvent(index) {
            const event = sportsEvents[index];
            if (!event) return;

            // Fill edit form
            document.getElementById('editEventIndex').value = index;
            document.getElementById('editEventTitle').value = event.title;
            document.getElementById('editEventSubtitle').value = event.subtitle;
            document.getElementById('editEventImage').value = event.image;
            document.getElementById('editEventLink').value = event.link || '';
            document.getElementById('editEventStatus').value = event.status;

            // Show image preview if available
            if (event.image) {
                showImagePreview(event.image, 'editEventImagePreview', 'editEventImagePreviewImg');
            } else {
                hideImagePreview('editEventImagePreview');
            }

            // Show modal
            const modal = document.getElementById('editEventModal');
            modal.style.display = 'flex';
        }

        function closeEditEventModal() {
            const modal = document.getElementById('editEventModal');
            modal.style.display = 'none';
        }

        async function saveEventChanges() {
            const index = parseInt(document.getElementById('editEventIndex').value);
            const title = document.getElementById('editEventTitle').value.trim();
            const subtitle = document.getElementById('editEventSubtitle').value.trim();
            const image = document.getElementById('editEventImage').value.trim();
            const link = document.getElementById('editEventLink').value.trim();
            const status = document.getElementById('editEventStatus').value;

            if (!title || !subtitle) {
                showNotification('يرجى ملء العنوان والوصف على الأقل', 'error');
                return;
            }

            sportsEvents[index] = {
                title: title,
                subtitle: subtitle,
                image: image || sportsEvents[index].image,
                link: link || null,
                status: status
            };

            if (await saveSportsEvents()) {
                showNotification('تم حفظ التغييرات بنجاح', 'success');
                closeEditEventModal();
                loadEventsList();
                updateSportsEventsDisplay();
            } else {
                showNotification('خطأ في حفظ البيانات', 'error');
            }
        }

        async function deleteEvent(index) {
            const event = sportsEvents[index];
            if (!event) return;

            if (!confirm(`هل أنت متأكد من حذف الحدث "${event.title}"؟`)) {
                return;
            }

            sportsEvents.splice(index, 1);

            if (await saveSportsEvents()) {
                showNotification('تم حذف الحدث بنجاح', 'success');
                loadEventsList();
                updateSportsEventsDisplay();
            } else {
                showNotification('خطأ في حفظ البيانات', 'error');
            }
        }

        // تحديث عرض الأحداث الرياضية
        function updateSportsEventsDisplay() {
            const slider = document.getElementById('bestOfFootballSlider');
            if (!slider) {
                console.warn('عنصر bestOfFootballSlider غير موجود');
                return;
            }

            let html = '';
            const eventsToShow = sportsEvents.length > 0 ? sportsEvents : defaultSportsEvents;

            eventsToShow.forEach((event, index) => {
                const eventImage = event.image || 'https://c.top4top.io/p_3499bjfz31.jpg';
                const eventLink = event.link || '#';

                // تحديد نص وكلاس الحالة
                let statusText = '';
                let statusClass = '';

                switch(event.status) {
                    case 'live':
                        statusText = 'مباشر';
                        statusClass = 'live';
                        break;
                    case 'upcoming':
                        statusText = 'قادم';
                        statusClass = 'upcoming';
                        break;
                    case 'finished':
                        statusText = 'انتهى';
                        statusClass = 'finished';
                        break;
                    default:
                        statusText = 'قادم';
                        statusClass = 'upcoming';
                }

                // استخراج رقم القناة من الرابط
                let channelNumber = null;
                if (eventLink && eventLink.startsWith('go:')) {
                    channelNumber = eventLink.replace('go:', '');
                }

                const clickHandler = channelNumber ? 
                    `onclick="handleChannelClick(event, ${channelNumber})"` : 
                    `onclick="showNotification('رابط غير متاح', 'info')"`;

                html += `
                    <div class="football-event-card" ${clickHandler} style="cursor: pointer;">
                        <div class="card-background" style="background-image: url('${eventImage}'); background-size: cover; background-position: center;"></div>

                        <!-- شارة الحالة المحسنة -->
                        <div class="event-status-badge ${statusClass}">
                            ${statusText}
                        </div>

                        <div class="football-info">
                            <div class="football-title">${event.title || 'حدث رياضي'}</div>
                            <div class="football-subtitle">${event.subtitle || 'وصف الحدث'}</div>
                        </div>
                    </div>
                `;
            });

            slider.innerHTML = html;
            console.log(`تم عرض ${eventsToShow.length} حدث رياضي`);
        }

        // Generate automatic numbers for events
        function generateEventNumber() {
            const linkInput = document.getElementById('newEventLink');
            if (!linkInput) return;

            // Find the highest existing event number
            let maxNumber = 500; // Start from 500
            sportsEvents.forEach(event => {
                if (event.link && event.link.startsWith('go:')) {
                    const number = parseInt(event.link.replace('go:', ''));
                    if (!isNaN(number) && number > maxNumber) {
                        maxNumber = number;
                    }
                }
            });

            // Set next available number
            linkInput.value = `go:${maxNumber + 1}`;
            showNotification(`تم توليد الرقم التلقائي: ${maxNumber + 1}`, 'success');
        }

        function generateEditEventNumber() {
            const linkInput = document.getElementById('editEventLink');
            if (!linkInput) return;

            // Find the highest existing event number
            let maxNumber = 500; // Start from 500
            sportsEvents.forEach(event => {
                if (event.link && event.link.startsWith('go:')) {
                    const number = parseInt(event.link.replace('go:', ''));
                    if (!isNaN(number) && number > maxNumber) {
                        maxNumber = number;
                    }
                }
            });

            // Set next available number
            linkInput.value = `go:${maxNumber + 1}`;
            showNotification(`تم توليد الرقم التلقائي: ${maxNumber + 1}`, 'success');
        }

        

        function updateChannelCategoriesDisplay() {
            // Update the main channels page display
            const categoriesGrid = document.querySelector('.channel-categories-grid');
            if (!categoriesGrid) return;

            categoriesGrid.innerHTML = Object.keys(channelData).map(categoryId => {
                const category = channelData[categoryId];
                const channelCount = category.channels.length;

                // Determine background image based on category
                let bgImage = 'https://i.imgur.com/default.jpg';
                if (categoryId.includes('bein')) bgImage = 'https://c.top4top.io/p_3408jzbg31.jpg';
                else if (categoryId.includes('fjr') || categoryId.includes('fajer')) bgImage = 'https://h.top4top.io/p_3506bqcex1.jpg';
                else if (categoryId.includes('c-alwanhd')) bgImage = 'https://i.top4top.io/p_3506uo65h1.jpg';
                else if (categoryId.includes('cc-thmanyah')) bgImage = 'https://pbs.twimg.com/card_img/1953836002222473216/dziKdJqf?format=jpg&name=medium';                
                else if (categoryId.includes('sport')) bgImage = 'https://c.top4top.io/p_3499bjfz31.jpg';

                return `
                    <div class="channel-category-card" onclick="showChannelSubPage('${categoryId}')">
                        <div style="width: 100%; height: 100px; border-radius: 10px; margin-bottom: 1rem; position: relative; overflow: hidden; background: url('${bgImage}') center/cover;">
                            <div style="position: absolute; bottom: 10px; left: 10px; z-index: 2; color: white;">
                            </div>
                        </div>
                        <div class="channel-category-name">${category.title}</div>
                        <div class="channel-category-desc">${getCategoryDescription(categoryId)}</div>
                        <div class="channel-category-badge">
                            <i class="fas fa-video" style="font-size: 1.1rem;"></i>
                            <span>${channelCount} قناة</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getCategoryDescription(categoryId) {
            const descriptions = {
                'bein-hd': 'مجموعة قنوات الباقة البنفسجية الرياضية',
                'fjr-s': 'القنوات الفلسطينية الرياضية جميع الأحداث',
                'sports-general': 'مجموعة متنوعة من القنوات الرياضية',
                'c-alwanhd': 'أفضل باقة رياضية لمشاهدة المباريات بأعلى جودة'
            };
            return descriptions[categoryId] || 'مجموعة قنوات ثمانية لبث مباريات الدوري السعودي';
        }



        async function resetToDefault() {
            if (!confirm('هل أنت متأكد من إعادة تعيين جميع البيانات للافتراضية؟\nسيتم فقدان جميع التغييرات التي أجريتها.')) {
                return;
            }

            try {
                channelData = JSON.parse(JSON.stringify(defaultChannelData)); // نسخ عميق
                sportsEvents = JSON.parse(JSON.stringify(defaultSportsEvents)); // نسخ عميق

                const channelSaved = await saveChannelData();
                const eventsSaved = await saveSportsEvents();

                if (channelSaved && eventsSaved) {
                    showNotification('تم إعادة تعيين البيانات للافتراضية بنجاح', 'success');
                    loadAdminData();
                    updateChannelCategoriesDisplay();
                    updateSportsEventsDisplay();
                } else {
                    showNotification('خطأ في حفظ البيانات المعاد تعيينها', 'error');
                }
            } catch (error) {
                console.error('خطأ في إعادة تعيين البيانات:', error);
                showNotification('حدث خطأ أثناء إعادة التعيين', 'error');
            }
        }

        // تهيئة سلايدر المباريات مع إمكانية السحب - محسن للسرعة
        function initializeMatchesSlider() {
            initializeSlider('matchesSlider');
            initializeSlider('competitionsSlider');
            initializeSlider('bestOfFootballSlider');
        }

        function initializeSlider(sliderId) {
            const slider = document.getElementById(sliderId);
            if (!slider) return;

            let isDown = false;
            let startX;
            let scrollLeft;
            let isDragging = false;

            // Mouse events - محسن للأداء
            slider.addEventListener('mousedown', (e) => {
                isDown = true;
                slider.classList.add('dragging');
                startX = e.pageX - slider.offsetLeft;
                scrollLeft = slider.scrollLeft;
                isDragging = false;
                slider.style.scrollBehavior = 'auto'; // إزالة smooth أثناء السحب
            });

            slider.addEventListener('mouseleave', () => {
                isDown = false;
                slider.classList.remove('dragging');
                slider.style.scrollBehavior = 'smooth';
            });

            slider.addEventListener('mouseup', () => {
                isDown = false;
                slider.classList.remove('dragging');
                slider.style.scrollBehavior = 'smooth';

                // منع النقر إذا كان هناك سحب
                if (isDragging) {
                    setTimeout(() => {
                        isDragging = false;
                    }, 50); // تقليل الوقت
                }
            });

            slider.addEventListener('mousemove', (e) => {
                if (!isDown) return;
                e.preventDefault();
                isDragging = true;
                const x = e.pageX - slider.offsetLeft;
                const walk = (x - startX) * 1.5; // تقليل المقاومة
                slider.scrollLeft = scrollLeft - walk;
            });

            // Touch events للهواتف المحمولة - محسن للسرعة
            let touchStartX = 0;
            let touchStartScrollLeft = 0;

            slider.addEventListener('touchstart', (e) => {
                touchStartX = e.touches[0].clientX;
                touchStartScrollLeft = slider.scrollLeft;
                slider.classList.add('dragging');
                slider.style.scrollBehavior = 'auto';
            }, { passive: true });

            slider.addEventListener('touchmove', (e) => {
                if (!touchStartX) return;

                const touchX = e.touches[0].clientX;
                const diffX = touchStartX - touchX;
                slider.scrollLeft = touchStartScrollLeft + (diffX * 0.8); // تحسين استجابة اللمس
                isDragging = true;
            }, { passive: true });

            slider.addEventListener('touchend', () => {
                touchStartX = 0;
                slider.classList.remove('dragging');
                slider.style.scrollBehavior = 'smooth';

                // منع النقر إذا كان هناك سحب
                if (isDragging) {
                    setTimeout(() => {
                        isDragging = false;
                    }, 50); // تقليل الوقت
                }
            }, { passive: true });

            // منع النقر على الروابط أثناء السحب
            slider.addEventListener('click', (e) => {
                if (isDragging) {
                    e.preventDefault();
                    e.stopPropagation();
                }
            }, true);
        }

        // Search and Filter Functions for Main Categories Page
        function filterMainChannels() {
            const searchInput = document.getElementById('mainChannelSearchInput');
            const searchClearBtn = document.getElementById('mainSearchClearBtn');
            const searchValue = searchInput.value.trim();

            // Show/hide clear button
            searchClearBtn.style.display = searchValue ? 'block' : 'none';

            // Debounce search
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                performMainSearch(searchValue);
            }, 300);
        }

        function performMainSearch(searchTerm) {
            const searchResults = document.getElementById('mainSearchResults');
            const searchResultsGrid = document.getElementById('mainSearchResultsGrid');
            const categoriesGrid = document.querySelector('.channel-categories-grid');

            if (!searchTerm) {
                searchResults.style.display = 'none';
                categoriesGrid.style.display = 'grid';
                return;
            }

            // Hide categories grid and show search results
            categoriesGrid.style.display = 'none';
            searchResults.style.display = 'block';

            // Search through all channels
            const results = [];
            for (const categoryId in channelData) {
                const category = channelData[categoryId];
                category.channels.forEach((channel, index) => {
                    const channelName = typeof channel === 'string' ? channel : channel.name;
                    if (channelName.toLowerCase().includes(searchTerm.toLowerCase())) {
                        results.push({
                            name: channelName,
                            category: category.title,
                            categoryId: categoryId,
                            index: index,
                            channelNumber: category.baseNumber + index
                        });
                    }
                });
            }

            displayMainSearchResults(results);
        }



        function displayMainSearchResults(results) {
            const searchResultsGrid = document.getElementById('mainSearchResultsGrid');

            if (results.length === 0) {
                searchResultsGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 2rem; color: var(--text-muted);">
                        <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <h3>لا توجد نتائج</h3>
                        <p>جرب البحث بكلمات مختلفة</p>
                    </div>
                `;
                return;
            }

            searchResultsGrid.innerHTML = results.map(result => {
                const quality = result.name.includes('HD') ? 'HD' : result.name.includes('SD') ? 'SD' : 'LIVE';
                const channelLogo = getChannelLogo(result.name, result.categoryId);

                return `
                    <a href="go:${result.channelNumber}" class="search-result-item lazy-load" target="_blank" rel="noopener noreferrer">
                        <div class="search-result-icon">
                            ${channelLogo}
                        </div>
                        <div class="search-result-info">
                            <div class="search-result-name">${result.name}</div>
                            <div class="search-result-category">${quality} • ${result.category}</div>
                        </div>
                    </a>
                `;
            }).join('');

            // Apply lazy loading animation
            setTimeout(() => {
                document.querySelectorAll('.search-result-item.lazy-load').forEach((item, index) => {
                    setTimeout(() => {
                        item.classList.add('loaded');
                    }, index * 50);
                });
            }, 100);
        }

        function clearMainSearch() {
            const searchInput = document.getElementById('mainChannelSearchInput');
            const searchClearBtn = document.getElementById('mainSearchClearBtn');
            const searchResults = document.getElementById('mainSearchResults');
            const categoriesGrid = document.querySelector('.channel-categories-grid');

            searchInput.value = '';
            searchClearBtn.style.display = 'none';
            searchResults.style.display = 'none';
            categoriesGrid.style.display = 'grid';

            showNotification('تم مسح البحث', 'success');
        }

        // Performance Optimizations
        function optimizeImages() {
            // Lazy load images when they come into viewport
            const images = document.querySelectorAll('img[data-src]');
            const imageObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.removeAttribute('data-src');
                        imageObserver.unobserve(img);
                    }
                });
            });

            images.forEach(img => imageObserver.observe(img));
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Enhanced Mobile Touch Support
        function addTouchSupport() {
            if ('ontouchstart' in window) {
                document.body.classList.add('touch-device');

                // Add touch feedback
                document.addEventListener('touchstart', function(e) {
                    if (e.target.closest('.card, .channel-item, .search-result-item')) {
                        e.target.closest('.card, .channel-item, .search-result-item').style.transform = 'scale(0.98)';
                    }
                });

                document.addEventListener('touchend', function(e) {
                    if (e.target.closest('.card, .channel-item, .search-result-item')) {
                        setTimeout(() => {
                            e.target.closest('.card, .channel-item, .search-result-item').style.transform = '';
                        }, 150);
                    }
                });
            }
        }

        // Initialize performance optimizations
        document.addEventListener('DOMContentLoaded', function() {
            optimizeImages();
            addTouchSupport();

            // Preload critical resources
            const link = document.createElement('link');
            link.rel = 'preload';
            link.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';
            link.as = 'style';
            document.head.appendChild(link);
        });

        // Online/Offline Detection
        window.addEventListener('online', function() {
            showNotification('تم استعادة الاتصال بالإنترنت', 'success');
        });

        window.addEventListener('offline', function() {
            showNotification('انقطع الاتصال بالإنترنت', 'error');
        });



window.onload = () => {
    // إيجاد العناصر القابلة للنقر وإضافة tabindex إذا لم يكن موجود
    const clickable = document.querySelectorAll('a, button, [onclick]');
    clickable.forEach(el => {
        if (!el.hasAttribute('tabindex')) {
            el.setAttribute('tabindex', '0');
        }
    });

    // التركيز على أول عنصر تفاعلي عند التحميل
    if (clickable.length > 0) {
        clickable[0].focus();
        scrollIntoViewIfNeeded(clickable[0]);
    }

    // دالة التمرير التلقائي
    function scrollIntoViewIfNeeded(el) {
        const rect = el.getBoundingClientRect();
        if (rect.top < 0 || rect.bottom > window.innerHeight) {
            el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    }

    // دعم الأسهم وEnter للريموت
    document.addEventListener('keydown', function(e) {
        let focused = document.activeElement;
        let elements = Array.from(clickable);
        let index = elements.indexOf(focused);

        switch(e.key) {
            case "ArrowUp":
            case "ArrowLeft":
                if (index > 0) {
                    elements[index - 1].focus();
                    scrollIntoViewIfNeeded(elements[index - 1]);
                }
                break;
            case "ArrowDown":
            case "ArrowRight":
                if (index < elements.length - 1) {
                    elements[index + 1].focus();
                    scrollIntoViewIfNeeded(elements[index + 1]);
                }
                break;
            case "Enter":
                if (focused && typeof focused.click === 'function') {
                    focused.click();
                }
                break;
        }
    });
};

</script>
    </body>
</html>
